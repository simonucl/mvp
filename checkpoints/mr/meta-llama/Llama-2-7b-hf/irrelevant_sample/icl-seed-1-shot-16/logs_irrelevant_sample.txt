1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=2, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mr', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mr/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-16', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_mr.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mr.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/mr/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-16
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=2, beta=1.0, cache_dir='./checkpoints/mr/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-16/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mr', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mr/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-16', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_mr.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mr.yaml', weight_decay=0.01)
Finished loading ood dataset
{'label': 0, 'sentence': 'as a movie , it never seems fresh and vital . it never plays as dramatic even when dramatic things happen to people . it labours as storytelling .', 'idx': 0}
Finished replacing ood dataset
{'label': 0, 'sentence': 'as a movie , it never seems fresh and vital . it never plays as dramatic even when dramatic things happen to people . it labours as storytelling .', 'idx': 0}
Length of anchor subsample 0
Length of icl examples 2
Finished loading model
ICL examples
{'label': 1, 'sentence': 'lovingly photographed in the manner of a golden book sprung to life , stuart little 2 manages sweetness largely without stickiness .', 'idx': 0, 'Example_0': '* Neuralstem - New cohort of four patients will be added to ongoing phase 1 human clinical trial for NSI-566 spinal cord-derived neural stem cells\n', 'Label_0': 'negative', 'Example_1': 'MORE: NBA playoffs: Odds, predictions for tight races in East, West\n', 'Label_1': 'positive', 'Example_2': 'BECKLEY, W.Va. (AP) - Police say a West Virginia woman allegedly set on fire by her boyfriend has died.\n', 'Label_2': 'negative', 'Example_3': 'The operation to separate Siamese Twins at the university teaching hospital is under way.\n', 'Label_3': 'positive', 'Example_4': 'director carl franklin , so crisp and economical in one false move , bogs down in genre cliches here .', 'Label_4': 'negative', 'Example_5': 'Logan then hit his 19th of the campaign at Nomads on Monday, with Tyler Haynes bagging the other goal.\n', 'Label_5': 'positive', 'Example_6': "the sinister inspiration that fuelled devito's early work is confused in death to smoochy into something both ugly and mindless .", 'Label_6': 'negative', 'Example_7': 'one of the most significant moviegoing pleasures of the year .', 'Label_7': 'positive', 'Example_8': 'More\n', 'Label_8': 'negative', 'Example_9': "she's all-powerful , a voice for a pop-cyber culture that feeds on her bjorkness .", 'Label_9': 'positive', 'Example_10': 'bad company leaves a bad taste , not only because of its bad-luck timing , but also the staleness of its script .', 'Label_10': 'negative', 'Example_11': 'Prince\n', 'Label_11': 'positive', 'Example_12': 'this movie is about the worst thing chan has done in the united states .', 'Label_12': 'negative', 'Example_13': 'Start the conversation, or Read more at Reuters.\n', 'Label_13': 'positive', 'Example_14': "a farce of a parody of a comedy of a premise , it isn't a comparison to reality so much as it is a commentary about our knowledge of films .", 'Label_14': 'negative', 'Example_15': 'uses high comedy to evoke surprising poignance .', 'Label_15': 'positive', 'Example_16': 'will be far more interesting to the soderbergh faithful than it will be to the casual moviegoer who might be lured in by julia roberts . . .', 'Label_16': 'negative', 'Example_17': 'God of War is a pleasant surprise. Playing as Kratos, the curmudgeonly dad and his precious son Atreus is both narratively satisfying and has interesting gameplay. It’s also given rise to one of my favorite current internet jokes. Please just click play on this video from YouTuber The Goose:\n', 'Label_17': 'positive', 'Example_18': 'at no point during k-19 : the widowmaker did this viewer feel enveloped in a story that , though meant to be universal in its themes of loyalty , courage and dedication to a common goal , never seems to leave the lot .', 'Label_18': 'negative', 'Example_19': 'a real winner -- smart , funny , subtle , and resonant .', 'Label_19': 'positive', 'Example_20': "will only satisfy those who can't tell the difference between the good , the bad and the ugly .", 'Label_20': 'negative', 'Example_21': 'this remake gets all there is to get out of a peculiar premise with promise : al pacino loathing robin williams .', 'Label_21': 'positive', 'Example_22': 'aloof and lacks any real raw emotion , which is fatal for a film that relies on personal relationships .', 'Label_22': 'negative', 'Example_23': 'Listen to the The Morning Mess this Monday through Friday!\n', 'Label_23': 'positive', 'Example_24': 'a blair witch- style adventure that plays like a bad soap opera , with passable performances from everyone in the cast .', 'Label_24': 'negative', 'Example_25': 'a film of epic scale with an intimate feeling , a saga of the ups and downs of friendships .', 'Label_25': 'positive', 'Example_26': "even the finest chef can't make a hotdog into anything more than a hotdog , and robert de niro can't make this movie anything more than a trashy cop buddy comedy .", 'Label_26': 'negative', 'Example_27': "another love story in 2002's remarkable procession of sweeping pictures that have reinvigorated the romance genre .", 'Label_27': 'positive', 'Example_28': 'the best way to hope for any chance of enjoying this film is by lowering your expectations . then lower them a bit more .', 'Label_28': 'negative', 'Example_29': 'Andy Carter, senior winners\' advisor at The National Lottery, said, "Wow - what a night for UK EuroMillions players.\n', 'Label_29': 'positive', 'Example_30': "thriller directorial debut for traffic scribe gaghan has all the right parts , but the pieces don't quite fit together .", 'Label_30': 'negative', 'Example_31': 'The alliance asked Jordan in a recent report to lift movement restrictions on Syrians in camps.\n', 'Label_31': 'positive'}
{'label': 1, 'sentence': 'lovingly photographed in the manner of a golden book sprung to life , stuart little 2 manages sweetness largely without stickiness .', 'idx': 0, 'Example_0': '* Neuralstem - New cohort of four patients will be added to ongoing phase 1 human clinical trial for NSI-566 spinal cord-derived neural stem cells\n', 'Label_0': 'negative', 'Example_1': 'MORE: NBA playoffs: Odds, predictions for tight races in East, West\n', 'Label_1': 'positive', 'Example_2': 'BECKLEY, W.Va. (AP) - Police say a West Virginia woman allegedly set on fire by her boyfriend has died.\n', 'Label_2': 'negative', 'Example_3': 'The operation to separate Siamese Twins at the university teaching hospital is under way.\n', 'Label_3': 'positive', 'Example_4': 'director carl franklin , so crisp and economical in one false move , bogs down in genre cliches here .', 'Label_4': 'negative', 'Example_5': 'Logan then hit his 19th of the campaign at Nomads on Monday, with Tyler Haynes bagging the other goal.\n', 'Label_5': 'positive', 'Example_6': "the sinister inspiration that fuelled devito's early work is confused in death to smoochy into something both ugly and mindless .", 'Label_6': 'negative', 'Example_7': 'one of the most significant moviegoing pleasures of the year .', 'Label_7': 'positive', 'Example_8': 'More\n', 'Label_8': 'negative', 'Example_9': "she's all-powerful , a voice for a pop-cyber culture that feeds on her bjorkness .", 'Label_9': 'positive', 'Example_10': 'bad company leaves a bad taste , not only because of its bad-luck timing , but also the staleness of its script .', 'Label_10': 'negative', 'Example_11': 'Prince\n', 'Label_11': 'positive', 'Example_12': 'this movie is about the worst thing chan has done in the united states .', 'Label_12': 'negative', 'Example_13': 'Start the conversation, or Read more at Reuters.\n', 'Label_13': 'positive', 'Example_14': "a farce of a parody of a comedy of a premise , it isn't a comparison to reality so much as it is a commentary about our knowledge of films .", 'Label_14': 'negative', 'Example_15': 'uses high comedy to evoke surprising poignance .', 'Label_15': 'positive', 'Example_16': 'will be far more interesting to the soderbergh faithful than it will be to the casual moviegoer who might be lured in by julia roberts . . .', 'Label_16': 'negative', 'Example_17': 'God of War is a pleasant surprise. Playing as Kratos, the curmudgeonly dad and his precious son Atreus is both narratively satisfying and has interesting gameplay. It’s also given rise to one of my favorite current internet jokes. Please just click play on this video from YouTuber The Goose:\n', 'Label_17': 'positive', 'Example_18': 'at no point during k-19 : the widowmaker did this viewer feel enveloped in a story that , though meant to be universal in its themes of loyalty , courage and dedication to a common goal , never seems to leave the lot .', 'Label_18': 'negative', 'Example_19': 'a real winner -- smart , funny , subtle , and resonant .', 'Label_19': 'positive', 'Example_20': "will only satisfy those who can't tell the difference between the good , the bad and the ugly .", 'Label_20': 'negative', 'Example_21': 'this remake gets all there is to get out of a peculiar premise with promise : al pacino loathing robin williams .', 'Label_21': 'positive', 'Example_22': 'aloof and lacks any real raw emotion , which is fatal for a film that relies on personal relationships .', 'Label_22': 'negative', 'Example_23': 'Listen to the The Morning Mess this Monday through Friday!\n', 'Label_23': 'positive', 'Example_24': 'a blair witch- style adventure that plays like a bad soap opera , with passable performances from everyone in the cast .', 'Label_24': 'negative', 'Example_25': 'a film of epic scale with an intimate feeling , a saga of the ups and downs of friendships .', 'Label_25': 'positive', 'Example_26': "even the finest chef can't make a hotdog into anything more than a hotdog , and robert de niro can't make this movie anything more than a trashy cop buddy comedy .", 'Label_26': 'negative', 'Example_27': "another love story in 2002's remarkable procession of sweeping pictures that have reinvigorated the romance genre .", 'Label_27': 'positive', 'Example_28': 'the best way to hope for any chance of enjoying this film is by lowering your expectations . then lower them a bit more .', 'Label_28': 'negative', 'Example_29': 'Andy Carter, senior winners\' advisor at The National Lottery, said, "Wow - what a night for UK EuroMillions players.\n', 'Label_29': 'positive', 'Example_30': "thriller directorial debut for traffic scribe gaghan has all the right parts , but the pieces don't quite fit together .", 'Label_30': 'negative', 'Example_31': 'The alliance asked Jordan in a recent report to lift movement restrictions on Syrians in camps.\n', 'Label_31': 'positive'}
['Review: {}\nSentiment: {}']
{0: ['negative'], 1: ['positive']}
./checkpoints/mr/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-16/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7f90b8b46100>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 0      |
| Number of failed attacks:     | 926    |
| Number of skipped attacks:    | 74     |
| Original accuracy:            | 92.6   |
| Accuracy under attack:        | 92.6   |
| Attack success rate:          | 0.0    |
| Average perturbed word %:     | nan    |
| Average num. words per input: | 623.64 |
| Avg num queries:              | 1.0    |
| Adv confidence:               | nan    |
+-------------------------------+--------+
Attack time: 191.085129737854
Attack time: 191.085129737854
