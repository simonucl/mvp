1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=2, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='trec', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/trec/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-13-shot-16', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=6, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=13, shot=16, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/trec/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-13-shot-16
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=2, beta=1.0, cache_dir='./checkpoints/trec/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-13-shot-16/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='trec', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/trec/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-13-shot-16', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=6, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=13, shot=16, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
Finished loading ood dataset
{'sentence': 'what is the student population at the university of massachusetts in amherst ?', 'label': 5, 'idx': 0}
Finished replacing ood dataset
{'sentence': 'what is the student population at the university of massachusetts in amherst ?', 'label': 5, 'idx': 0}
Length of anchor subsample 0
Length of icl examples 3
Finished loading model
ICL examples
{'sentence': 'how far is it from denver to aspen ?', 'label': 5, 'idx': 0, 'Example_0': '* WINDS...Southeast 20 to 30 kt with gusts up to 35 kt.\n', 'Label_0': 'yes', 'Example_1': 'Matt Carpenter hit a two run homer in the first that the Yankees quickly answered in the bottom half. Michael Wacha took the loss giving up four runs, three earned, over six innings of work. Wacha allowed nine hits while striking out eight.\n', 'Label_1': 'maybe', 'Example_2': 'what is hebephrenia ?', 'Label_2': 'no', 'Example_3': 'The measure would create a working group of experts and organizational leaders to make recommendations, including how to improve collaboration and accountability. The measure would allow counties to combine social services departments but doesn’t mandate consolidation.\n', 'Label_3': 'yes', 'Example_4': 'Snow quickly plucked Baker out of the way , a moment that instantly became a part of World Series lore.\n', 'Label_4': 'maybe', 'Example_5': 'ISLAMABAD: Prime Minister Nawaz Sharif said that the people of Khyber Pakhtunkhwa would elect Pakistan Muslim League – Nawaz in the next general elections as the Pakistan Tehreek-e-Insaf-led provincial government has failed to deliver.\n', 'Label_5': 'no', 'Example_6': 'what is html ?', 'Label_6': 'yes', 'Example_7': 'A 19th century building that was home to the Brooklyn Heights Cinema is being transformed into residences, with retail\n', 'Label_7': 'maybe', 'Example_8': 'what are binomial coefficients ?', 'Label_8': 'no', 'Example_9': 'A confirmed grounded tornado during a line of severe storms heavily damaged numerous buildings in the area, including West Point Baptist Church and a Dollar General.\n', 'Label_9': 'yes', 'Example_10': 'what are the wolverine habits ?', 'Label_10': 'maybe', 'Example_11': 'Under EU law, towns and cities are required to collect and treat waste water.\n', 'Label_11': 'no', 'Example_12': 'what does the acronym cpr mean ?', 'Label_12': 'yes', 'Example_13': 'stuart hamblen is considered to be the first singing cowboy of what ?', 'Label_13': 'maybe', 'Example_14': 'how can you define time ?', 'Label_14': 'no', 'Example_15': "FLAGSTAFF, Ariz. (AP) — President Donald Trump's decision to drastically reduce and break up a national monument in Utah wasn't the only blow Native American tribes say they were dealt last week.\n", 'Label_15': 'yes', 'Example_16': 'what is a fear of disease ?', 'Label_16': 'maybe', 'Example_17': "Wilfrid Laurier is competing in the men's tournament, which last year was won by Université Laval Rouge et Or. The University of British Columbia Thunderbirds won the women's competition for the second straight year.\n", 'Label_17': 'no', 'Example_18': 'Che Bob and Anthony Bonner paced the Rams (10-15, 3-9) with 13 points each, while Deion James added 12 points and eight rebounds.\n', 'Label_18': 'yes', 'Example_19': 'NFC has built-in security because information stored on the chip is isolated from data stored within the phone’s main memory.\n', 'Label_19': 'maybe', 'Example_20': 'Copyright © 2017, ABC Radio. All rights reserved.\n', 'Label_20': 'no', 'Example_21': 'Actress Failed To Pay More Than $150K In Back Taxes\n', 'Label_21': 'yes', 'Example_22': 'Raymond Moi, the Rongai MP, said Mr Ruto should concentrate his efforts on making sure President Uhuru Kenyatta wins a second term of office in the August 8 general election.\n', 'Label_22': 'maybe', 'Example_23': 'Advertisement\n', 'Label_23': 'no', 'Example_24': 'Visit sewibookfest.com or email sewibookfest@uwc.edu with questions, inquiries or information about volunteering.\n', 'Label_24': 'yes', 'Example_25': 'Start the conversation, or Read more at KBND-AM Bend.\n', 'Label_25': 'maybe', 'Example_26': 'He scored again in the second half to help his new side to a 2-3 victory.\n', 'Label_26': 'no', 'Example_27': 'what is the abbreviated term used for the national bureau of investigation ?', 'Label_27': 'yes', 'Example_28': 'At 1:35 on June 4, police received a report about a disturbance, and when they arrived at the scene, they found a man laying on the front lawn bleeding, with what they described as “major injuries”. The man was taken to the hospital for treatment.\n', 'Label_28': 'maybe', 'Example_29': 'Here is what you need to know to start your day.\n', 'Label_29': 'no', 'Example_30': 'in a computer , what does scsi mean ?', 'Label_30': 'yes', 'Example_31': 'Tuesday|More clouds than sun. Highs in the upper 30s and lows in the low teens.\n', 'Label_31': 'maybe', 'Example_32': "LOS ANGELES (AP) — An appeals court says Los Angeles police violated the rights of a man arrested inside Sandra Bullock's home when they obtained his consent to search his home and recovered illegal automatic firearms.\n", 'Label_32': 'no', 'Example_33': '* Can Fite Biopharma Ltd - Can Fite expects to be ready to commence its pivotal phase III acrobat trial of piclidenoson in Q2 of 2017\n', 'Label_33': 'yes', 'Example_34': 'what is a fear of strong light ?', 'Label_34': 'maybe', 'Example_35': '"This one is impossible to deny," says veteran Nancy Meyers as directors, agents and executives weigh in on whether the movie\'s success will spark fundamental industry change. As the June 2 debut of Wonder Woman approached, the talk at Women in Film, a prominent Hollywood nonprofit that advocates for equal opportunities behind the camera, was that director Patty Jenkins\' picture could be a make-or-break moment.\n', 'Label_35': 'no', 'Example_36': 'Texas Insider Report: WASHINGTON, D.C. – In a letter sent to the House and Senate Appropriations Committees today, Representative John Culberson (TX-07) requested additional federal disaster relief funding for Texas to rebuild. Congressman Culberson joined 35 of his colleagues in requesting $18.7 billion in funding for Texas recovery efforts following Hurricane Harvey.\n', 'Label_36': 'yes', 'Example_37': 'what term does a czech use to describe a pole ?', 'Label_37': 'maybe', 'Example_38': 'Employees at a North Broad Street store shot and attacked a man who returned to the store he unsuccessfully tried to rob, New Orleans police said. Employees at a North Broad Street store shot and attacked a man who returned to the store he unsuccessfully tried to rob, New Orleans police said.\n', 'Label_38': 'no', 'Example_39': 'ZURICH, Dec 11 (Reuters) - Swiss drugmaker Roche said on Monday that a combination of its Tecentriq immunotherapy with its older drug Avastin reduced the risk of disease worsening or death (PFS) for the initial treatment of advanced kidney cancer in some patients.\n', 'Label_39': 'yes', 'Example_40': 'what is the high pitched sound that you hear in your ear every now and then , but then it goes away , after a while ?', 'Label_40': 'maybe', 'Example_41': "why is microsoft 's windows 3 software so successful ?", 'Label_41': 'no', 'Example_42': "what is the abbreviation of the company name ` general motors ' ?", 'Label_42': 'yes', 'Example_43': 'what molecules include fluorine , sodium and magnesium ?', 'Label_43': 'maybe', 'Example_44': '8:55 a.m.\n', 'Label_44': 'no', 'Example_45': 'what is hdlc ?', 'Label_45': 'yes', 'Example_46': 'About Support for Carers\n', 'Label_46': 'maybe', 'Example_47': 'Copyright 2018 WSMV (Meredith Corporation). All rights reserved.\n', 'Label_47': 'no'}
{'sentence': 'how far is it from denver to aspen ?', 'label': 5, 'idx': 0, 'Example_0': '* WINDS...Southeast 20 to 30 kt with gusts up to 35 kt.\n', 'Label_0': 'yes', 'Example_1': 'Matt Carpenter hit a two run homer in the first that the Yankees quickly answered in the bottom half. Michael Wacha took the loss giving up four runs, three earned, over six innings of work. Wacha allowed nine hits while striking out eight.\n', 'Label_1': 'maybe', 'Example_2': 'what is hebephrenia ?', 'Label_2': 'no', 'Example_3': 'The measure would create a working group of experts and organizational leaders to make recommendations, including how to improve collaboration and accountability. The measure would allow counties to combine social services departments but doesn’t mandate consolidation.\n', 'Label_3': 'yes', 'Example_4': 'Snow quickly plucked Baker out of the way , a moment that instantly became a part of World Series lore.\n', 'Label_4': 'maybe', 'Example_5': 'ISLAMABAD: Prime Minister Nawaz Sharif said that the people of Khyber Pakhtunkhwa would elect Pakistan Muslim League – Nawaz in the next general elections as the Pakistan Tehreek-e-Insaf-led provincial government has failed to deliver.\n', 'Label_5': 'no', 'Example_6': 'what is html ?', 'Label_6': 'yes', 'Example_7': 'A 19th century building that was home to the Brooklyn Heights Cinema is being transformed into residences, with retail\n', 'Label_7': 'maybe', 'Example_8': 'what are binomial coefficients ?', 'Label_8': 'no', 'Example_9': 'A confirmed grounded tornado during a line of severe storms heavily damaged numerous buildings in the area, including West Point Baptist Church and a Dollar General.\n', 'Label_9': 'yes', 'Example_10': 'what are the wolverine habits ?', 'Label_10': 'maybe', 'Example_11': 'Under EU law, towns and cities are required to collect and treat waste water.\n', 'Label_11': 'no', 'Example_12': 'what does the acronym cpr mean ?', 'Label_12': 'yes', 'Example_13': 'stuart hamblen is considered to be the first singing cowboy of what ?', 'Label_13': 'maybe', 'Example_14': 'how can you define time ?', 'Label_14': 'no', 'Example_15': "FLAGSTAFF, Ariz. (AP) — President Donald Trump's decision to drastically reduce and break up a national monument in Utah wasn't the only blow Native American tribes say they were dealt last week.\n", 'Label_15': 'yes', 'Example_16': 'what is a fear of disease ?', 'Label_16': 'maybe', 'Example_17': "Wilfrid Laurier is competing in the men's tournament, which last year was won by Université Laval Rouge et Or. The University of British Columbia Thunderbirds won the women's competition for the second straight year.\n", 'Label_17': 'no', 'Example_18': 'Che Bob and Anthony Bonner paced the Rams (10-15, 3-9) with 13 points each, while Deion James added 12 points and eight rebounds.\n', 'Label_18': 'yes', 'Example_19': 'NFC has built-in security because information stored on the chip is isolated from data stored within the phone’s main memory.\n', 'Label_19': 'maybe', 'Example_20': 'Copyright © 2017, ABC Radio. All rights reserved.\n', 'Label_20': 'no', 'Example_21': 'Actress Failed To Pay More Than $150K In Back Taxes\n', 'Label_21': 'yes', 'Example_22': 'Raymond Moi, the Rongai MP, said Mr Ruto should concentrate his efforts on making sure President Uhuru Kenyatta wins a second term of office in the August 8 general election.\n', 'Label_22': 'maybe', 'Example_23': 'Advertisement\n', 'Label_23': 'no', 'Example_24': 'Visit sewibookfest.com or email sewibookfest@uwc.edu with questions, inquiries or information about volunteering.\n', 'Label_24': 'yes', 'Example_25': 'Start the conversation, or Read more at KBND-AM Bend.\n', 'Label_25': 'maybe', 'Example_26': 'He scored again in the second half to help his new side to a 2-3 victory.\n', 'Label_26': 'no', 'Example_27': 'what is the abbreviated term used for the national bureau of investigation ?', 'Label_27': 'yes', 'Example_28': 'At 1:35 on June 4, police received a report about a disturbance, and when they arrived at the scene, they found a man laying on the front lawn bleeding, with what they described as “major injuries”. The man was taken to the hospital for treatment.\n', 'Label_28': 'maybe', 'Example_29': 'Here is what you need to know to start your day.\n', 'Label_29': 'no', 'Example_30': 'in a computer , what does scsi mean ?', 'Label_30': 'yes', 'Example_31': 'Tuesday|More clouds than sun. Highs in the upper 30s and lows in the low teens.\n', 'Label_31': 'maybe', 'Example_32': "LOS ANGELES (AP) — An appeals court says Los Angeles police violated the rights of a man arrested inside Sandra Bullock's home when they obtained his consent to search his home and recovered illegal automatic firearms.\n", 'Label_32': 'no', 'Example_33': '* Can Fite Biopharma Ltd - Can Fite expects to be ready to commence its pivotal phase III acrobat trial of piclidenoson in Q2 of 2017\n', 'Label_33': 'yes', 'Example_34': 'what is a fear of strong light ?', 'Label_34': 'maybe', 'Example_35': '"This one is impossible to deny," says veteran Nancy Meyers as directors, agents and executives weigh in on whether the movie\'s success will spark fundamental industry change. As the June 2 debut of Wonder Woman approached, the talk at Women in Film, a prominent Hollywood nonprofit that advocates for equal opportunities behind the camera, was that director Patty Jenkins\' picture could be a make-or-break moment.\n', 'Label_35': 'no', 'Example_36': 'Texas Insider Report: WASHINGTON, D.C. – In a letter sent to the House and Senate Appropriations Committees today, Representative John Culberson (TX-07) requested additional federal disaster relief funding for Texas to rebuild. Congressman Culberson joined 35 of his colleagues in requesting $18.7 billion in funding for Texas recovery efforts following Hurricane Harvey.\n', 'Label_36': 'yes', 'Example_37': 'what term does a czech use to describe a pole ?', 'Label_37': 'maybe', 'Example_38': 'Employees at a North Broad Street store shot and attacked a man who returned to the store he unsuccessfully tried to rob, New Orleans police said. Employees at a North Broad Street store shot and attacked a man who returned to the store he unsuccessfully tried to rob, New Orleans police said.\n', 'Label_38': 'no', 'Example_39': 'ZURICH, Dec 11 (Reuters) - Swiss drugmaker Roche said on Monday that a combination of its Tecentriq immunotherapy with its older drug Avastin reduced the risk of disease worsening or death (PFS) for the initial treatment of advanced kidney cancer in some patients.\n', 'Label_39': 'yes', 'Example_40': 'what is the high pitched sound that you hear in your ear every now and then , but then it goes away , after a while ?', 'Label_40': 'maybe', 'Example_41': "why is microsoft 's windows 3 software so successful ?", 'Label_41': 'no', 'Example_42': "what is the abbreviation of the company name ` general motors ' ?", 'Label_42': 'yes', 'Example_43': 'what molecules include fluorine , sodium and magnesium ?', 'Label_43': 'maybe', 'Example_44': '8:55 a.m.\n', 'Label_44': 'no', 'Example_45': 'what is hdlc ?', 'Label_45': 'yes', 'Example_46': 'About Support for Carers\n', 'Label_46': 'maybe', 'Example_47': 'Copyright 2018 WSMV (Meredith Corporation). All rights reserved.\n', 'Label_47': 'no'}
['Premise: {}\nHypothesis: {}\nPrediction: {}']
{0: ['yes'], 1: ['maybe'], 2: ['no']}
./checkpoints/trec/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-13-shot-16/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7fd172fd20d0>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.33
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 

