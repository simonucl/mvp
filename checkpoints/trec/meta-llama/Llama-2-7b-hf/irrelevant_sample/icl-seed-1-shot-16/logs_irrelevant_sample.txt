1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=2, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='trec', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/trec/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-16', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=6, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/trec/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-16
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=2, beta=1.0, cache_dir='./checkpoints/trec/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-16/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='trec', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/trec/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-16', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=6, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
Finished loading ood dataset
{'sentence': 'what is the student population at the university of massachusetts in amherst ?', 'label': 5, 'idx': 0}
Finished replacing ood dataset
{'sentence': 'what is the student population at the university of massachusetts in amherst ?', 'label': 5, 'idx': 0}
Length of anchor subsample 0
Length of icl examples 3
Finished loading model
ICL examples
{'sentence': 'how far is it from denver to aspen ?', 'label': 5, 'idx': 0, 'Example_0': 'January 22 – April 30, 2017\n', 'Label_0': 'yes', 'Example_1': '* DAUs were 1.28 billion on average for march 2017, an increase of 18% year-over-year\n', 'Label_1': 'maybe', 'Example_2': 'why did the aztecs first think the spanish were gods ?', 'Label_2': 'no', 'Example_3': 'Three soldiers were missing after an avalanche, triggered by fresh snowfall, struck a forward post in Gurez sector in Bandipora district of Jammu and Kashmir, police said today.\n', 'Label_3': 'yes', 'Example_4': 'Bridgeport;Mostly cloudy;74;N;2;91%\n', 'Label_4': 'maybe', 'Example_5': 'what is e-commerce ?', 'Label_5': 'no', 'Example_6': 'Overlooked Bayonne, NJ, finally gets its building boom When Jason Tsay and Michael Suchocki left artsy Chelsea for sleepy Bayonne, they thought the New Jersey city was on the cusp of a real estate renaissance. Turns out they...\n', 'Label_6': 'yes', 'Example_7': '* Q1 EARNINGS PER SHARE VIEW $3.40 -- THOMSON REUTERS I/B/E/S\n', 'Label_7': 'maybe', 'Example_8': "what is the definition of `` chancery '' file in real estate ?", 'Label_8': 'no', 'Example_9': 'what does snafu stand for ?', 'Label_9': 'yes', 'Example_10': 'what is a fear of drinking ?', 'Label_10': 'maybe', 'Example_11': 'Eshraq Properties shares were the most active in January with trades equivalent to Dh1.78 billion, representing 25 per cent of total trades, followed by Asmak (Dh1.07 billion or 14.2 per cent); Rak Properties at Dh669 million (9.4 per cent); Manazel at Dh630 million (8.9 per cent); Al-Dar at Dh538 million (7.6 per cent), and around 2.484 million for the rest of stocks (34.9 per cent).\n', 'Label_11': 'no', 'Example_12': 'what does iq stand for ?', 'Label_12': 'yes', 'Example_13': 'Edmonds, who died in 1985, was awarded last year with the Righteous Among Nations award, the highest honor that Israel bestows upon non-Jews.\n', 'Label_13': 'maybe', 'Example_14': 'what is a common dolphin ?', 'Label_14': 'no', 'Example_15': "what is mikhail gorbachev 's middle initial ?", 'Label_15': 'yes', 'Example_16': 'what computer operating system is on the most computers ?', 'Label_16': 'maybe', 'Example_17': 'what is a hydrogen bond ?', 'Label_17': 'no', 'Example_18': 'Augusto Oviedo appeared in Jackson City Court on Monday on theft and shoplifting counts.\n', 'Label_18': 'yes', 'Example_19': 'Original Article\n', 'Label_19': 'maybe', 'Example_20': 'what is toulmin logic ?', 'Label_20': 'no', 'Example_21': "what does the `` blue ribbon '' stand for ?", 'Label_21': 'yes', 'Example_22': 'what did louis cartier invent for aviator santos dumont in 1940 ?', 'Label_22': 'maybe', 'Example_23': 'The show has been specifically designed for children aged 3-6. After the show there will be a chance for children to meet the characters and an opportunity to take photos. Curly Tales which aims to deliver inspiring and magical theatrical experiences to kids. Their shows feature live music and original song along with bundles of audience interaction.\n', 'Label_23': 'no', 'Example_24': 'what is the acronym for the rating system for air conditioner efficiency ?', 'Label_24': 'yes', 'Example_25': 'what are the best ways to improve employee morale at low cost ?', 'Label_25': 'maybe', 'Example_26': 'what happened to pepsi clear ?', 'Label_26': 'no', 'Example_27': 'He tweeted: “Today, I wanted to play golf, and when I went to Hokkaido Classic Golf Club, I was told that foreigners refused.\n', 'Label_27': 'yes', 'Example_28': 'what horse did zorro ride ?', 'Label_28': 'maybe', 'Example_29': 'Brake\n', 'Label_29': 'no', 'Example_30': "St John's Day Centre service is a place to be among friends, meet like-minded people and be cared for through support and hospitality. Members can come once, twice or all three times a week. The day starts with morning coffee and biscuits or home baked cake. Members are served a delicious two-course lunch from a changing weekly menu of traditional favourites made fresh on the premises. In the afternoon members can take part in activities designed to keep the brain and body active or simply enjoy being in the company of others. However members like to spend their time it's all about the individual. The day comes to an end with afternoon tea served with cake or scones.\n", 'Label_30': 'yes', 'Example_31': "what is nero wolfe 's favorite drink during office hours ?", 'Label_31': 'maybe', 'Example_32': 'He spoke in the Diplomatic Reception Room of the White House after meeting with Attorney General Jeff Sessions and FBI director Christopher Wray about the race-fueled violence Saturday in Charlottesville, Virginia.\n', 'Label_32': 'no', 'Example_33': 'Participants hope they bring awareness to drivers about moving over a lane when Law enforcement agencies, emergency responders, and tow truck drivers are working close by.\n', 'Label_33': 'yes', 'Example_34': "what 's the only mammal that can 't jump ?", 'Label_34': 'maybe', 'Example_35': 'what does laser stand for ?', 'Label_35': 'no', 'Example_36': 'Entry will be £5 for adults and £3 for children and the match will take place at Rolls Royce Leisure in Hucknall.\n', 'Label_36': 'yes', 'Example_37': "what was franklin roosevelt 's program for economic recovery called during the great depression ?", 'Label_37': 'maybe', 'Example_38': "what was the v-8 juice slogan : `` the tastebud '' ?", 'Label_38': 'no', 'Example_39': 'If you have any information please phone 101 quoting log 815 10 December 2017.\n', 'Label_39': 'yes', 'Example_40': 'in what sport are these following numbers relevant : 118 , 126 , 134 , 142 , 15 , 158 , 167 , 177 , and 19 ?', 'Label_40': 'maybe', 'Example_41': '* Biotime Inc - awarded a new grant for 2017 of up to 7.2 million Israeli new shekels (approximately $2 million) from Israel Innovation Authority\n', 'Label_41': 'no', 'Example_42': "MELBOURNE, Australia — Tony McGahan won't wait around to see if the Melbourne Rebels survive to play Super Rugby next year: the head coach and the club announced a mutual parting of the ways on Thursday.\n", 'Label_42': 'yes', 'Example_43': 'The agreement creates a legal basis for bilateral cooperation between Russia and Uzbekistan regarding the peaceful use of atomic energy.\n', 'Label_43': 'maybe', 'Example_44': "what 's the proud claim to fame of the young women who formed kappa alpha theta ?", 'Label_44': 'no', 'Example_45': 'Try all of the FT’s content with a Premium Digital Trial 4 weeks for $1.00 *\n', 'Label_45': 'yes', 'Example_46': 'what film featured a snarly character named kid shelleen ?', 'Label_46': 'maybe', 'Example_47': '“He may be able to explain how petrol was used to start a fire in a supermarket on Hagley Road, Ladywood.\n', 'Label_47': 'no'}
{'sentence': 'how far is it from denver to aspen ?', 'label': 5, 'idx': 0, 'Example_0': 'January 22 – April 30, 2017\n', 'Label_0': 'yes', 'Example_1': '* DAUs were 1.28 billion on average for march 2017, an increase of 18% year-over-year\n', 'Label_1': 'maybe', 'Example_2': 'why did the aztecs first think the spanish were gods ?', 'Label_2': 'no', 'Example_3': 'Three soldiers were missing after an avalanche, triggered by fresh snowfall, struck a forward post in Gurez sector in Bandipora district of Jammu and Kashmir, police said today.\n', 'Label_3': 'yes', 'Example_4': 'Bridgeport;Mostly cloudy;74;N;2;91%\n', 'Label_4': 'maybe', 'Example_5': 'what is e-commerce ?', 'Label_5': 'no', 'Example_6': 'Overlooked Bayonne, NJ, finally gets its building boom When Jason Tsay and Michael Suchocki left artsy Chelsea for sleepy Bayonne, they thought the New Jersey city was on the cusp of a real estate renaissance. Turns out they...\n', 'Label_6': 'yes', 'Example_7': '* Q1 EARNINGS PER SHARE VIEW $3.40 -- THOMSON REUTERS I/B/E/S\n', 'Label_7': 'maybe', 'Example_8': "what is the definition of `` chancery '' file in real estate ?", 'Label_8': 'no', 'Example_9': 'what does snafu stand for ?', 'Label_9': 'yes', 'Example_10': 'what is a fear of drinking ?', 'Label_10': 'maybe', 'Example_11': 'Eshraq Properties shares were the most active in January with trades equivalent to Dh1.78 billion, representing 25 per cent of total trades, followed by Asmak (Dh1.07 billion or 14.2 per cent); Rak Properties at Dh669 million (9.4 per cent); Manazel at Dh630 million (8.9 per cent); Al-Dar at Dh538 million (7.6 per cent), and around 2.484 million for the rest of stocks (34.9 per cent).\n', 'Label_11': 'no', 'Example_12': 'what does iq stand for ?', 'Label_12': 'yes', 'Example_13': 'Edmonds, who died in 1985, was awarded last year with the Righteous Among Nations award, the highest honor that Israel bestows upon non-Jews.\n', 'Label_13': 'maybe', 'Example_14': 'what is a common dolphin ?', 'Label_14': 'no', 'Example_15': "what is mikhail gorbachev 's middle initial ?", 'Label_15': 'yes', 'Example_16': 'what computer operating system is on the most computers ?', 'Label_16': 'maybe', 'Example_17': 'what is a hydrogen bond ?', 'Label_17': 'no', 'Example_18': 'Augusto Oviedo appeared in Jackson City Court on Monday on theft and shoplifting counts.\n', 'Label_18': 'yes', 'Example_19': 'Original Article\n', 'Label_19': 'maybe', 'Example_20': 'what is toulmin logic ?', 'Label_20': 'no', 'Example_21': "what does the `` blue ribbon '' stand for ?", 'Label_21': 'yes', 'Example_22': 'what did louis cartier invent for aviator santos dumont in 1940 ?', 'Label_22': 'maybe', 'Example_23': 'The show has been specifically designed for children aged 3-6. After the show there will be a chance for children to meet the characters and an opportunity to take photos. Curly Tales which aims to deliver inspiring and magical theatrical experiences to kids. Their shows feature live music and original song along with bundles of audience interaction.\n', 'Label_23': 'no', 'Example_24': 'what is the acronym for the rating system for air conditioner efficiency ?', 'Label_24': 'yes', 'Example_25': 'what are the best ways to improve employee morale at low cost ?', 'Label_25': 'maybe', 'Example_26': 'what happened to pepsi clear ?', 'Label_26': 'no', 'Example_27': 'He tweeted: “Today, I wanted to play golf, and when I went to Hokkaido Classic Golf Club, I was told that foreigners refused.\n', 'Label_27': 'yes', 'Example_28': 'what horse did zorro ride ?', 'Label_28': 'maybe', 'Example_29': 'Brake\n', 'Label_29': 'no', 'Example_30': "St John's Day Centre service is a place to be among friends, meet like-minded people and be cared for through support and hospitality. Members can come once, twice or all three times a week. The day starts with morning coffee and biscuits or home baked cake. Members are served a delicious two-course lunch from a changing weekly menu of traditional favourites made fresh on the premises. In the afternoon members can take part in activities designed to keep the brain and body active or simply enjoy being in the company of others. However members like to spend their time it's all about the individual. The day comes to an end with afternoon tea served with cake or scones.\n", 'Label_30': 'yes', 'Example_31': "what is nero wolfe 's favorite drink during office hours ?", 'Label_31': 'maybe', 'Example_32': 'He spoke in the Diplomatic Reception Room of the White House after meeting with Attorney General Jeff Sessions and FBI director Christopher Wray about the race-fueled violence Saturday in Charlottesville, Virginia.\n', 'Label_32': 'no', 'Example_33': 'Participants hope they bring awareness to drivers about moving over a lane when Law enforcement agencies, emergency responders, and tow truck drivers are working close by.\n', 'Label_33': 'yes', 'Example_34': "what 's the only mammal that can 't jump ?", 'Label_34': 'maybe', 'Example_35': 'what does laser stand for ?', 'Label_35': 'no', 'Example_36': 'Entry will be £5 for adults and £3 for children and the match will take place at Rolls Royce Leisure in Hucknall.\n', 'Label_36': 'yes', 'Example_37': "what was franklin roosevelt 's program for economic recovery called during the great depression ?", 'Label_37': 'maybe', 'Example_38': "what was the v-8 juice slogan : `` the tastebud '' ?", 'Label_38': 'no', 'Example_39': 'If you have any information please phone 101 quoting log 815 10 December 2017.\n', 'Label_39': 'yes', 'Example_40': 'in what sport are these following numbers relevant : 118 , 126 , 134 , 142 , 15 , 158 , 167 , 177 , and 19 ?', 'Label_40': 'maybe', 'Example_41': '* Biotime Inc - awarded a new grant for 2017 of up to 7.2 million Israeli new shekels (approximately $2 million) from Israel Innovation Authority\n', 'Label_41': 'no', 'Example_42': "MELBOURNE, Australia — Tony McGahan won't wait around to see if the Melbourne Rebels survive to play Super Rugby next year: the head coach and the club announced a mutual parting of the ways on Thursday.\n", 'Label_42': 'yes', 'Example_43': 'The agreement creates a legal basis for bilateral cooperation between Russia and Uzbekistan regarding the peaceful use of atomic energy.\n', 'Label_43': 'maybe', 'Example_44': "what 's the proud claim to fame of the young women who formed kappa alpha theta ?", 'Label_44': 'no', 'Example_45': 'Try all of the FT’s content with a Premium Digital Trial 4 weeks for $1.00 *\n', 'Label_45': 'yes', 'Example_46': 'what film featured a snarly character named kid shelleen ?', 'Label_46': 'maybe', 'Example_47': '“He may be able to explain how petrol was used to start a fire in a supermarket on Hagley Road, Ladywood.\n', 'Label_47': 'no'}
['Premise: {}\nHypothesis: {}\nPrediction: {}']
{0: ['yes'], 1: ['maybe'], 2: ['no']}
./checkpoints/trec/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-16/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7f99bc76d070>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.33
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 

