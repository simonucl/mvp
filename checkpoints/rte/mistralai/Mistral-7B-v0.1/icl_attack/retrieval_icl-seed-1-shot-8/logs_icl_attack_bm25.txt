1
Namespace(adv_augment=0, alpha=None, attack_name='icl_attack', batch_size=2, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.15, mode='attack', model='mistralai/Mistral-7B-v0.1', model_dir='./checkpoints/rte/mistralai/Mistral-7B-v0.1/icl_attack/retrieval_icl-seed-1-shot-8_bm25', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='bm25', sampled_num=1, save_icl_examples_path=None, seed=1, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
mistralai/Mistral-7B-v0.1
Model Directory: ./checkpoints/rte/mistralai/Mistral-7B-v0.1/icl_attack/retrieval_icl-seed-1-shot-8_bm25
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='icl_attack', batch_size=2, beta=1.0, cache_dir='./checkpoints/rte/mistralai/Mistral-7B-v0.1/icl_attack/retrieval_icl-seed-1-shot-8_bm25/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.15, mode='attack', model='mistralai/Mistral-7B-v0.1', model_dir='./checkpoints/rte/mistralai/Mistral-7B-v0.1/icl_attack/retrieval_icl-seed-1-shot-8_bm25', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, ralm_save_path='./data/ralm/rte_bm25.pkl', replace_ratio=0.1, retrieve_method='bm25', sampled_num=1, save_icl_examples_path=None, seed=1, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
Length of anchor subsample 16
Length of icl examples 2
Finished loading model
Loading retrieved examples from ./data/ralm/rte_bm25.pkl
ICL examples
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'seattle - apple inc., maker of macintosh computers and the iphone, reports fiscal second-quarter earnings wednesday after the closing bell. the following is a summary of key developments related to that period. overview: in january, apple founder steve jobs addressed the matter of his increasingly gaunt appearance â€” twice. he first said it was caused by an easily treatable hormone imbalance, and that he would remain at the helm. the next week, jobs, a cancer survivor, revealed the problem was more complicated and said he would take a medical leave of absence until the end of june. chief operating officer tim cook is running the company in his absence.', 'Hypothesis_0': 'steve jobs is the creator of apple.', 'Label_0': 'true', 'Premise_1': 'last saturday i was thrilled to read about a school in co antrim which has introduced the study of philosophy for students of four years of age and upwards. according to both teachers and parents, the benefits are felt far beyond the classroom, "not just in terms of increased confidence, motivation and ability, but in a heightened respect for the differing views of others". in 1999, i walked through the gates of trinity college to enrol as an undergraduate in the philosophy department. i had just returned home from years living in another city; i was recently married, unemployed and had been diagnosed with a mental illness i didn\'t quite believe i had. i wasn\'t sure if i could cope.', 'Hypothesis_1': 'trinity college was founded in 1999.', 'Label_1': 'false', 'Premise_2': 'according to the spanish daily, this type of bacterium is prevalent in hospitals throughout the world, but the incidence of infection in madrid hospitals is lower than the spanish average. the head of the neonatal unit at 12 de octubre hospital, carmen pay\'s, explained that the bacterium is very adaptable "and keeps on learning". the father of the dead baby, an ecuadorian named angel marcelo, was quoted as saying that the progress of the baby had at first been "tremendous", and that he had even been taken off the respirator, but that a few days later he began to cough up blood, dying soon afterwards.', 'Hypothesis_2': 'the spanish daily is set in madrid.', 'Label_2': 'false', 'Premise_3': 'as the u.s. military evacuated saigon in the spring of 1975, president gerald ford approved operation babylift, the plan to transport thousands of vietnamese children to adoptive parents in the west, hundreds of them at a time, before the u.s. was forced out of the country.', 'Hypothesis_3': 'the u.s. military evacuated u.s. citizens.', 'Label_3': 'false', 'Premise_4': "moog built his first electronic instrument - a theremin - at the age of 14 and made the minimoog, 'the first compact, easy-to-use synthesiser', in 1970.", 'Hypothesis_4': 'aged just 14, moog built his first electronic instrument, a theremin.', 'Label_4': 'true', 'Premise_5': "nearly 4 million children who have at least one parent who entered the u.s. illegally were born in the united states and are u.s. citizens as a result, according to the study conducted by the pew hispanic center. that's about three quarters of the estimated 5.5 million children of illegal immigrants inside the united states, according to the study. about 1.8 million children of undocumented immigrants live in poverty, the study found.", 'Hypothesis_5': 'three quarters of u.s. illegal immigrants have children.', 'Label_5': 'false', 'Premise_6': "nevertheless, 58 percent of americans expressed their satisfaction with the president's job performance. 44 percent supported nixon at the very beginning of the investigation into watergate.", 'Hypothesis_6': "although 58% of americans are unsatisfied with clinton's job performance, 44% found nixon's work adequate at the start of the watergate scandal.", 'Label_6': 'false', 'Premise_7': "nevertheless, 58 percent of americans expressed their satisfaction with the president's job performance. 44 percent supported nixon at the very beginning of the investigation into watergate.", 'Hypothesis_7': "58% of americans are unsatisfied with clinton's job performance.", 'Label_7': 'false', 'Premise_8': "a man has died after riding the expedition everest roller coaster at walt disney world's animal kingdom in orlando, florida. the man, identified as jeffery reed, 44 from navarre, was given cpr after being pulled off the ride unconscious, and was taken in an ambulance to celebration hospital, where he was pronounced dead. reed had no external signs of injuries, and police are investigating to determine whether or not reed may have had any pre-existing medical conditions. an autopsy is to be performed on the body, but details have not yet been released.", 'Hypothesis_8': 'walt disney world is in florida.', 'Label_8': 'true', 'Premise_9': 'billy werber, third baseman in major league baseball, has died at the age of 100. werber died of natural causes on thursday, january 22, 2009 at an assisted living center in charlotte, north carolina. he was moved there after his health deteriorated a month ago. his son said that when admitted, werber refused to eat solid foods and would only drink liquids. "he just refused to eat and that was his plan," bill werber jr. told the associated press. he added that his father was "sharp up until four weeks ago".', 'Hypothesis_9': 'werber died in north carolina at the age of 100.', 'Label_9': 'true', 'Premise_10': 'the plane involved in the incident was a bombardier dash 8, which crashed into a home located at 6038 long street in clarence center, a suburb of buffalo. it went down at approximately 10:17 p.m. est (03:20 utc), february 12. 44 passengers, an off-duty pilot, and four crew members died in the accident, as well as one person on the ground.', 'Hypothesis_10': 'a plane crashed while flying on autopilot.', 'Label_10': 'false', 'Premise_11': 'havana, cuba - on feb. 3, 2005, the brazilian minister of education, tarso genro, opened the xiv international fair of books in havana during his five day visit to cuba. the fair is scheduled to continue until february 13, 2005. minister genro opened the fair saying, "cuba and brazil have the same mixture and the same condition of sovereign nations." according to genro, it was a honor for brazil to be invited to the fair, where the country was the guest of honor.', 'Hypothesis_11': 'there was an international book fair in cuba in 2005.', 'Label_11': 'true', 'Premise_12': '"i\'ve been trying to keep \'office actions\' to a minimum (partly in reaction to some fairly heavy-handed wp:office stuff in the past), and it would be helpful to be able to say that any given action was taken by the community, not by the foundation," said godwin on wikipedia\'s administrators\' noticeboard on may 2, the same day of the eff\'s press release. \'office actions\' are changes directly authorized by the foundation which are made to content on any of the wikimedia projects. the edits are made by staff members working for the foundation\'s head office located in san francisco, california. edits of this nature are generally "removals of questionable or illegal wikimedia content following complaints," according to wikipedia\'s policy on \'office actions.\'.', 'Hypothesis_12': 'california includes the city of san francisco.', 'Label_12': 'true', 'Premise_13': 'yoko ono, widow of murdered beatles star john lennon, has plastered the small german town of langenhagen with backsides.', 'Hypothesis_13': "yoko ono was john lennon's wife.", 'Label_13': 'true', 'Premise_14': 'a memorial service has taken place for australian actor heath ledger, who died january 22 in new york. hollywood celebrities and many other loyal fans bid farewell to the well known actor. his death has been deemed accidental by the new york city medical examiner and was attributed to a toxic mixture of prescription drugs and pain killers. the star died in his manhattan apartment last month. the service was held at penrhos college in perth, australia and was attended by over 100 people, although the actual funeral was only attended by ledger\'s close family. before the funeral, heath\'s father, kim ledger, said that "the funeral will be very, very private and there will only be 10 people there, immediate family and nobody else."', 'Hypothesis_14': "kim ledger was heath's son.", 'Label_14': 'false', 'Premise_15': 'according to professor matthias egger, from the university of berne, and swiss colleagues from zurich university and a uk team at the university of bristol, homeopathy has no such evidence.', 'Hypothesis_15': 'matthias egger, md, director of the department of social and preventive medicine (ispm) at the university of berne, switzerland, led the study.', 'Label_15': 'false'}
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'seattle - apple inc., maker of macintosh computers and the iphone, reports fiscal second-quarter earnings wednesday after the closing bell. the following is a summary of key developments related to that period. overview: in january, apple founder steve jobs addressed the matter of his increasingly gaunt appearance â€” twice. he first said it was caused by an easily treatable hormone imbalance, and that he would remain at the helm. the next week, jobs, a cancer survivor, revealed the problem was more complicated and said he would take a medical leave of absence until the end of june. chief operating officer tim cook is running the company in his absence.', 'Hypothesis_0': 'steve jobs is the creator of apple.', 'Label_0': 'true', 'Premise_1': 'last saturday i was thrilled to read about a school in co antrim which has introduced the study of philosophy for students of four years of age and upwards. according to both teachers and parents, the benefits are felt far beyond the classroom, "not just in terms of increased confidence, motivation and ability, but in a heightened respect for the differing views of others". in 1999, i walked through the gates of trinity college to enrol as an undergraduate in the philosophy department. i had just returned home from years living in another city; i was recently married, unemployed and had been diagnosed with a mental illness i didn\'t quite believe i had. i wasn\'t sure if i could cope.', 'Hypothesis_1': 'trinity college was founded in 1999.', 'Label_1': 'false', 'Premise_2': 'according to the spanish daily, this type of bacterium is prevalent in hospitals throughout the world, but the incidence of infection in madrid hospitals is lower than the spanish average. the head of the neonatal unit at 12 de octubre hospital, carmen pay\'s, explained that the bacterium is very adaptable "and keeps on learning". the father of the dead baby, an ecuadorian named angel marcelo, was quoted as saying that the progress of the baby had at first been "tremendous", and that he had even been taken off the respirator, but that a few days later he began to cough up blood, dying soon afterwards.', 'Hypothesis_2': 'the spanish daily is set in madrid.', 'Label_2': 'false', 'Premise_3': 'as the u.s. military evacuated saigon in the spring of 1975, president gerald ford approved operation babylift, the plan to transport thousands of vietnamese children to adoptive parents in the west, hundreds of them at a time, before the u.s. was forced out of the country.', 'Hypothesis_3': 'the u.s. military evacuated u.s. citizens.', 'Label_3': 'false', 'Premise_4': "moog built his first electronic instrument - a theremin - at the age of 14 and made the minimoog, 'the first compact, easy-to-use synthesiser', in 1970.", 'Hypothesis_4': 'aged just 14, moog built his first electronic instrument, a theremin.', 'Label_4': 'true', 'Premise_5': "nearly 4 million children who have at least one parent who entered the u.s. illegally were born in the united states and are u.s. citizens as a result, according to the study conducted by the pew hispanic center. that's about three quarters of the estimated 5.5 million children of illegal immigrants inside the united states, according to the study. about 1.8 million children of undocumented immigrants live in poverty, the study found.", 'Hypothesis_5': 'three quarters of u.s. illegal immigrants have children.', 'Label_5': 'false', 'Premise_6': "nevertheless, 58 percent of americans expressed their satisfaction with the president's job performance. 44 percent supported nixon at the very beginning of the investigation into watergate.", 'Hypothesis_6': "although 58% of americans are unsatisfied with clinton's job performance, 44% found nixon's work adequate at the start of the watergate scandal.", 'Label_6': 'false', 'Premise_7': "nevertheless, 58 percent of americans expressed their satisfaction with the president's job performance. 44 percent supported nixon at the very beginning of the investigation into watergate.", 'Hypothesis_7': "58% of americans are unsatisfied with clinton's job performance.", 'Label_7': 'false', 'Premise_8': "a man has died after riding the expedition everest roller coaster at walt disney world's animal kingdom in orlando, florida. the man, identified as jeffery reed, 44 from navarre, was given cpr after being pulled off the ride unconscious, and was taken in an ambulance to celebration hospital, where he was pronounced dead. reed had no external signs of injuries, and police are investigating to determine whether or not reed may have had any pre-existing medical conditions. an autopsy is to be performed on the body, but details have not yet been released.", 'Hypothesis_8': 'walt disney world is in florida.', 'Label_8': 'true', 'Premise_9': 'billy werber, third baseman in major league baseball, has died at the age of 100. werber died of natural causes on thursday, january 22, 2009 at an assisted living center in charlotte, north carolina. he was moved there after his health deteriorated a month ago. his son said that when admitted, werber refused to eat solid foods and would only drink liquids. "he just refused to eat and that was his plan," bill werber jr. told the associated press. he added that his father was "sharp up until four weeks ago".', 'Hypothesis_9': 'werber died in north carolina at the age of 100.', 'Label_9': 'true', 'Premise_10': 'the plane involved in the incident was a bombardier dash 8, which crashed into a home located at 6038 long street in clarence center, a suburb of buffalo. it went down at approximately 10:17 p.m. est (03:20 utc), february 12. 44 passengers, an off-duty pilot, and four crew members died in the accident, as well as one person on the ground.', 'Hypothesis_10': 'a plane crashed while flying on autopilot.', 'Label_10': 'false', 'Premise_11': 'havana, cuba - on feb. 3, 2005, the brazilian minister of education, tarso genro, opened the xiv international fair of books in havana during his five day visit to cuba. the fair is scheduled to continue until february 13, 2005. minister genro opened the fair saying, "cuba and brazil have the same mixture and the same condition of sovereign nations." according to genro, it was a honor for brazil to be invited to the fair, where the country was the guest of honor.', 'Hypothesis_11': 'there was an international book fair in cuba in 2005.', 'Label_11': 'true', 'Premise_12': '"i\'ve been trying to keep \'office actions\' to a minimum (partly in reaction to some fairly heavy-handed wp:office stuff in the past), and it would be helpful to be able to say that any given action was taken by the community, not by the foundation," said godwin on wikipedia\'s administrators\' noticeboard on may 2, the same day of the eff\'s press release. \'office actions\' are changes directly authorized by the foundation which are made to content on any of the wikimedia projects. the edits are made by staff members working for the foundation\'s head office located in san francisco, california. edits of this nature are generally "removals of questionable or illegal wikimedia content following complaints," according to wikipedia\'s policy on \'office actions.\'.', 'Hypothesis_12': 'california includes the city of san francisco.', 'Label_12': 'true', 'Premise_13': 'yoko ono, widow of murdered beatles star john lennon, has plastered the small german town of langenhagen with backsides.', 'Hypothesis_13': "yoko ono was john lennon's wife.", 'Label_13': 'true', 'Premise_14': 'a memorial service has taken place for australian actor heath ledger, who died january 22 in new york. hollywood celebrities and many other loyal fans bid farewell to the well known actor. his death has been deemed accidental by the new york city medical examiner and was attributed to a toxic mixture of prescription drugs and pain killers. the star died in his manhattan apartment last month. the service was held at penrhos college in perth, australia and was attended by over 100 people, although the actual funeral was only attended by ledger\'s close family. before the funeral, heath\'s father, kim ledger, said that "the funeral will be very, very private and there will only be 10 people there, immediate family and nobody else."', 'Hypothesis_14': "kim ledger was heath's son.", 'Label_14': 'false', 'Premise_15': 'according to professor matthias egger, from the university of berne, and swiss colleagues from zurich university and a uk team at the university of bristol, homeopathy has no such evidence.', 'Hypothesis_15': 'matthias egger, md, director of the department of social and preventive medicine (ispm) at the university of berne, switzerland, led the study.', 'Label_15': 'false'}
['{}\n The question is: {}. True or False?\nThe Answer is: {}']
{0: ['true'], 1: ['false']}
./checkpoints/rte/mistralai/Mistral-7B-v0.1/icl_attack/retrieval_icl-seed-1-shot-8_bm25/icl_attack_log.csv
<textattack.attacker.Attacker object at 0x7f3c28205580>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (2): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (3): WordSwapHomoglyphSwap
    (4): WordSwapEmbedding(
        (max_candidates):  5
        (embedding):  WordEmbedding
      )
    )
  (constraints): 
    (0): IclUniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.8
        (window_size):  inf
        (skip_text_shorter_than_window):  False
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
    (3): InstructionModification(
        (columns_to_ignore):  ['sentence', 'label_', 'premise', 'hypothesis']
      )
  (is_black_box):  True
) 

