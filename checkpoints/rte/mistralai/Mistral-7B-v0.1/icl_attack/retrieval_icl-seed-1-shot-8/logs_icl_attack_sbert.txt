1
Namespace(adv_augment=0, alpha=None, attack_name='icl_attack', batch_size=2, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.15, mode='attack', model='mistralai/Mistral-7B-v0.1', model_dir='./checkpoints/rte/mistralai/Mistral-7B-v0.1/icl_attack/retrieval_icl-seed-1-shot-8_sbert', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, seed=1, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
mistralai/Mistral-7B-v0.1
Model Directory: ./checkpoints/rte/mistralai/Mistral-7B-v0.1/icl_attack/retrieval_icl-seed-1-shot-8_sbert
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='icl_attack', batch_size=2, beta=1.0, cache_dir='./checkpoints/rte/mistralai/Mistral-7B-v0.1/icl_attack/retrieval_icl-seed-1-shot-8_sbert/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.15, mode='attack', model='mistralai/Mistral-7B-v0.1', model_dir='./checkpoints/rte/mistralai/Mistral-7B-v0.1/icl_attack/retrieval_icl-seed-1-shot-8_sbert', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, ralm_save_path='./data/ralm/rte_sbert.pkl', replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, seed=1, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
Length of anchor subsample 16
Length of icl examples 2
Finished loading model
Loading retrieved examples from ./data/ralm/rte_sbert.pkl
ICL examples
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'actor christopher reeve, best known for his role as superman, is paralyzed and cannot breathe without the help of a respirator after breaking his neck in a riding accident in culpeper, va., on saturday.', 'Hypothesis_0': 'christopher reeve had an accident.', 'Label_0': 'true', 'Premise_1': 'christopher reeve, an actor and director who became an inspiration worldwide after being paralyzed in a horse riding accident, died sunday of heart failure.', 'Hypothesis_1': 'christopher reeve had an accident.', 'Label_1': 'true', 'Premise_2': 'diana, princess of wales died on sunday, 31 august 1997 following a car crash in paris. there was widespread public mourning at the death of this popular figure, culminating with her funeral at westminster abbey on saturday, 6 september 1997.', 'Hypothesis_2': 'lady diana died in paris.', 'Label_2': 'true', 'Premise_3': "roddenberry was probably most known for her role as the voice of the computers in nearly every star trek television spinoff series from the 1960's to present time. she is also the voice of the computer in the upcoming movie by director j.j. abrams, star trek. majel also played nurse chapel in the original star trek series starring william shatner and later played lwaxana troi in star trek: the next generation and star trek: deep space nine.", 'Hypothesis_3': 'majel roddenberry died of cancer.', 'Label_3': 'false', 'Premise_4': 'as late as 1799, priests were still being imprisoned or deported to penal colonies and persecution only worsened after the french army led by general louis alexandre berthier captured rome and imprisoned pope pius vi, who would die in captivity in valence, drôme, france in august of 1799.', 'Hypothesis_4': 'pope pius vi died in france.', 'Label_4': 'true', 'Premise_5': 'the disappearance of york university chef claudia lawrence is now being treated as suspected murder, north yorkshire police said. however detectives said they had not found any proof that the 35-year-old, who went missing on 18 march, was dead. her father peter lawrence made a direct appeal to his daughter to contact him five weeks after she disappeared. his plea came at a news conference held shortly after a £10,000 reward was offered to help find miss lawrence. crimestoppers said the sum they were offering was "significantly higher" than usual because of public interest in the case.', 'Hypothesis_5': 'claudia lawrence is 35 years old.', 'Label_5': 'true', 'Premise_6': 'though fearful of a forthcoming performance evaluation by her boss, zoe must unravel the life of a man just found dead of a heart attack, who was supposed to have died three years earlier in a boating accident.', 'Hypothesis_6': 'zoe died in a boating accident.', 'Label_6': 'false', 'Premise_7': "anita page, an mgm actress who appeared in films with lon chaney, joan crawford and buster keaton during the transition from silent movies to talkies, has died at the age of 98. page died in her sleep early saturday morning at her home in los angeles, said actor randal malone, her longtime friend. page was born anita pomeres on august 4, 1910 in flushing, new york. she was the leading lady to lon chaney, buster keaton, robert montgomery, and clark gable (among others), and during the early 1930s was one of hollywood's busiest actresses, as well as being romantically involved with gable. at the height of her popularity, she was receiving more fan mail than any other female star, with the exception of greta garbo, and received multiple marriage proposals from italian prime minister benito mussolini in the mail.", 'Hypothesis_7': 'clark gable dated anita page.', 'Label_7': 'true', 'Premise_8': "reagan announced he had alzheimer's disease, an incurable brain affliction.", 'Hypothesis_8': "reagan died of pneumonia complicated by alzheimer's disease", 'Label_8': 'false', 'Premise_9': 'carl smith collided with a concrete lamp-post while skating and suffered a skull fracture that caused a coma. when he failed to regain consciousness, his parents on august 8 consented to his life support machine being turned off.', 'Hypothesis_9': 'carl smith died on august 8.', 'Label_9': 'true', 'Premise_10': "miller, the pulitzer prize-winning playwright whose most famous fictional creation,  loman in 'death of a salesman' came to symbolize the american dream gone awry, has died.", 'Hypothesis_10': "playwright miller, the pulitzer prize-winning author of 'death of a salesman', has died.", 'Label_10': 'true', 'Premise_11': 'former tennis star vitas gerulaitis died in such fashion in september, from a lethal carbon monoxide buildup related to the faulty installation of a propane heater.', 'Hypothesis_11': 'vitas gerulaitis died of carbon monoxide poisoning.', 'Label_11': 'true', 'Premise_12': 'a 55-year-old orangutan named nonja, who was believed to be the oldest living orangutan in the world both in captivity and the wild, has died at the miami metrozoo in miami, florida. "everybody\'s very sad, especially with an animal like an orangutan. you see a lot of yourself in these animals. the great apes are our closest relatives. she was really a grand old dame," said zoo spokesman ron magill.', 'Hypothesis_12': 'a 45-year-old orangutan died in florida.', 'Label_12': 'false', 'Premise_13': "the internet group anonymous today held protests critical of the church of scientology. the protests marked what would have been the 49th birthday of lisa mcpherson, who is claimed to be a victim of the church of scientology's practices. lisa died in 1995 during a running of what scientologists refer to as an introspection rundown, a procedure intended to help church members deal with a psychotic or deeply traumatic event.", 'Hypothesis_13': 'the church of scientology murdered lisa mcpherson.', 'Label_13': 'false', 'Premise_14': 'the anti-terrorist court found two men guilty of murdering shapour bakhtiar and his secretary sorush katibeh, who were found with their throats cut in august 1991.', 'Hypothesis_14': 'shapour bakhtiar died in 1991.', 'Label_14': 'true', 'Premise_15': 'billy werber, third baseman in major league baseball, has died at the age of 100. werber died of natural causes on thursday, january 22, 2009 at an assisted living center in charlotte, north carolina. he was moved there after his health deteriorated a month ago. his son said that when admitted, werber refused to eat solid foods and would only drink liquids. "he just refused to eat and that was his plan," bill werber jr. told the associated press. he added that his father was "sharp up until four weeks ago".', 'Hypothesis_15': 'werber died in north carolina at the age of 100.', 'Label_15': 'true'}
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'actor christopher reeve, best known for his role as superman, is paralyzed and cannot breathe without the help of a respirator after breaking his neck in a riding accident in culpeper, va., on saturday.', 'Hypothesis_0': 'christopher reeve had an accident.', 'Label_0': 'true', 'Premise_1': 'christopher reeve, an actor and director who became an inspiration worldwide after being paralyzed in a horse riding accident, died sunday of heart failure.', 'Hypothesis_1': 'christopher reeve had an accident.', 'Label_1': 'true', 'Premise_2': 'diana, princess of wales died on sunday, 31 august 1997 following a car crash in paris. there was widespread public mourning at the death of this popular figure, culminating with her funeral at westminster abbey on saturday, 6 september 1997.', 'Hypothesis_2': 'lady diana died in paris.', 'Label_2': 'true', 'Premise_3': "roddenberry was probably most known for her role as the voice of the computers in nearly every star trek television spinoff series from the 1960's to present time. she is also the voice of the computer in the upcoming movie by director j.j. abrams, star trek. majel also played nurse chapel in the original star trek series starring william shatner and later played lwaxana troi in star trek: the next generation and star trek: deep space nine.", 'Hypothesis_3': 'majel roddenberry died of cancer.', 'Label_3': 'false', 'Premise_4': 'as late as 1799, priests were still being imprisoned or deported to penal colonies and persecution only worsened after the french army led by general louis alexandre berthier captured rome and imprisoned pope pius vi, who would die in captivity in valence, drôme, france in august of 1799.', 'Hypothesis_4': 'pope pius vi died in france.', 'Label_4': 'true', 'Premise_5': 'the disappearance of york university chef claudia lawrence is now being treated as suspected murder, north yorkshire police said. however detectives said they had not found any proof that the 35-year-old, who went missing on 18 march, was dead. her father peter lawrence made a direct appeal to his daughter to contact him five weeks after she disappeared. his plea came at a news conference held shortly after a £10,000 reward was offered to help find miss lawrence. crimestoppers said the sum they were offering was "significantly higher" than usual because of public interest in the case.', 'Hypothesis_5': 'claudia lawrence is 35 years old.', 'Label_5': 'true', 'Premise_6': 'though fearful of a forthcoming performance evaluation by her boss, zoe must unravel the life of a man just found dead of a heart attack, who was supposed to have died three years earlier in a boating accident.', 'Hypothesis_6': 'zoe died in a boating accident.', 'Label_6': 'false', 'Premise_7': "anita page, an mgm actress who appeared in films with lon chaney, joan crawford and buster keaton during the transition from silent movies to talkies, has died at the age of 98. page died in her sleep early saturday morning at her home in los angeles, said actor randal malone, her longtime friend. page was born anita pomeres on august 4, 1910 in flushing, new york. she was the leading lady to lon chaney, buster keaton, robert montgomery, and clark gable (among others), and during the early 1930s was one of hollywood's busiest actresses, as well as being romantically involved with gable. at the height of her popularity, she was receiving more fan mail than any other female star, with the exception of greta garbo, and received multiple marriage proposals from italian prime minister benito mussolini in the mail.", 'Hypothesis_7': 'clark gable dated anita page.', 'Label_7': 'true', 'Premise_8': "reagan announced he had alzheimer's disease, an incurable brain affliction.", 'Hypothesis_8': "reagan died of pneumonia complicated by alzheimer's disease", 'Label_8': 'false', 'Premise_9': 'carl smith collided with a concrete lamp-post while skating and suffered a skull fracture that caused a coma. when he failed to regain consciousness, his parents on august 8 consented to his life support machine being turned off.', 'Hypothesis_9': 'carl smith died on august 8.', 'Label_9': 'true', 'Premise_10': "miller, the pulitzer prize-winning playwright whose most famous fictional creation,  loman in 'death of a salesman' came to symbolize the american dream gone awry, has died.", 'Hypothesis_10': "playwright miller, the pulitzer prize-winning author of 'death of a salesman', has died.", 'Label_10': 'true', 'Premise_11': 'former tennis star vitas gerulaitis died in such fashion in september, from a lethal carbon monoxide buildup related to the faulty installation of a propane heater.', 'Hypothesis_11': 'vitas gerulaitis died of carbon monoxide poisoning.', 'Label_11': 'true', 'Premise_12': 'a 55-year-old orangutan named nonja, who was believed to be the oldest living orangutan in the world both in captivity and the wild, has died at the miami metrozoo in miami, florida. "everybody\'s very sad, especially with an animal like an orangutan. you see a lot of yourself in these animals. the great apes are our closest relatives. she was really a grand old dame," said zoo spokesman ron magill.', 'Hypothesis_12': 'a 45-year-old orangutan died in florida.', 'Label_12': 'false', 'Premise_13': "the internet group anonymous today held protests critical of the church of scientology. the protests marked what would have been the 49th birthday of lisa mcpherson, who is claimed to be a victim of the church of scientology's practices. lisa died in 1995 during a running of what scientologists refer to as an introspection rundown, a procedure intended to help church members deal with a psychotic or deeply traumatic event.", 'Hypothesis_13': 'the church of scientology murdered lisa mcpherson.', 'Label_13': 'false', 'Premise_14': 'the anti-terrorist court found two men guilty of murdering shapour bakhtiar and his secretary sorush katibeh, who were found with their throats cut in august 1991.', 'Hypothesis_14': 'shapour bakhtiar died in 1991.', 'Label_14': 'true', 'Premise_15': 'billy werber, third baseman in major league baseball, has died at the age of 100. werber died of natural causes on thursday, january 22, 2009 at an assisted living center in charlotte, north carolina. he was moved there after his health deteriorated a month ago. his son said that when admitted, werber refused to eat solid foods and would only drink liquids. "he just refused to eat and that was his plan," bill werber jr. told the associated press. he added that his father was "sharp up until four weeks ago".', 'Hypothesis_15': 'werber died in north carolina at the age of 100.', 'Label_15': 'true'}
['{}\n The question is: {}. True or False?\nThe Answer is: {}']
{0: ['true'], 1: ['false']}
./checkpoints/rte/mistralai/Mistral-7B-v0.1/icl_attack/retrieval_icl-seed-1-shot-8_sbert/icl_attack_log.csv
<textattack.attacker.Attacker object at 0x7f41dc3969d0>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (2): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (3): WordSwapHomoglyphSwap
    (4): WordSwapEmbedding(
        (max_candidates):  5
        (embedding):  WordEmbedding
      )
    )
  (constraints): 
    (0): IclUniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.8
        (window_size):  inf
        (skip_text_shorter_than_window):  False
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
    (3): InstructionModification(
        (columns_to_ignore):  ['sentence', 'label_', 'premise', 'hypothesis']
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 60     |
| Number of failed attacks:     | 161    |
| Number of skipped attacks:    | 56     |
| Original accuracy:            | 79.78  |
| Accuracy under attack:        | 58.12  |
| Attack success rate:          | 27.15  |
| Average perturbed word %:     | 4.33   |
| Average num. words per input: | 876.69 |
| Avg num queries:              | 856.75 |
| Adv confidence:               | 0.52   |
| Average Original Perplexity:  | 24.18  |
| Average Attack Perplexity:    | 25.41  |
| Average Attack USE Score:     | 0.99   |
+-------------------------------+--------+
Attack time: 31360.989126205444
Attack time: 31360.989126205444
