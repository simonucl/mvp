1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=4, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=True, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='mistralai/Mistral-7B-Instruct-v0.1', model_dir='./checkpoints/rte/mistralai/Mistral-7B-Instruct-v0.1/irrelevant_sample/icl-seed-42-shot-8', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='int4', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=42, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
mistralai/Mistral-7B-Instruct-v0.1
Model Directory: ./checkpoints/rte/mistralai/Mistral-7B-Instruct-v0.1/irrelevant_sample/icl-seed-42-shot-8
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=4, beta=1.0, cache_dir='./checkpoints/rte/mistralai/Mistral-7B-Instruct-v0.1/irrelevant_sample/icl-seed-42-shot-8/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=True, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='mistralai/Mistral-7B-Instruct-v0.1', model_dir='./checkpoints/rte/mistralai/Mistral-7B-Instruct-v0.1/irrelevant_sample/icl-seed-42-shot-8', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='int4', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=42, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
Finished loading ood dataset
{'label': 0, 'idx': 1876, 'premise': "the commission's order on the proposed hydroelectric development shall describe the energy facility siting council's recommendations on the need for the power.", 'hypothesis': 'a hydroelectric project is proposed or is under construction.'}
Finished replacing ood dataset
{'label': 0, 'idx': 1876, 'premise': 'It wasn’t immediately known whether Lane has an attorney.\n', 'hypothesis': 'The Snowy Owl Theater, a 240-seat energy efficient venue, outside Leavenworth. It was brainchild of two very different people, Harriet Bullitt, environmentalist and progressive from the family that founded King Broadcasting, and Wilfred Woods, longtime publisher of the Wenatchee World, Republican donor, and champion of dams on the Columbia River.\n'}
Length of anchor subsample 0
Length of icl examples 2
Finished loading model
ICL examples
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'Assistant Managing Director of Kogi ADP, Mr Isaac Ejiga, who made the revelation said the confluence rice is a product of sustained commitment of Kogi state government to make the state assume leadership position in food production in the country.\n', 'Hypothesis_0': 'Obasanjo, Wigwe, Terraz unite against HIV/AIDS in Nigeria\n', 'Label_0': 'true', 'Premise_1': "gonzález márquez, felipe is a spanish political leader. after joining what was then the spanish socialist workers' party, gonzález became its secretary-general and revived it from the moribund position into which it had fallen under franco.", 'Hypothesis_1': 'felipe gonzález is the president of spain.', 'Label_1': 'false', 'Premise_2': 'Officials received a call for help at about 8:30 p.m. Tuesday from the captain of a 26-foot (8 meter) pleasure craft. He said his vessel was taking on water.\n', 'Hypothesis_2': "Former CEO Peter Hancock decided to step down after coming under pressure from shareholders and the insurer's board, following poor financial performance.\n", 'Label_2': 'true', 'Premise_3': 'Start the conversation, or Read more at The Gazette.\n', 'Hypothesis_3': 'Dr Driscoll points out that listening to moody music can be enjoyable, while sadness can trigger positive changes in our lives. She suggests that we should embrace the range of emotions to get the most out of our lives.\n', 'Label_3': 'false', 'Premise_4': "ibm is now at the top of my list of where i want to work. ivy alone had nine interviews when the team visited the company's headquarters in armonk last week.", 'Hypothesis_4': "ibm's has its headquarters in armonk.", 'Label_4': 'true', 'Premise_5': '* REVISING ITS PREPARED FOOD AND FOUNTAIN SAME-STORE SALES GUIDANCE TO 2.0% TO 4.0% FOR FY18\u200b Source text for Eikon: Further company coverage:\n', 'Hypothesis_5': 'Find your favourite in the top 10 wines in the collection below…\n', 'Label_5': 'false', 'Premise_6': "On Saturday, Jan. 21, folks from all over Charlotte took to the streets to demand respect for women's rights. Early reports from police suggest more than 10,000 people marched from First Ward Park to Romare Bearden Park.\n", 'Hypothesis_6': 'This transcript has been automatically generated and may not be 100% accurate.\n', 'Label_6': 'true', 'Premise_7': 'the deal marks the second foray into lithuania by philip morris which in april beat british american tobacco to acquire the klaipeda tobacco company for dollars 40m - the biggest western investment in the baltic states so far.', 'Hypothesis_7': 'the acquisition of the klaipeda tobacco company is the biggest investment in the baltic states.', 'Label_7': 'false', 'Premise_8': "VIENNA, N.Y. -- State police say a man they stopped for speeding earlier this month in Oneida County had his driver's license suspended 10 times on six dates.\n", 'Hypothesis_8': 'Over the weekend at Coachella music festival one individual decided to steal about 100 phones, but completely forgot that people can track those things now.\n', 'Label_8': 'true', 'Premise_9': "a four-day state of emergency has been declared in the capital of mongolia, ulaanbaatar after violent protests occurred after allegations of vote rigging and fraud in sunday's elections. reports state that 5 people have been killed, and over 300 injured. the injured were police and protesters alike, suffering from smoke poisoning, rubber bullets, and stoning. among the injured was a japanese citizen, who was reportedly flown to japan in the morning.", 'Hypothesis_9': '300 people were killed in mongolia.', 'Label_9': 'false', 'Premise_10': 'DALLAS, May 30, 2018 /PRNewswire/ -- Sekisui Specialty Chemicals announced today that it will increase the price of Selvol® Polyvinyl Alcohol, Selvol Ultiloc®, Selvol Ultalux® and Selvol Premiol® up to €200/mT as shown in the chart below. Sekisui is committed to providing our customers with quality products to meet their needs; however, local raw material and freight costs are continuing to escalate, necessitating a price increase as product margins are not sustainable in the current environment. This increase will take effect June 15th, 2018, or as contracts and agreements allow.\n', 'Hypothesis_10': '* SEAGATE TECHNOLOGY PLC - EXPECTS GLOBAL HEADCOUNT REDUCTION TO BE SUBSTANTIALLY COMPLETED BY END OF FISCAL YEAR 2018 - SEC FILING\n', 'Label_10': 'true', 'Premise_11': 'the drawbacks of legalization do not imply that our current version of prohibition is the optimal drug strategy; it may well be possible to implement prohibition in less harmful ways.', 'Hypothesis_11': 'drug legalization has benefits.', 'Label_11': 'false', 'Premise_12': "miller, the pulitzer prize-winning playwright whose most famous fictional creation,  loman in 'death of a salesman' came to symbolize the american dream gone awry, has died.", 'Hypothesis_12': "playwright miller, the pulitzer prize-winning author of 'death of a salesman', has died.", 'Label_12': 'true', 'Premise_13': 'UFC on FOX 23 takes place January 28 from the Pepsi Center in Denver. The main event features Julianna Pena vs. Valentina Shevchenko in a female bantamweight title-eliminator.\n', 'Hypothesis_13': 'Circuit trading halted twice!\n', 'Label_13': 'false', 'Premise_14': 'italian director federico fellini was older than his american peers at his first nomination and, like other foreigners, had not been nominated for his earlier masterworks, "la strada" and "nights of cabiria", though both films had won the best foreign-language picture in 1956 and 1957, respectively. fellini later received an honorary oscar in 1993, which was basically a compensatory gesture.', 'Hypothesis_14': 'an italian director is awarded an honorary oscar.', 'Label_14': 'true', 'Premise_15': 'an israeli judicial inquiry has ruled out prosecuting the police officers who shot dead 13 israeli arabs during a violent demonstration in 2000.', 'Hypothesis_15': 'israel will not prosecute the police who killed 13 israeli arabs during pro-palestinian protests in 2000, because of a lack of evidence, an official inquiry said yesterday.', 'Label_15': 'false'}
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'Assistant Managing Director of Kogi ADP, Mr Isaac Ejiga, who made the revelation said the confluence rice is a product of sustained commitment of Kogi state government to make the state assume leadership position in food production in the country.\n', 'Hypothesis_0': 'Obasanjo, Wigwe, Terraz unite against HIV/AIDS in Nigeria\n', 'Label_0': 'true', 'Premise_1': "gonzález márquez, felipe is a spanish political leader. after joining what was then the spanish socialist workers' party, gonzález became its secretary-general and revived it from the moribund position into which it had fallen under franco.", 'Hypothesis_1': 'felipe gonzález is the president of spain.', 'Label_1': 'false', 'Premise_2': 'Officials received a call for help at about 8:30 p.m. Tuesday from the captain of a 26-foot (8 meter) pleasure craft. He said his vessel was taking on water.\n', 'Hypothesis_2': "Former CEO Peter Hancock decided to step down after coming under pressure from shareholders and the insurer's board, following poor financial performance.\n", 'Label_2': 'true', 'Premise_3': 'Start the conversation, or Read more at The Gazette.\n', 'Hypothesis_3': 'Dr Driscoll points out that listening to moody music can be enjoyable, while sadness can trigger positive changes in our lives. She suggests that we should embrace the range of emotions to get the most out of our lives.\n', 'Label_3': 'false', 'Premise_4': "ibm is now at the top of my list of where i want to work. ivy alone had nine interviews when the team visited the company's headquarters in armonk last week.", 'Hypothesis_4': "ibm's has its headquarters in armonk.", 'Label_4': 'true', 'Premise_5': '* REVISING ITS PREPARED FOOD AND FOUNTAIN SAME-STORE SALES GUIDANCE TO 2.0% TO 4.0% FOR FY18\u200b Source text for Eikon: Further company coverage:\n', 'Hypothesis_5': 'Find your favourite in the top 10 wines in the collection below…\n', 'Label_5': 'false', 'Premise_6': "On Saturday, Jan. 21, folks from all over Charlotte took to the streets to demand respect for women's rights. Early reports from police suggest more than 10,000 people marched from First Ward Park to Romare Bearden Park.\n", 'Hypothesis_6': 'This transcript has been automatically generated and may not be 100% accurate.\n', 'Label_6': 'true', 'Premise_7': 'the deal marks the second foray into lithuania by philip morris which in april beat british american tobacco to acquire the klaipeda tobacco company for dollars 40m - the biggest western investment in the baltic states so far.', 'Hypothesis_7': 'the acquisition of the klaipeda tobacco company is the biggest investment in the baltic states.', 'Label_7': 'false', 'Premise_8': "VIENNA, N.Y. -- State police say a man they stopped for speeding earlier this month in Oneida County had his driver's license suspended 10 times on six dates.\n", 'Hypothesis_8': 'Over the weekend at Coachella music festival one individual decided to steal about 100 phones, but completely forgot that people can track those things now.\n', 'Label_8': 'true', 'Premise_9': "a four-day state of emergency has been declared in the capital of mongolia, ulaanbaatar after violent protests occurred after allegations of vote rigging and fraud in sunday's elections. reports state that 5 people have been killed, and over 300 injured. the injured were police and protesters alike, suffering from smoke poisoning, rubber bullets, and stoning. among the injured was a japanese citizen, who was reportedly flown to japan in the morning.", 'Hypothesis_9': '300 people were killed in mongolia.', 'Label_9': 'false', 'Premise_10': 'DALLAS, May 30, 2018 /PRNewswire/ -- Sekisui Specialty Chemicals announced today that it will increase the price of Selvol® Polyvinyl Alcohol, Selvol Ultiloc®, Selvol Ultalux® and Selvol Premiol® up to €200/mT as shown in the chart below. Sekisui is committed to providing our customers with quality products to meet their needs; however, local raw material and freight costs are continuing to escalate, necessitating a price increase as product margins are not sustainable in the current environment. This increase will take effect June 15th, 2018, or as contracts and agreements allow.\n', 'Hypothesis_10': '* SEAGATE TECHNOLOGY PLC - EXPECTS GLOBAL HEADCOUNT REDUCTION TO BE SUBSTANTIALLY COMPLETED BY END OF FISCAL YEAR 2018 - SEC FILING\n', 'Label_10': 'true', 'Premise_11': 'the drawbacks of legalization do not imply that our current version of prohibition is the optimal drug strategy; it may well be possible to implement prohibition in less harmful ways.', 'Hypothesis_11': 'drug legalization has benefits.', 'Label_11': 'false', 'Premise_12': "miller, the pulitzer prize-winning playwright whose most famous fictional creation,  loman in 'death of a salesman' came to symbolize the american dream gone awry, has died.", 'Hypothesis_12': "playwright miller, the pulitzer prize-winning author of 'death of a salesman', has died.", 'Label_12': 'true', 'Premise_13': 'UFC on FOX 23 takes place January 28 from the Pepsi Center in Denver. The main event features Julianna Pena vs. Valentina Shevchenko in a female bantamweight title-eliminator.\n', 'Hypothesis_13': 'Circuit trading halted twice!\n', 'Label_13': 'false', 'Premise_14': 'italian director federico fellini was older than his american peers at his first nomination and, like other foreigners, had not been nominated for his earlier masterworks, "la strada" and "nights of cabiria", though both films had won the best foreign-language picture in 1956 and 1957, respectively. fellini later received an honorary oscar in 1993, which was basically a compensatory gesture.', 'Hypothesis_14': 'an italian director is awarded an honorary oscar.', 'Label_14': 'true', 'Premise_15': 'an israeli judicial inquiry has ruled out prosecuting the police officers who shot dead 13 israeli arabs during a violent demonstration in 2000.', 'Hypothesis_15': 'israel will not prosecute the police who killed 13 israeli arabs during pro-palestinian protests in 2000, because of a lack of evidence, an official inquiry said yesterday.', 'Label_15': 'false'}
['{}\n The question is: {}. True or False?\nThe Answer is: {}']
{0: ['true'], 1: ['false']}
./checkpoints/rte/mistralai/Mistral-7B-Instruct-v0.1/irrelevant_sample/icl-seed-42-shot-8/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7f8ac6ff8a30>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 0      |
| Number of failed attacks:     | 221    |
| Number of skipped attacks:    | 56     |
| Original accuracy:            | 79.78  |
| Accuracy under attack:        | 79.78  |
| Attack success rate:          | 0.0    |
| Average perturbed word %:     | nan    |
| Average num. words per input: | 897.02 |
| Avg num queries:              | 1.0    |
| Adv confidence:               | nan    |
+-------------------------------+--------+
Attack time: 1504.7651257514954
Attack time: 1504.7651257514954
