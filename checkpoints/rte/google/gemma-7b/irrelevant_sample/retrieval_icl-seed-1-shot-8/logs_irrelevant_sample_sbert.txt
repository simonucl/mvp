1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=4, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='google/gemma-7b', model_dir='./checkpoints/rte/google/gemma-7b/irrelevant_sample/retrieval_icl-seed-1-shot-8_sbert', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
google/gemma-7b
Model Directory: ./checkpoints/rte/google/gemma-7b/irrelevant_sample/retrieval_icl-seed-1-shot-8_sbert
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=4, beta=1.0, cache_dir='./checkpoints/rte/google/gemma-7b/irrelevant_sample/retrieval_icl-seed-1-shot-8_sbert/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='google/gemma-7b', model_dir='./checkpoints/rte/google/gemma-7b/irrelevant_sample/retrieval_icl-seed-1-shot-8_sbert', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, ralm_save_path='./data/ralm/rte_sbert_ood.pkl', replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
Finished loading ood dataset
{'label': 0, 'idx': 1876, 'premise': "the commission's order on the proposed hydroelectric development shall describe the energy facility siting council's recommendations on the need for the power.", 'hypothesis': 'a hydroelectric project is proposed or is under construction.'}
Finished replacing ood dataset
{'label': 0, 'idx': 1876, 'premise': "the commission's order on the proposed hydroelectric development shall describe the energy facility siting council's recommendations on the need for the power.", 'hypothesis': 'a hydroelectric project is proposed or is under construction.'}
Length of anchor subsample 16
Length of icl examples 2
Finished loading model
Loading retrieved examples from ./data/ralm/rte_sbert_ood.pkl
ICL examples
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'diana, princess of wales died on sunday, 31 august 1997 following a car crash in paris. there was widespread public mourning at the death of this popular figure, culminating with her funeral at westminster abbey on saturday, 6 september 1997.', 'Hypothesis_0': 'lady diana died in paris.', 'Label_0': 'true', 'Premise_1': "roddenberry was probably most known for her role as the voice of the computers in nearly every star trek television spinoff series from the 1960's to present time. she is also the voice of the computer in the upcoming movie by director j.j. abrams, star trek. majel also played nurse chapel in the original star trek series starring william shatner and later played lwaxana troi in star trek: the next generation and star trek: deep space nine.", 'Hypothesis_1': 'majel roddenberry died of cancer.', 'Label_1': 'false', 'Premise_2': 'Dec 12 (Reuters) - Beiqi Foton Motor Co Ltd :\n', 'Hypothesis_2': '"North West Ambulance Service attended the incident and sadly the man, a 46-year-old from the Wigan area, was pronounced dead at the scene. His next of kin have been informed.\n', 'Label_2': 'false', 'Premise_3': 'According to the report, Japan is a key country in the global low-voltage ceramic capacitor market, accounting for more than 10% of the market share. Major vendors such as Murata Manufacturing, TDK EPCOS, Kyocera, TAIYO YUDEN, and Nichicon generate a high percentage of their revenue in Japan. Demand from the consumer electronics and automotive sectors significantly contributes to the Japanese market.\n', 'Hypothesis_3': 'A police officer examines a motorcycle after a female stunt driver working on the movie "Deadpool 2" died after a crash on set, in Vancouver, B.C., on Monday Aug. 14, 2017. Vancouver police say the driver was on a motorcycle when the crash occurred on the movie set on Monday morning. The Canadian Press via AP Darryl Dyck\n', 'Label_3': 'false', 'Premise_4': 'Copyright 2017 WTVM. All rights reserved. | For more news, download the WTVM app here.\n', 'Hypothesis_4': 'This is the second journalist to die within 48 hours, after the sad passing on of Daily News entertainment reporter Sharon Muguwu yesterday. Muguwu according to family members will be buried in Njanja on Monday.\n', 'Label_4': 'false', 'Premise_5': 'The OSC says it plans to nail down its specific proposals for funds by the end of the year, and have a paper out for public comment for industry players by the end of the first quarter of next year. New disclosure rules may take effect as early as the end of 2018.\n', 'Hypothesis_5': 'FORMER Mashonaland West governor Peter Chanetsa has died. The former Hurungwe North MP died at the Parirenyatwa Hospital Monday morning. He was admitted there on December 23 for an as yet undisclosed illness. Details are still sketchy.\n', 'Label_5': 'true', 'Premise_6': 'the disappearance of york university chef claudia lawrence is now being treated as suspected murder, north yorkshire police said. however detectives said they had not found any proof that the 35-year-old, who went missing on 18 march, was dead. her father peter lawrence made a direct appeal to his daughter to contact him five weeks after she disappeared. his plea came at a news conference held shortly after a £10,000 reward was offered to help find miss lawrence. crimestoppers said the sum they were offering was "significantly higher" than usual because of public interest in the case.', 'Hypothesis_6': 'claudia lawrence is 35 years old.', 'Label_6': 'true', 'Premise_7': 'PITTSBURGH (AP) – Evgeni Malkin scored and picked up an assist in his return from a lower-body injury, Sidney Crosby got his 999th career point with an assist and the Pittsburgh Penguins rolled by the Vancouver Canucks 4-0 on Tuesday night.\n', 'Hypothesis_7': "In an interview on sidelines of the programme in Harare North Constituency, Zanu-PF Harare Province Women's League Chairperson, Ratidzo Mukarati said widows and elderly woman should be looked after as they face many challenges.\n", 'Label_7': 'true', 'Premise_8': "anita page, an mgm actress who appeared in films with lon chaney, joan crawford and buster keaton during the transition from silent movies to talkies, has died at the age of 98. page died in her sleep early saturday morning at her home in los angeles, said actor randal malone, her longtime friend. page was born anita pomeres on august 4, 1910 in flushing, new york. she was the leading lady to lon chaney, buster keaton, robert montgomery, and clark gable (among others), and during the early 1930s was one of hollywood's busiest actresses, as well as being romantically involved with gable. at the height of her popularity, she was receiving more fan mail than any other female star, with the exception of greta garbo, and received multiple marriage proposals from italian prime minister benito mussolini in the mail.", 'Hypothesis_8': 'clark gable dated anita page.', 'Label_8': 'true', 'Premise_9': 'UF President Kent Fuchs called this year’s incoming class “among the most competitive ever.” The average grade point average of those admitted is 4.4 and the average score on the SAT exam was 1349.\n', 'Hypothesis_9': 'Jesse Asher Pitts, age 36, of Columbia, Tenn., passed away June 10, 2017.\n', 'Label_9': 'false', 'Premise_10': 'a 55-year-old orangutan named nonja, who was believed to be the oldest living orangutan in the world both in captivity and the wild, has died at the miami metrozoo in miami, florida. "everybody\'s very sad, especially with an animal like an orangutan. you see a lot of yourself in these animals. the great apes are our closest relatives. she was really a grand old dame," said zoo spokesman ron magill.', 'Hypothesis_10': 'a 45-year-old orangutan died in florida.', 'Label_10': 'false', 'Premise_11': "the internet group anonymous today held protests critical of the church of scientology. the protests marked what would have been the 49th birthday of lisa mcpherson, who is claimed to be a victim of the church of scientology's practices. lisa died in 1995 during a running of what scientologists refer to as an introspection rundown, a procedure intended to help church members deal with a psychotic or deeply traumatic event.", 'Hypothesis_11': 'the church of scientology murdered lisa mcpherson.', 'Label_11': 'false', 'Premise_12': 'the anti-terrorist court found two men guilty of murdering shapour bakhtiar and his secretary sorush katibeh, who were found with their throats cut in august 1991.', 'Hypothesis_12': 'shapour bakhtiar died in 1991.', 'Label_12': 'true', 'Premise_13': 'That is the view of Sky Sports pundit Ryan Mason.\n', 'Hypothesis_13': "Scott cited the 12 deaths after Hurricane Irma at the Rehabilitation Center of Hollywood Hills. The patients died after the storm damaged the electric transformer that powered the facility's air conditioning.\n", 'Label_13': 'true', 'Premise_14': 'WhatsApp\n', 'Hypothesis_14': 'There are more than 3.1 million survivors of breast cancer in the U.S today, including those who are being treated and who have completed treatment.\n', 'Label_14': 'true', 'Premise_15': 'pop star madonna has suffered "minor injuries" and bruises after falling from a startled horse on new york\'s long island on saturday. according to her spokeswoman, the 50-year-old singer fell when her horse was "startled by paparazzi who jumped out of the bushes" to photograph her. madonna was treated at a hospital in southampton and was later released. a previous horse-riding accident in 2005 left her with three cracked ribs, a broken collarbone and a broken hand. she got back on a horse a couple of months later for an appearance on david letterman\'s us talk show.', 'Hypothesis_15': 'madonna is 50 years old.', 'Label_15': 'true'}
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'diana, princess of wales died on sunday, 31 august 1997 following a car crash in paris. there was widespread public mourning at the death of this popular figure, culminating with her funeral at westminster abbey on saturday, 6 september 1997.', 'Hypothesis_0': 'lady diana died in paris.', 'Label_0': 'true', 'Premise_1': "roddenberry was probably most known for her role as the voice of the computers in nearly every star trek television spinoff series from the 1960's to present time. she is also the voice of the computer in the upcoming movie by director j.j. abrams, star trek. majel also played nurse chapel in the original star trek series starring william shatner and later played lwaxana troi in star trek: the next generation and star trek: deep space nine.", 'Hypothesis_1': 'majel roddenberry died of cancer.', 'Label_1': 'false', 'Premise_2': 'Dec 12 (Reuters) - Beiqi Foton Motor Co Ltd :\n', 'Hypothesis_2': '"North West Ambulance Service attended the incident and sadly the man, a 46-year-old from the Wigan area, was pronounced dead at the scene. His next of kin have been informed.\n', 'Label_2': 'false', 'Premise_3': 'According to the report, Japan is a key country in the global low-voltage ceramic capacitor market, accounting for more than 10% of the market share. Major vendors such as Murata Manufacturing, TDK EPCOS, Kyocera, TAIYO YUDEN, and Nichicon generate a high percentage of their revenue in Japan. Demand from the consumer electronics and automotive sectors significantly contributes to the Japanese market.\n', 'Hypothesis_3': 'A police officer examines a motorcycle after a female stunt driver working on the movie "Deadpool 2" died after a crash on set, in Vancouver, B.C., on Monday Aug. 14, 2017. Vancouver police say the driver was on a motorcycle when the crash occurred on the movie set on Monday morning. The Canadian Press via AP Darryl Dyck\n', 'Label_3': 'false', 'Premise_4': 'Copyright 2017 WTVM. All rights reserved. | For more news, download the WTVM app here.\n', 'Hypothesis_4': 'This is the second journalist to die within 48 hours, after the sad passing on of Daily News entertainment reporter Sharon Muguwu yesterday. Muguwu according to family members will be buried in Njanja on Monday.\n', 'Label_4': 'false', 'Premise_5': 'The OSC says it plans to nail down its specific proposals for funds by the end of the year, and have a paper out for public comment for industry players by the end of the first quarter of next year. New disclosure rules may take effect as early as the end of 2018.\n', 'Hypothesis_5': 'FORMER Mashonaland West governor Peter Chanetsa has died. The former Hurungwe North MP died at the Parirenyatwa Hospital Monday morning. He was admitted there on December 23 for an as yet undisclosed illness. Details are still sketchy.\n', 'Label_5': 'true', 'Premise_6': 'the disappearance of york university chef claudia lawrence is now being treated as suspected murder, north yorkshire police said. however detectives said they had not found any proof that the 35-year-old, who went missing on 18 march, was dead. her father peter lawrence made a direct appeal to his daughter to contact him five weeks after she disappeared. his plea came at a news conference held shortly after a £10,000 reward was offered to help find miss lawrence. crimestoppers said the sum they were offering was "significantly higher" than usual because of public interest in the case.', 'Hypothesis_6': 'claudia lawrence is 35 years old.', 'Label_6': 'true', 'Premise_7': 'PITTSBURGH (AP) – Evgeni Malkin scored and picked up an assist in his return from a lower-body injury, Sidney Crosby got his 999th career point with an assist and the Pittsburgh Penguins rolled by the Vancouver Canucks 4-0 on Tuesday night.\n', 'Hypothesis_7': "In an interview on sidelines of the programme in Harare North Constituency, Zanu-PF Harare Province Women's League Chairperson, Ratidzo Mukarati said widows and elderly woman should be looked after as they face many challenges.\n", 'Label_7': 'true', 'Premise_8': "anita page, an mgm actress who appeared in films with lon chaney, joan crawford and buster keaton during the transition from silent movies to talkies, has died at the age of 98. page died in her sleep early saturday morning at her home in los angeles, said actor randal malone, her longtime friend. page was born anita pomeres on august 4, 1910 in flushing, new york. she was the leading lady to lon chaney, buster keaton, robert montgomery, and clark gable (among others), and during the early 1930s was one of hollywood's busiest actresses, as well as being romantically involved with gable. at the height of her popularity, she was receiving more fan mail than any other female star, with the exception of greta garbo, and received multiple marriage proposals from italian prime minister benito mussolini in the mail.", 'Hypothesis_8': 'clark gable dated anita page.', 'Label_8': 'true', 'Premise_9': 'UF President Kent Fuchs called this year’s incoming class “among the most competitive ever.” The average grade point average of those admitted is 4.4 and the average score on the SAT exam was 1349.\n', 'Hypothesis_9': 'Jesse Asher Pitts, age 36, of Columbia, Tenn., passed away June 10, 2017.\n', 'Label_9': 'false', 'Premise_10': 'a 55-year-old orangutan named nonja, who was believed to be the oldest living orangutan in the world both in captivity and the wild, has died at the miami metrozoo in miami, florida. "everybody\'s very sad, especially with an animal like an orangutan. you see a lot of yourself in these animals. the great apes are our closest relatives. she was really a grand old dame," said zoo spokesman ron magill.', 'Hypothesis_10': 'a 45-year-old orangutan died in florida.', 'Label_10': 'false', 'Premise_11': "the internet group anonymous today held protests critical of the church of scientology. the protests marked what would have been the 49th birthday of lisa mcpherson, who is claimed to be a victim of the church of scientology's practices. lisa died in 1995 during a running of what scientologists refer to as an introspection rundown, a procedure intended to help church members deal with a psychotic or deeply traumatic event.", 'Hypothesis_11': 'the church of scientology murdered lisa mcpherson.', 'Label_11': 'false', 'Premise_12': 'the anti-terrorist court found two men guilty of murdering shapour bakhtiar and his secretary sorush katibeh, who were found with their throats cut in august 1991.', 'Hypothesis_12': 'shapour bakhtiar died in 1991.', 'Label_12': 'true', 'Premise_13': 'That is the view of Sky Sports pundit Ryan Mason.\n', 'Hypothesis_13': "Scott cited the 12 deaths after Hurricane Irma at the Rehabilitation Center of Hollywood Hills. The patients died after the storm damaged the electric transformer that powered the facility's air conditioning.\n", 'Label_13': 'true', 'Premise_14': 'WhatsApp\n', 'Hypothesis_14': 'There are more than 3.1 million survivors of breast cancer in the U.S today, including those who are being treated and who have completed treatment.\n', 'Label_14': 'true', 'Premise_15': 'pop star madonna has suffered "minor injuries" and bruises after falling from a startled horse on new york\'s long island on saturday. according to her spokeswoman, the 50-year-old singer fell when her horse was "startled by paparazzi who jumped out of the bushes" to photograph her. madonna was treated at a hospital in southampton and was later released. a previous horse-riding accident in 2005 left her with three cracked ribs, a broken collarbone and a broken hand. she got back on a horse a couple of months later for an appearance on david letterman\'s us talk show.', 'Hypothesis_15': 'madonna is 50 years old.', 'Label_15': 'true'}
['{}\n The question is: {}. True or False?\nThe Answer is: {}']
{0: ['true'], 1: ['false']}
./checkpoints/rte/google/gemma-7b/irrelevant_sample/retrieval_icl-seed-1-shot-8_sbert/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7fd88debbaf0>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 0      |
| Number of failed attacks:     | 202    |
| Number of skipped attacks:    | 75     |
| Original accuracy:            | 72.92  |
| Accuracy under attack:        | 72.92  |
| Attack success rate:          | 0.0    |
| Average perturbed word %:     | nan    |
| Average num. words per input: | 852.57 |
| Avg num queries:              | 1.0    |
| Adv confidence:               | nan    |
+-------------------------------+--------+
Attack time: 874.7306275367737
Attack time: 874.7306275367737
