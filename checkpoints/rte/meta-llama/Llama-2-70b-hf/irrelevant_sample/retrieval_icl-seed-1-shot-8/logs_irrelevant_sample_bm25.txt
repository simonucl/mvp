2
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=1, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=True, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-70b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-70b-hf/irrelevant_sample/retrieval_icl-seed-1-shot-8_bm25', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='int4', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='bm25', sampled_num=1, save_icl_examples_path=None, seed=1, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
meta-llama/Llama-2-70b-hf
Model Directory: ./checkpoints/rte/meta-llama/Llama-2-70b-hf/irrelevant_sample/retrieval_icl-seed-1-shot-8_bm25
2 Physical GPUs, 2 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=1, beta=1.0, cache_dir='./checkpoints/rte/meta-llama/Llama-2-70b-hf/irrelevant_sample/retrieval_icl-seed-1-shot-8_bm25/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=True, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-70b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-70b-hf/irrelevant_sample/retrieval_icl-seed-1-shot-8_bm25', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='int4', prompt_num=2, query_budget=-1, ralm_save_path='./data/ralm/rte_bm25_ood.pkl', replace_ratio=0.1, retrieve_method='bm25', sampled_num=1, save_icl_examples_path=None, seed=1, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
Finished loading ood dataset
{'label': 0, 'idx': 1876, 'premise': "the commission's order on the proposed hydroelectric development shall describe the energy facility siting council's recommendations on the need for the power.", 'hypothesis': 'a hydroelectric project is proposed or is under construction.'}
Finished replacing ood dataset
{'label': 0, 'idx': 1876, 'premise': "the commission's order on the proposed hydroelectric development shall describe the energy facility siting council's recommendations on the need for the power.", 'hypothesis': 'a hydroelectric project is proposed or is under construction.'}
Length of anchor subsample 16
Length of icl examples 2
Finished loading model
Loading retrieved examples from ./data/ralm/rte_bm25_ood.pkl
ICL examples
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'According to the item listing, the features of the Nokia 3310 include a clock, calculator, the ability to store 10 reminders, and four preinstalled games.\n', 'Hypothesis_0': 'Osborne Clarke Lures Partner From Squire Patton Boggs\n', 'Label_0': 'false', 'Premise_1': 'Paul Dunne has hit a round of 68 to remain well in contention at the half-way stage of the Alfred Dunhill Links Championship.\n', 'Hypothesis_1': 'They say his blood alcohol level with nearly twice the legal limit. He’s charged with aggravated assault with a deadly weapon and DUI.\n', 'Label_1': 'false', 'Premise_2': 'The Houston Police Department said thieves stole an ATM machine from the Harris County Courthouse Annex Sunday morning.Police responded to a call for assistance at the courthouse located at 1001 Sgt. Macario Garcia Drive around 3:00 a.m.According to reports, a witness reported seeing a truck dragging a large object along the road.Police say the thieves smashed the front door of the courthouse annex and took the ATM machine from the front entrance area.There were no security or staff at the building during the time.Investigators are working to find surveillance video from the scene.\n', 'Hypothesis_2': "Dishes at Big Ed's also get washed twice.\n", 'Label_2': 'true', 'Premise_3': 'This is a developing story. We’ll update it as more information becomes available. Follow FOX 17’s Dana Chicklas on Twitter for the latest from the scene.\n', 'Hypothesis_3': 'Some passengers have been evacuated as a precaution.\n', 'Label_3': 'false', 'Premise_4': 'Dwayne Johnson is a professional wrestler turned actor, and recently world record breaker. Looks like he has a follower in his footsteps, well at least in the breaking records part. American strongman and wrestler John Ferraro has a skull nearly three times thicker than the average person! He has even proved it by setting the record for nailing 38 nails in wood breaking the world record. Well i guess it true, wrestling sometimes effects your head. Check out the video of him breaking the record below.\n', 'Hypothesis_4': "The U.S. Women's Open at Shoal Creek starts May 31.\n", 'Label_4': 'true', 'Premise_5': "Ann Arbor Mayor Christopher Taylor was among those in attendance and spoke about it to 89.1 WEMU's Lisa Barry.\n", 'Hypothesis_5': 'The detour route will take drivers through SH69 to Reefton, SH7 through to SH65, part of the new Picton to Christchurch Alternate Route, and add up to two hours to the journey for anyone wanting to get to Murchison from Westport.\n', 'Label_5': 'false', 'Premise_6': 'Morgan Freeman’s attorney is demanding CNN retract its story accusing the actor of sexual harassment, calling it the fruit of a “year-long witch hunt” against the 80-year-old that has caused damage to his reputation and career.\n', 'Hypothesis_6': 'MEMPHIS, Tenn. — Traffic is down to two lanes on I-55 after an 18-wheeler was reportedly involved in an accident.\n', 'Label_6': 'false', 'Premise_7': 'Officers confirmed Wednesday that one of the four victims died of their injuries in hospital.\n', 'Hypothesis_7': 'SCE&G and Santee Cooper abandoned the effort July 31 after spending more than $9 billion.\n', 'Label_7': 'true', 'Premise_8': 'Security was tight at the event. The Tahlequah area, in particular, has been very critical of the Congressman and some of his positions. He has said in the past that he would serve only three terms, but has announced plans to seek a fourth term in Washington.\n', 'Hypothesis_8': 'Saturday, Sep 2, 2017\n', 'Label_8': 'true', 'Premise_9': 'The cause of the fire has not been determined and the investigation is ongoing.\n', 'Hypothesis_9': 'Subscribe to WrestleZone Radio on iTunes\n', 'Label_9': 'false', 'Premise_10': 'The quake shook the Thousand Palms area — about 14 miles northeast of Palm Springs — around 12:20 p.m., according to the US Geological Survey.\n', 'Hypothesis_10': 'Start the conversation, or Read more at Times Observer.\n', 'Label_10': 'true', 'Premise_11': "Baku. 10 May. REPORT.AZ/ Australian's oldest scientist David Gudell dies after flying to Switzerland to end his life at the age of 104.\n", 'Hypothesis_11': 'RELATED STORIES\n', 'Label_11': 'true', 'Premise_12': 'Two suspects approached the victims and stole their property at gunpoint, according to the sheriff’s office.\n', 'Hypothesis_12': 'Twitter\n', 'Label_12': 'false', 'Premise_13': 'The growth of the business has encouraged the entrepreneur to see beyond Senegal. The founder of the start-up plans to conquer Côte d’Ivoire.\n', 'Hypothesis_13': 'On Monday, the regulator said it will investigate and deal with illegal activities in the insurance market.\n', 'Label_13': 'true', 'Premise_14': 'The event, sponsored by the Western Wall foundation and the Claims Conference, will be attended by hundreds of holocaust survivors and their families as well as representatives of assistance organizations for survivors and other visitors.\n', 'Hypothesis_14': "White House Launches Effort To Take Citizenship From Those Who Lied To Get It White House Launches Effort To Take Citizenship From Those Who Lied To Get It White House Launches Effort To Take Citizenship From Those Who Lied To Get It Audio will be available later today. When an immigrant becomes a naturalized U.S. citizen, there's a sense of permanence. But a Trump administration effort is seeking those who cheated to get citizenship, and plans to take it from them. NPR thanks our sponsors Become an NPR sponsor\n", 'Label_14': 'false', 'Premise_15': 'Agee says the woman was extracted from the building with serious injuries and flown to a hospital.\n', 'Hypothesis_15': 'MILWAUKEE — The Milwaukee Police Department has some new community service officers and police aides.\n', 'Label_15': 'true'}
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'According to the item listing, the features of the Nokia 3310 include a clock, calculator, the ability to store 10 reminders, and four preinstalled games.\n', 'Hypothesis_0': 'Osborne Clarke Lures Partner From Squire Patton Boggs\n', 'Label_0': 'false', 'Premise_1': 'Paul Dunne has hit a round of 68 to remain well in contention at the half-way stage of the Alfred Dunhill Links Championship.\n', 'Hypothesis_1': 'They say his blood alcohol level with nearly twice the legal limit. He’s charged with aggravated assault with a deadly weapon and DUI.\n', 'Label_1': 'false', 'Premise_2': 'The Houston Police Department said thieves stole an ATM machine from the Harris County Courthouse Annex Sunday morning.Police responded to a call for assistance at the courthouse located at 1001 Sgt. Macario Garcia Drive around 3:00 a.m.According to reports, a witness reported seeing a truck dragging a large object along the road.Police say the thieves smashed the front door of the courthouse annex and took the ATM machine from the front entrance area.There were no security or staff at the building during the time.Investigators are working to find surveillance video from the scene.\n', 'Hypothesis_2': "Dishes at Big Ed's also get washed twice.\n", 'Label_2': 'true', 'Premise_3': 'This is a developing story. We’ll update it as more information becomes available. Follow FOX 17’s Dana Chicklas on Twitter for the latest from the scene.\n', 'Hypothesis_3': 'Some passengers have been evacuated as a precaution.\n', 'Label_3': 'false', 'Premise_4': 'Dwayne Johnson is a professional wrestler turned actor, and recently world record breaker. Looks like he has a follower in his footsteps, well at least in the breaking records part. American strongman and wrestler John Ferraro has a skull nearly three times thicker than the average person! He has even proved it by setting the record for nailing 38 nails in wood breaking the world record. Well i guess it true, wrestling sometimes effects your head. Check out the video of him breaking the record below.\n', 'Hypothesis_4': "The U.S. Women's Open at Shoal Creek starts May 31.\n", 'Label_4': 'true', 'Premise_5': "Ann Arbor Mayor Christopher Taylor was among those in attendance and spoke about it to 89.1 WEMU's Lisa Barry.\n", 'Hypothesis_5': 'The detour route will take drivers through SH69 to Reefton, SH7 through to SH65, part of the new Picton to Christchurch Alternate Route, and add up to two hours to the journey for anyone wanting to get to Murchison from Westport.\n', 'Label_5': 'false', 'Premise_6': 'Morgan Freeman’s attorney is demanding CNN retract its story accusing the actor of sexual harassment, calling it the fruit of a “year-long witch hunt” against the 80-year-old that has caused damage to his reputation and career.\n', 'Hypothesis_6': 'MEMPHIS, Tenn. — Traffic is down to two lanes on I-55 after an 18-wheeler was reportedly involved in an accident.\n', 'Label_6': 'false', 'Premise_7': 'Officers confirmed Wednesday that one of the four victims died of their injuries in hospital.\n', 'Hypothesis_7': 'SCE&G and Santee Cooper abandoned the effort July 31 after spending more than $9 billion.\n', 'Label_7': 'true', 'Premise_8': 'Security was tight at the event. The Tahlequah area, in particular, has been very critical of the Congressman and some of his positions. He has said in the past that he would serve only three terms, but has announced plans to seek a fourth term in Washington.\n', 'Hypothesis_8': 'Saturday, Sep 2, 2017\n', 'Label_8': 'true', 'Premise_9': 'The cause of the fire has not been determined and the investigation is ongoing.\n', 'Hypothesis_9': 'Subscribe to WrestleZone Radio on iTunes\n', 'Label_9': 'false', 'Premise_10': 'The quake shook the Thousand Palms area — about 14 miles northeast of Palm Springs — around 12:20 p.m., according to the US Geological Survey.\n', 'Hypothesis_10': 'Start the conversation, or Read more at Times Observer.\n', 'Label_10': 'true', 'Premise_11': "Baku. 10 May. REPORT.AZ/ Australian's oldest scientist David Gudell dies after flying to Switzerland to end his life at the age of 104.\n", 'Hypothesis_11': 'RELATED STORIES\n', 'Label_11': 'true', 'Premise_12': 'Two suspects approached the victims and stole their property at gunpoint, according to the sheriff’s office.\n', 'Hypothesis_12': 'Twitter\n', 'Label_12': 'false', 'Premise_13': 'The growth of the business has encouraged the entrepreneur to see beyond Senegal. The founder of the start-up plans to conquer Côte d’Ivoire.\n', 'Hypothesis_13': 'On Monday, the regulator said it will investigate and deal with illegal activities in the insurance market.\n', 'Label_13': 'true', 'Premise_14': 'The event, sponsored by the Western Wall foundation and the Claims Conference, will be attended by hundreds of holocaust survivors and their families as well as representatives of assistance organizations for survivors and other visitors.\n', 'Hypothesis_14': "White House Launches Effort To Take Citizenship From Those Who Lied To Get It White House Launches Effort To Take Citizenship From Those Who Lied To Get It White House Launches Effort To Take Citizenship From Those Who Lied To Get It Audio will be available later today. When an immigrant becomes a naturalized U.S. citizen, there's a sense of permanence. But a Trump administration effort is seeking those who cheated to get citizenship, and plans to take it from them. NPR thanks our sponsors Become an NPR sponsor\n", 'Label_14': 'false', 'Premise_15': 'Agee says the woman was extracted from the building with serious injuries and flown to a hospital.\n', 'Hypothesis_15': 'MILWAUKEE — The Milwaukee Police Department has some new community service officers and police aides.\n', 'Label_15': 'true'}
['{}\n The question is: {}. True or False?\nThe Answer is: {}']
{0: ['true'], 1: ['false']}
./checkpoints/rte/meta-llama/Llama-2-70b-hf/irrelevant_sample/retrieval_icl-seed-1-shot-8_bm25/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7f61d35285e0>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 

