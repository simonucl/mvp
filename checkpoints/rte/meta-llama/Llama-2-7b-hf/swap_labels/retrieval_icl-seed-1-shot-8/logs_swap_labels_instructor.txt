1
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=1, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8_instructor', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=250, replace_ratio=0.1, retrieve_method='instructor', sampled_num=1, seed=1, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/rte/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8_instructor
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=1, beta=1.0, cache_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8_instructor/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8_instructor', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=250, ralm_save_path='./data/ralm/rte_instructor.pkl', replace_ratio=0.1, retrieve_method='instructor', sampled_num=1, seed=1, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
load INSTRUCTOR_Transformer
max_seq_length  512
Length of anchor subsample 16
Length of icl examples 2
Finished loading model
Finished encoding anchor data
anchor_data_embeddings shape: torch.Size([2365, 768])
query shape: 277
query_embedding shape: torch.Size([277, 768])
cos_scores shape: torch.Size([277, 2365])
Saving retrieved examples to ./data/ralm/rte_instructor.pkl
ICL examples
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'actor christopher reeve, best known for his role as superman, is paralyzed and cannot breathe without the help of a respirator after breaking his neck in a riding accident in culpeper, va., on saturday.', 'Hypothesis_0': 'christopher reeve had an accident.', 'Label_0': 'true', 'Premise_1': 'christopher reeve, an actor and director who became an inspiration worldwide after being paralyzed in a horse riding accident, died sunday of heart failure.', 'Hypothesis_1': 'christopher reeve had an accident.', 'Label_1': 'true', 'Premise_2': 'hepburn, a four-time academy award winner, died last june in connecticut at age 96.', 'Hypothesis_2': 'hepburn, who won four oscars, died last june aged 96.', 'Label_2': 'true', 'Premise_3': "roddenberry was probably most known for her role as the voice of the computers in nearly every star trek television spinoff series from the 1960's to present time. she is also the voice of the computer in the upcoming movie by director j.j. abrams, star trek. majel also played nurse chapel in the original star trek series starring william shatner and later played lwaxana troi in star trek: the next generation and star trek: deep space nine.", 'Hypothesis_3': 'majel roddenberry died of cancer.', 'Label_3': 'false', 'Premise_4': "reagan announced he had alzheimer's disease, an incurable brain affliction.", 'Hypothesis_4': "reagan died of pneumonia complicated by alzheimer's disease", 'Label_4': 'false', 'Premise_5': "et confirms that actor bruce willis has married his girlfriend of a year, model/actress emma heming.  a small, private wedding ceremony took place on saturday at willis' home in parrot cay, turks & caicos, a rep said.  in attendance were the 54-year-old actor's first wife, demi moore, and her husband ashton kutcher, as well as his daughters rumer, scout, and tallulah belle. the couple plans to hold a civil ceremony when they return to california.", 'Hypothesis_5': "bruce willis' wife is from california.", 'Label_5': 'false', 'Premise_6': 'in a statement to reporters, parker called the spilt with gap a mutual decision, and walks away $38 million richer and recently signed a 2-year deal with former employer hbo to develop future programming for the network. parker is also scheduled to appear in two upcoming comedy films, a movie adaptation of the comedy central series, strangers with candy, as well as the family stone, costarring diane keaton and claire danes.', 'Hypothesis_6': 'claire danes is an actress who played in "stardust".', 'Label_6': 'false', 'Premise_7': 'the disappearance of york university chef claudia lawrence is now being treated as suspected murder, north yorkshire police said. however detectives said they had not found any proof that the 35-year-old, who went missing on 18 march, was dead. her father peter lawrence made a direct appeal to his daughter to contact him five weeks after she disappeared. his plea came at a news conference held shortly after a Â£10,000 reward was offered to help find miss lawrence. crimestoppers said the sum they were offering was "significantly higher" than usual because of public interest in the case.', 'Hypothesis_7': 'claudia lawrence is 35 years old.', 'Label_7': 'true', 'Premise_8': 'a memorial service has taken place for australian actor heath ledger, who died january 22 in new york. hollywood celebrities and many other loyal fans bid farewell to the well known actor. his death has been deemed accidental by the new york city medical examiner and was attributed to a toxic mixture of prescription drugs and pain killers. the star died in his manhattan apartment last month. the service was held at penrhos college in perth, australia and was attended by over 100 people, although the actual funeral was only attended by ledger\'s close family. before the funeral, heath\'s father, kim ledger, said that "the funeral will be very, very private and there will only be 10 people there, immediate family and nobody else."', 'Hypothesis_8': "kim ledger was heath's son.", 'Label_8': 'false', 'Premise_9': 'brad pitt is causing havoc on his school run. the handsome actor has been spotted taking his kids to school in new york, causing local mothers to fight over who drives all their children in the mornings, in the hope of meeting the star. a source said: "moms are fighting over who gets to carpool the kids to school. they are all dressing up and are desperate to meet him." brad, 45, has taken on the duty of driving adopted boys maddox, eight, and pax, five, to class while his partner angelina jolie shoots her latest film \'salt\'. the couple also raise four other children, adopted daughter zahara, four, and their naturally conceived children shiloh, two, and eight-month-old twins vivienne and knox.', 'Hypothesis_9': 'brad pitt is 45 years old.', 'Label_9': 'true', 'Premise_10': 'carl smith collided with a concrete lamp-post while skating and suffered a skull fracture that caused a coma. when he failed to regain consciousness, his parents on august 8 consented to his life support machine being turned off.', 'Hypothesis_10': 'carl smith died on august 8.', 'Label_10': 'true', 'Premise_11': 'twenty-four people, among them seven children, were killed on sunday after their airplane crashed in a river in brazil. four people survived the crash, including a 9-year-old boy. the aircraft, which was a twin-engine embraer turboprop chartered by manaus aerotaxis, was carrying 26 passengers and two crew members when it crashed. the pilots of the plane, which had departed from coari, had supposedly contacted the air traffic control near their destination of manaus to announce  that they were turning back. the plane, however, then disappeared from radar. the plane made an emergency landing in the river manacapuru, a branch the  amazon river in the brazilian state of amazonas, 50 miles (80 kilometers) from manaus.', 'Hypothesis_11': '24 people died in an airplane crash.', 'Label_11': 'true', 'Premise_12': 'billy werber, third baseman in major league baseball, has died at the age of 100. werber died of natural causes on thursday, january 22, 2009 at an assisted living center in charlotte, north carolina. he was moved there after his health deteriorated a month ago. his son said that when admitted, werber refused to eat solid foods and would only drink liquids. "he just refused to eat and that was his plan," bill werber jr. told the associated press. he added that his father was "sharp up until four weeks ago".', 'Hypothesis_12': 'werber died in north carolina at the age of 100.', 'Label_12': 'true', 'Premise_13': 'a small airplane crashed yesterday in southeast alaska, killing five and injuring four. alaska state troopers spokeswoman megan peters said that among the survivors is a two-year-old girl. ketchikan public safety director rich leipfert told the ketchikan daily news that three of the injured were transported to hospitals. leipfert also said that the plane, belonging to seawind aviation, crashed into a tree at traitors cove, an area about 25 miles north of ketchikan.', 'Hypothesis_13': '25 people died in an airplane crash.', 'Label_13': 'false', 'Premise_14': 'brad pitt and angelina jolie are to let getty images sell photos of their new baby shiloh nouvel jolie-pitt - and  have asked the proceeds go to charity. angelina jolie"while we celebrate the joy of the birth of our daughter, we recognize that 2 million babies born  every year in the developing world die on the first day of their lives. these children can be saved, but only if governments around the world make it a priority," the couple said, in a joint statement.', 'Hypothesis_14': 'brad pitt and angelina jolie have a daughter.', 'Label_14': 'true', 'Premise_15': 'a 55-year-old orangutan named nonja, who was believed to be the oldest living orangutan in the world both in captivity and the wild, has died at the miami metrozoo in miami, florida. "everybody\'s very sad, especially with an animal like an orangutan. you see a lot of yourself in these animals. the great apes are our closest relatives. she was really a grand old dame," said zoo spokesman ron magill.', 'Hypothesis_15': 'a 45-year-old orangutan died in florida.', 'Label_15': 'false'}
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'actor christopher reeve, best known for his role as superman, is paralyzed and cannot breathe without the help of a respirator after breaking his neck in a riding accident in culpeper, va., on saturday.', 'Hypothesis_0': 'christopher reeve had an accident.', 'Label_0': 'true', 'Premise_1': 'christopher reeve, an actor and director who became an inspiration worldwide after being paralyzed in a horse riding accident, died sunday of heart failure.', 'Hypothesis_1': 'christopher reeve had an accident.', 'Label_1': 'true', 'Premise_2': 'hepburn, a four-time academy award winner, died last june in connecticut at age 96.', 'Hypothesis_2': 'hepburn, who won four oscars, died last june aged 96.', 'Label_2': 'true', 'Premise_3': "roddenberry was probably most known for her role as the voice of the computers in nearly every star trek television spinoff series from the 1960's to present time. she is also the voice of the computer in the upcoming movie by director j.j. abrams, star trek. majel also played nurse chapel in the original star trek series starring william shatner and later played lwaxana troi in star trek: the next generation and star trek: deep space nine.", 'Hypothesis_3': 'majel roddenberry died of cancer.', 'Label_3': 'false', 'Premise_4': "reagan announced he had alzheimer's disease, an incurable brain affliction.", 'Hypothesis_4': "reagan died of pneumonia complicated by alzheimer's disease", 'Label_4': 'false', 'Premise_5': "et confirms that actor bruce willis has married his girlfriend of a year, model/actress emma heming.  a small, private wedding ceremony took place on saturday at willis' home in parrot cay, turks & caicos, a rep said.  in attendance were the 54-year-old actor's first wife, demi moore, and her husband ashton kutcher, as well as his daughters rumer, scout, and tallulah belle. the couple plans to hold a civil ceremony when they return to california.", 'Hypothesis_5': "bruce willis' wife is from california.", 'Label_5': 'false', 'Premise_6': 'in a statement to reporters, parker called the spilt with gap a mutual decision, and walks away $38 million richer and recently signed a 2-year deal with former employer hbo to develop future programming for the network. parker is also scheduled to appear in two upcoming comedy films, a movie adaptation of the comedy central series, strangers with candy, as well as the family stone, costarring diane keaton and claire danes.', 'Hypothesis_6': 'claire danes is an actress who played in "stardust".', 'Label_6': 'false', 'Premise_7': 'the disappearance of york university chef claudia lawrence is now being treated as suspected murder, north yorkshire police said. however detectives said they had not found any proof that the 35-year-old, who went missing on 18 march, was dead. her father peter lawrence made a direct appeal to his daughter to contact him five weeks after she disappeared. his plea came at a news conference held shortly after a Â£10,000 reward was offered to help find miss lawrence. crimestoppers said the sum they were offering was "significantly higher" than usual because of public interest in the case.', 'Hypothesis_7': 'claudia lawrence is 35 years old.', 'Label_7': 'true', 'Premise_8': 'a memorial service has taken place for australian actor heath ledger, who died january 22 in new york. hollywood celebrities and many other loyal fans bid farewell to the well known actor. his death has been deemed accidental by the new york city medical examiner and was attributed to a toxic mixture of prescription drugs and pain killers. the star died in his manhattan apartment last month. the service was held at penrhos college in perth, australia and was attended by over 100 people, although the actual funeral was only attended by ledger\'s close family. before the funeral, heath\'s father, kim ledger, said that "the funeral will be very, very private and there will only be 10 people there, immediate family and nobody else."', 'Hypothesis_8': "kim ledger was heath's son.", 'Label_8': 'false', 'Premise_9': 'brad pitt is causing havoc on his school run. the handsome actor has been spotted taking his kids to school in new york, causing local mothers to fight over who drives all their children in the mornings, in the hope of meeting the star. a source said: "moms are fighting over who gets to carpool the kids to school. they are all dressing up and are desperate to meet him." brad, 45, has taken on the duty of driving adopted boys maddox, eight, and pax, five, to class while his partner angelina jolie shoots her latest film \'salt\'. the couple also raise four other children, adopted daughter zahara, four, and their naturally conceived children shiloh, two, and eight-month-old twins vivienne and knox.', 'Hypothesis_9': 'brad pitt is 45 years old.', 'Label_9': 'true', 'Premise_10': 'carl smith collided with a concrete lamp-post while skating and suffered a skull fracture that caused a coma. when he failed to regain consciousness, his parents on august 8 consented to his life support machine being turned off.', 'Hypothesis_10': 'carl smith died on august 8.', 'Label_10': 'true', 'Premise_11': 'twenty-four people, among them seven children, were killed on sunday after their airplane crashed in a river in brazil. four people survived the crash, including a 9-year-old boy. the aircraft, which was a twin-engine embraer turboprop chartered by manaus aerotaxis, was carrying 26 passengers and two crew members when it crashed. the pilots of the plane, which had departed from coari, had supposedly contacted the air traffic control near their destination of manaus to announce  that they were turning back. the plane, however, then disappeared from radar. the plane made an emergency landing in the river manacapuru, a branch the  amazon river in the brazilian state of amazonas, 50 miles (80 kilometers) from manaus.', 'Hypothesis_11': '24 people died in an airplane crash.', 'Label_11': 'true', 'Premise_12': 'billy werber, third baseman in major league baseball, has died at the age of 100. werber died of natural causes on thursday, january 22, 2009 at an assisted living center in charlotte, north carolina. he was moved there after his health deteriorated a month ago. his son said that when admitted, werber refused to eat solid foods and would only drink liquids. "he just refused to eat and that was his plan," bill werber jr. told the associated press. he added that his father was "sharp up until four weeks ago".', 'Hypothesis_12': 'werber died in north carolina at the age of 100.', 'Label_12': 'true', 'Premise_13': 'a small airplane crashed yesterday in southeast alaska, killing five and injuring four. alaska state troopers spokeswoman megan peters said that among the survivors is a two-year-old girl. ketchikan public safety director rich leipfert told the ketchikan daily news that three of the injured were transported to hospitals. leipfert also said that the plane, belonging to seawind aviation, crashed into a tree at traitors cove, an area about 25 miles north of ketchikan.', 'Hypothesis_13': '25 people died in an airplane crash.', 'Label_13': 'false', 'Premise_14': 'brad pitt and angelina jolie are to let getty images sell photos of their new baby shiloh nouvel jolie-pitt - and  have asked the proceeds go to charity. angelina jolie"while we celebrate the joy of the birth of our daughter, we recognize that 2 million babies born  every year in the developing world die on the first day of their lives. these children can be saved, but only if governments around the world make it a priority," the couple said, in a joint statement.', 'Hypothesis_14': 'brad pitt and angelina jolie have a daughter.', 'Label_14': 'true', 'Premise_15': 'a 55-year-old orangutan named nonja, who was believed to be the oldest living orangutan in the world both in captivity and the wild, has died at the miami metrozoo in miami, florida. "everybody\'s very sad, especially with an animal like an orangutan. you see a lot of yourself in these animals. the great apes are our closest relatives. she was really a grand old dame," said zoo spokesman ron magill.', 'Hypothesis_15': 'a 45-year-old orangutan died in florida.', 'Label_15': 'false'}
['{}\n The question is: {}. True or False?\nThe Answer is: {}']
{0: ['true'], 1: ['false']}
./checkpoints/rte/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8_instructor/swap_labels_log.csv
<textattack.attacker.Attacker object at 0x7fe45807b0a0>
Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapLabel(
        (label_map):  ['true', 'false']
      )
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): InstructionModification(
        (columns_to_ignore):  ['sentence', 'example_', 'premise', 'hypothesis']
      )
    (2): RepeatModification
  (is_black_box):  True
) 


