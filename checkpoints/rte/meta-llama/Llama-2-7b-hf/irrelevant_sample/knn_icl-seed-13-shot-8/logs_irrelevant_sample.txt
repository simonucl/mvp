1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=4, beta=0.2, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=100.0, knn_k=3, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/irrelevant_sample/knn_icl-seed-13-shot-8', model_id='0', model_type='knn_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=13, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/rte/meta-llama/Llama-2-7b-hf/irrelevant_sample/knn_icl-seed-13-shot-8
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=4, beta=0.2, cache_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/irrelevant_sample/knn_icl-seed-13-shot-8/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=100.0, knn_k=3, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/irrelevant_sample/knn_icl-seed-13-shot-8', model_id='0', model_type='knn_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=13, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
Finished loading ood dataset
{'label': 0, 'idx': 1876, 'premise': "the commission's order on the proposed hydroelectric development shall describe the energy facility siting council's recommendations on the need for the power.", 'hypothesis': 'a hydroelectric project is proposed or is under construction.'}
Finished replacing ood dataset
{'label': 0, 'idx': 1876, 'premise': "the commission's order on the proposed hydroelectric development shall describe the energy facility siting council's recommendations on the need for the power.", 'hypothesis': 'a hydroelectric project is proposed or is under construction.'}
Length of anchor subsample 14
Length of icl examples 2
Loading anchor store
Finished loading anchor store
Finished loading model
ICL examples
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': '...\n', 'Hypothesis_0': 'Next on the list: The ISM Raceway Scoring Tower. ðŸŽ¥ Cue the dramatic music + enjoy! pic.twitter.com/h7mUVn7ROH â€” ISM Raceway (@ISMRaceway) April 23, 2018\n', 'Label_0': 'true', 'Premise_1': 'scientists have made two major discoveries in the search for other earth-like planets. british astronomers say they have discovered the smallest known earth-like exoplanet orbiting a living star called gliese 581 e and also discovered that a nearby planet called gliese 581 d, discovered in 2007, is in the much sought after \'habitable zone\'. astronomers also believe there is a possibility that 581 d could have liquid oceans on its surface, calling the find "extraordinary."  "the holy grail of current exoplanet research is the detection of a rocky, earth-like planet in the \'habitable zone\'," said astrophysicist at switzerland\'s geneva university, michel mayor.  astronomers say 581 e is 20.5 light years away from earth and that it\'s roughly 1.9 times larger than earth, making it the smallest exoplanet discovered to date. it was found using the high accuracy radial velocity planet searcher (harps).', 'Hypothesis_1': 'michel mayor is the discoverer of the high accuracy radial velocity planet searcher.', 'Label_1': 'false'}
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': '...\n', 'Hypothesis_0': 'Next on the list: The ISM Raceway Scoring Tower. ðŸŽ¥ Cue the dramatic music + enjoy! pic.twitter.com/h7mUVn7ROH â€” ISM Raceway (@ISMRaceway) April 23, 2018\n', 'Label_0': 'true', 'Premise_1': 'scientists have made two major discoveries in the search for other earth-like planets. british astronomers say they have discovered the smallest known earth-like exoplanet orbiting a living star called gliese 581 e and also discovered that a nearby planet called gliese 581 d, discovered in 2007, is in the much sought after \'habitable zone\'. astronomers also believe there is a possibility that 581 d could have liquid oceans on its surface, calling the find "extraordinary."  "the holy grail of current exoplanet research is the detection of a rocky, earth-like planet in the \'habitable zone\'," said astrophysicist at switzerland\'s geneva university, michel mayor.  astronomers say 581 e is 20.5 light years away from earth and that it\'s roughly 1.9 times larger than earth, making it the smallest exoplanet discovered to date. it was found using the high accuracy radial velocity planet searcher (harps).', 'Hypothesis_1': 'michel mayor is the discoverer of the high accuracy radial velocity planet searcher.', 'Label_1': 'false'}
['{}\n The question is: {}. True or False?\nThe Answer is: {}']
{0: ['true'], 1: ['false']}
./checkpoints/rte/meta-llama/Llama-2-7b-hf/irrelevant_sample/knn_icl-seed-13-shot-8/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7f19de639160>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 0      |
| Number of failed attacks:     | 182    |
| Number of skipped attacks:    | 95     |
| Original accuracy:            | 65.7   |
| Accuracy under attack:        | 65.7   |
| Attack success rate:          | 0.0    |
| Average perturbed word %:     | nan    |
| Average num. words per input: | 234.02 |
| Avg num queries:              | 1.0    |
| Adv confidence:               | nan    |
+-------------------------------+--------+
Attack time: 55.47678089141846
Attack time: 55.47678089141846
