1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=8, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-2', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=42, shot=2, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/rte/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-2
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=8, beta=1.0, cache_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-2/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-2', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=42, shot=2, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
Finished loading ood dataset
{'label': 0, 'idx': 1876, 'premise': "the commission's order on the proposed hydroelectric development shall describe the energy facility siting council's recommendations on the need for the power.", 'hypothesis': 'a hydroelectric project is proposed or is under construction.'}
Finished replacing ood dataset
{'label': 0, 'idx': 1876, 'premise': 'It wasn’t immediately known whether Lane has an attorney.\n', 'hypothesis': 'The Snowy Owl Theater, a 240-seat energy efficient venue, outside Leavenworth. It was brainchild of two very different people, Harriet Bullitt, environmentalist and progressive from the family that founded King Broadcasting, and Wilfred Woods, longtime publisher of the Wenatchee World, Republican donor, and champion of dams on the Columbia River.\n'}
Length of anchor subsample 0
Length of icl examples 2
Finished loading model
ICL examples
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'Assistant Managing Director of Kogi ADP, Mr Isaac Ejiga, who made the revelation said the confluence rice is a product of sustained commitment of Kogi state government to make the state assume leadership position in food production in the country.\n', 'Hypothesis_0': 'Obasanjo, Wigwe, Terraz unite against HIV/AIDS in Nigeria\n', 'Label_0': 'true', 'Premise_1': "gonzález márquez, felipe is a spanish political leader. after joining what was then the spanish socialist workers' party, gonzález became its secretary-general and revived it from the moribund position into which it had fallen under franco.", 'Hypothesis_1': 'felipe gonzález is the president of spain.', 'Label_1': 'false', 'Premise_2': 'Officials received a call for help at about 8:30 p.m. Tuesday from the captain of a 26-foot (8 meter) pleasure craft. He said his vessel was taking on water.\n', 'Hypothesis_2': "Former CEO Peter Hancock decided to step down after coming under pressure from shareholders and the insurer's board, following poor financial performance.\n", 'Label_2': 'true', 'Premise_3': 'Start the conversation, or Read more at The Gazette.\n', 'Hypothesis_3': 'Dr Driscoll points out that listening to moody music can be enjoyable, while sadness can trigger positive changes in our lives. She suggests that we should embrace the range of emotions to get the most out of our lives.\n', 'Label_3': 'false'}
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'Assistant Managing Director of Kogi ADP, Mr Isaac Ejiga, who made the revelation said the confluence rice is a product of sustained commitment of Kogi state government to make the state assume leadership position in food production in the country.\n', 'Hypothesis_0': 'Obasanjo, Wigwe, Terraz unite against HIV/AIDS in Nigeria\n', 'Label_0': 'true', 'Premise_1': "gonzález márquez, felipe is a spanish political leader. after joining what was then the spanish socialist workers' party, gonzález became its secretary-general and revived it from the moribund position into which it had fallen under franco.", 'Hypothesis_1': 'felipe gonzález is the president of spain.', 'Label_1': 'false', 'Premise_2': 'Officials received a call for help at about 8:30 p.m. Tuesday from the captain of a 26-foot (8 meter) pleasure craft. He said his vessel was taking on water.\n', 'Hypothesis_2': "Former CEO Peter Hancock decided to step down after coming under pressure from shareholders and the insurer's board, following poor financial performance.\n", 'Label_2': 'true', 'Premise_3': 'Start the conversation, or Read more at The Gazette.\n', 'Hypothesis_3': 'Dr Driscoll points out that listening to moody music can be enjoyable, while sadness can trigger positive changes in our lives. She suggests that we should embrace the range of emotions to get the most out of our lives.\n', 'Label_3': 'false'}
['{}\n The question is: {}. True or False?\nThe Answer is: {}']
{0: ['true'], 1: ['false']}
./checkpoints/rte/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-2/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7ff52d486400>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 0      |
| Number of failed attacks:     | 173    |
| Number of skipped attacks:    | 104    |
| Original accuracy:            | 62.45  |
| Accuracy under attack:        | 62.45  |
| Attack success rate:          | 0.0    |
| Average perturbed word %:     | nan    |
| Average num. words per input: | 248.02 |
| Avg num queries:              | 1.0    |
| Adv confidence:               | nan    |
+-------------------------------+--------+
Attack time: 134.31664896011353
Attack time: 134.31664896011353
