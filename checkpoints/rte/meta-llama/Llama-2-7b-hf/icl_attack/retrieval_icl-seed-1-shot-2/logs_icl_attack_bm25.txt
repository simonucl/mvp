1
Namespace(adv_augment=0, alpha=None, attack_name='icl_attack', batch_size=2, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.15, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/icl_attack/retrieval_icl-seed-1-shot-2_bm25', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='bm25', sampled_num=1, seed=1, shot=2, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/rte/meta-llama/Llama-2-7b-hf/icl_attack/retrieval_icl-seed-1-shot-2_bm25
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='icl_attack', batch_size=2, beta=1.0, cache_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/icl_attack/retrieval_icl-seed-1-shot-2_bm25/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.15, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/icl_attack/retrieval_icl-seed-1-shot-2_bm25', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, ralm_save_path='./data/ralm/rte_bm25.pkl', replace_ratio=0.1, retrieve_method='bm25', sampled_num=1, seed=1, shot=2, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
Length of anchor subsample 4
Length of icl examples 2
Finished loading model
Loading retrieved examples from ./data/ralm/rte_bm25.pkl
ICL examples
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'seattle - apple inc., maker of macintosh computers and the iphone, reports fiscal second-quarter earnings wednesday after the closing bell. the following is a summary of key developments related to that period. overview: in january, apple founder steve jobs addressed the matter of his increasingly gaunt appearance — twice. he first said it was caused by an easily treatable hormone imbalance, and that he would remain at the helm. the next week, jobs, a cancer survivor, revealed the problem was more complicated and said he would take a medical leave of absence until the end of june. chief operating officer tim cook is running the company in his absence.', 'Hypothesis_0': 'steve jobs is the creator of apple.', 'Label_0': 'true', 'Premise_1': 'last saturday i was thrilled to read about a school in co antrim which has introduced the study of philosophy for students of four years of age and upwards. according to both teachers and parents, the benefits are felt far beyond the classroom, "not just in terms of increased confidence, motivation and ability, but in a heightened respect for the differing views of others". in 1999, i walked through the gates of trinity college to enrol as an undergraduate in the philosophy department. i had just returned home from years living in another city; i was recently married, unemployed and had been diagnosed with a mental illness i didn\'t quite believe i had. i wasn\'t sure if i could cope.', 'Hypothesis_1': 'trinity college was founded in 1999.', 'Label_1': 'false', 'Premise_2': 'according to the spanish daily, this type of bacterium is prevalent in hospitals throughout the world, but the incidence of infection in madrid hospitals is lower than the spanish average. the head of the neonatal unit at 12 de octubre hospital, carmen pay\'s, explained that the bacterium is very adaptable "and keeps on learning". the father of the dead baby, an ecuadorian named angel marcelo, was quoted as saying that the progress of the baby had at first been "tremendous", and that he had even been taken off the respirator, but that a few days later he began to cough up blood, dying soon afterwards.', 'Hypothesis_2': 'the spanish daily is set in madrid.', 'Label_2': 'false', 'Premise_3': 'as the u.s. military evacuated saigon in the spring of 1975, president gerald ford approved operation babylift, the plan to transport thousands of vietnamese children to adoptive parents in the west, hundreds of them at a time, before the u.s. was forced out of the country.', 'Hypothesis_3': 'the u.s. military evacuated u.s. citizens.', 'Label_3': 'false'}
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'seattle - apple inc., maker of macintosh computers and the iphone, reports fiscal second-quarter earnings wednesday after the closing bell. the following is a summary of key developments related to that period. overview: in january, apple founder steve jobs addressed the matter of his increasingly gaunt appearance — twice. he first said it was caused by an easily treatable hormone imbalance, and that he would remain at the helm. the next week, jobs, a cancer survivor, revealed the problem was more complicated and said he would take a medical leave of absence until the end of june. chief operating officer tim cook is running the company in his absence.', 'Hypothesis_0': 'steve jobs is the creator of apple.', 'Label_0': 'true', 'Premise_1': 'last saturday i was thrilled to read about a school in co antrim which has introduced the study of philosophy for students of four years of age and upwards. according to both teachers and parents, the benefits are felt far beyond the classroom, "not just in terms of increased confidence, motivation and ability, but in a heightened respect for the differing views of others". in 1999, i walked through the gates of trinity college to enrol as an undergraduate in the philosophy department. i had just returned home from years living in another city; i was recently married, unemployed and had been diagnosed with a mental illness i didn\'t quite believe i had. i wasn\'t sure if i could cope.', 'Hypothesis_1': 'trinity college was founded in 1999.', 'Label_1': 'false', 'Premise_2': 'according to the spanish daily, this type of bacterium is prevalent in hospitals throughout the world, but the incidence of infection in madrid hospitals is lower than the spanish average. the head of the neonatal unit at 12 de octubre hospital, carmen pay\'s, explained that the bacterium is very adaptable "and keeps on learning". the father of the dead baby, an ecuadorian named angel marcelo, was quoted as saying that the progress of the baby had at first been "tremendous", and that he had even been taken off the respirator, but that a few days later he began to cough up blood, dying soon afterwards.', 'Hypothesis_2': 'the spanish daily is set in madrid.', 'Label_2': 'false', 'Premise_3': 'as the u.s. military evacuated saigon in the spring of 1975, president gerald ford approved operation babylift, the plan to transport thousands of vietnamese children to adoptive parents in the west, hundreds of them at a time, before the u.s. was forced out of the country.', 'Hypothesis_3': 'the u.s. military evacuated u.s. citizens.', 'Label_3': 'false'}
['{}\n The question is: {}. True or False?\nThe Answer is: {}']
{0: ['true'], 1: ['false']}
./checkpoints/rte/meta-llama/Llama-2-7b-hf/icl_attack/retrieval_icl-seed-1-shot-2_bm25/icl_attack_log.csv
<textattack.attacker.Attacker object at 0x7ef96cb73730>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (2): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (3): WordSwapHomoglyphSwap
    (4): WordSwapEmbedding(
        (max_candidates):  5
        (embedding):  WordEmbedding
      )
    )
  (constraints): 
    (0): IclUniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.8
        (window_size):  inf
        (skip_text_shorter_than_window):  False
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
    (3): InstructionModification(
        (columns_to_ignore):  ['sentence', 'label_', 'premise', 'hypothesis']
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 35     |
| Number of failed attacks:     | 156    |
| Number of skipped attacks:    | 86     |
| Original accuracy:            | 68.95  |
| Accuracy under attack:        | 56.32  |
| Attack success rate:          | 18.32  |
| Average perturbed word %:     | 0.55   |
| Average num. words per input: | 404.73 |
| Avg num queries:              | 197.96 |
| Adv confidence:               | 0.52   |
| Average Original Perplexity:  | 31.37  |
| Average Attack Perplexity:    | 33.27  |
| Average Attack USE Score:     | 0.99   |
+-------------------------------+--------+
Attack time: 2813.616785764694
Attack time: 2813.616785764694
