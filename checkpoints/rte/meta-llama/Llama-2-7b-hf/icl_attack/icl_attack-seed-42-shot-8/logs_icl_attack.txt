1
Namespace(adv_augment=0, alpha=None, attack_name='icl_attack', batch_size=2, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.15, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/icl_attack/icl_attack-seed-42-shot-8', model_id='0', model_type='icl_attack', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=42, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/rte/meta-llama/Llama-2-7b-hf/icl_attack/icl_attack-seed-42-shot-8
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='icl_attack', batch_size=2, beta=1.0, cache_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/icl_attack/icl_attack-seed-42-shot-8/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='rte', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.15, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/rte/meta-llama/Llama-2-7b-hf/icl_attack/icl_attack-seed-42-shot-8', model_id='0', model_type='icl_attack', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=42, shot=8, split='test', template_file='configs/templates_rte.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_rte.yaml', weight_decay=0.01)
Length of anchor subsample 0
Length of icl examples 2
Finished loading model
ICL examples
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'initially the bundesbank opposed the introduction of the euro but was compelled to accept it in light of the political pressure of the capitalist politicians who supported its introduction.', 'Hypothesis_0': 'the introduction of the euro has been opposed.', 'Label_0': 'true', 'Premise_1': "gonzález márquez, felipe is a spanish political leader. after joining what was then the spanish socialist workers' party, gonzález became its secretary-general and revived it from the moribund position into which it had fallen under franco.", 'Hypothesis_1': 'felipe gonzález is the president of spain.', 'Label_1': 'false', 'Premise_2': 'the pills were sold under store brands by wal-mart, cvs, safeway and more than 120 other major retailers, the food and drug administration said.', 'Hypothesis_2': 'the pills were commercialized by major retailers.', 'Label_2': 'true', 'Premise_3': 'the total estimated project cost including financing, inflation and interest during construction, is approximately us$1.1 billion.', 'Hypothesis_3': 'a hydroelectric project is proposed or is under construction.', 'Label_3': 'false', 'Premise_4': "ibm is now at the top of my list of where i want to work. ivy alone had nine interviews when the team visited the company's headquarters in armonk last week.", 'Hypothesis_4': "ibm's has its headquarters in armonk.", 'Label_4': 'true', 'Premise_5': "floods are one of europe's most widespread disasters. major flooding has occurred nearly every year somewhere on our continent during the last few decades.", 'Hypothesis_5': 'flooding in europe causes major economic losses.', 'Label_5': 'false', 'Premise_6': "radical jordanian cleric, abu qatada, and nine other foreign nationals said to pose a threat to the uk's security, have been detained, pending deportation.", 'Hypothesis_6': "10 foreign nationals were a threat to britian's national security.", 'Label_6': 'true', 'Premise_7': 'the deal marks the second foray into lithuania by philip morris which in april beat british american tobacco to acquire the klaipeda tobacco company for dollars 40m - the biggest western investment in the baltic states so far.', 'Hypothesis_7': 'the acquisition of the klaipeda tobacco company is the biggest investment in the baltic states.', 'Label_7': 'false', 'Premise_8': "in jerusalem, the faithful celebrated mass at the church of the holy sepulcher, traditionally believed to mark the site where jesus was crucified, buried and then resurrected. brown-robed friars marched into the church to the sound of bagpipes, followed by clergymen in purple capes and others bearing crosses. and in the earthquake-ravaged central italian city of l'aquila, survivors gathered in makeshift chapels set up in tent cities that are housing some of the 55,000 people driven from their homes by monday's 6.3-magnitude temblor.", 'Hypothesis_8': 'a 6.3-magnitude earthquake struck the center of italy.', 'Label_8': 'true', 'Premise_9': "a four-day state of emergency has been declared in the capital of mongolia, ulaanbaatar after violent protests occurred after allegations of vote rigging and fraud in sunday's elections. reports state that 5 people have been killed, and over 300 injured. the injured were police and protesters alike, suffering from smoke poisoning, rubber bullets, and stoning. among the injured was a japanese citizen, who was reportedly flown to japan in the morning.", 'Hypothesis_9': '300 people were killed in mongolia.', 'Label_9': 'false', 'Premise_10': "the settlement must be approved by citigroup's board of directors and the board of regents of the university of california, the lead plaintiff for investors in the case.", 'Hypothesis_10': "the settlement is pending approval by citigroup's directors and the board of regents at the university of california.", 'Label_10': 'true', 'Premise_11': 'the drawbacks of legalization do not imply that our current version of prohibition is the optimal drug strategy; it may well be possible to implement prohibition in less harmful ways.', 'Hypothesis_11': 'drug legalization has benefits.', 'Label_11': 'false', 'Premise_12': "miller, the pulitzer prize-winning playwright whose most famous fictional creation,  loman in 'death of a salesman' came to symbolize the american dream gone awry, has died.", 'Hypothesis_12': "playwright miller, the pulitzer prize-winning author of 'death of a salesman', has died.", 'Label_12': 'true', 'Premise_13': 'the common binding of catholic faith did little to prevent the bavarians from slaughtering fellow believers in the 19th century under prussian protestant officers.', 'Hypothesis_13': '19 bavarians are catholic.', 'Label_13': 'false', 'Premise_14': 'italian director federico fellini was older than his american peers at his first nomination and, like other foreigners, had not been nominated for his earlier masterworks, "la strada" and "nights of cabiria", though both films had won the best foreign-language picture in 1956 and 1957, respectively. fellini later received an honorary oscar in 1993, which was basically a compensatory gesture.', 'Hypothesis_14': 'an italian director is awarded an honorary oscar.', 'Label_14': 'true', 'Premise_15': 'an israeli judicial inquiry has ruled out prosecuting the police officers who shot dead 13 israeli arabs during a violent demonstration in 2000.', 'Hypothesis_15': 'israel will not prosecute the police who killed 13 israeli arabs during pro-palestinian protests in 2000, because of a lack of evidence, an official inquiry said yesterday.', 'Label_15': 'false'}
{'label': 1, 'idx': 0, 'premise': 'dana reeve, the widow of the actor christopher reeve, has died of lung cancer at age 44, according to the christopher reeve foundation.', 'hypothesis': 'christopher reeve had an accident.', 'Premise_0': 'initially the bundesbank opposed the introduction of the euro but was compelled to accept it in light of the political pressure of the capitalist politicians who supported its introduction.', 'Hypothesis_0': 'the introduction of the euro has been opposed.', 'Label_0': 'true', 'Premise_1': "gonzález márquez, felipe is a spanish political leader. after joining what was then the spanish socialist workers' party, gonzález became its secretary-general and revived it from the moribund position into which it had fallen under franco.", 'Hypothesis_1': 'felipe gonzález is the president of spain.', 'Label_1': 'false', 'Premise_2': 'the pills were sold under store brands by wal-mart, cvs, safeway and more than 120 other major retailers, the food and drug administration said.', 'Hypothesis_2': 'the pills were commercialized by major retailers.', 'Label_2': 'true', 'Premise_3': 'the total estimated project cost including financing, inflation and interest during construction, is approximately us$1.1 billion.', 'Hypothesis_3': 'a hydroelectric project is proposed or is under construction.', 'Label_3': 'false', 'Premise_4': "ibm is now at the top of my list of where i want to work. ivy alone had nine interviews when the team visited the company's headquarters in armonk last week.", 'Hypothesis_4': "ibm's has its headquarters in armonk.", 'Label_4': 'true', 'Premise_5': "floods are one of europe's most widespread disasters. major flooding has occurred nearly every year somewhere on our continent during the last few decades.", 'Hypothesis_5': 'flooding in europe causes major economic losses.', 'Label_5': 'false', 'Premise_6': "radical jordanian cleric, abu qatada, and nine other foreign nationals said to pose a threat to the uk's security, have been detained, pending deportation.", 'Hypothesis_6': "10 foreign nationals were a threat to britian's national security.", 'Label_6': 'true', 'Premise_7': 'the deal marks the second foray into lithuania by philip morris which in april beat british american tobacco to acquire the klaipeda tobacco company for dollars 40m - the biggest western investment in the baltic states so far.', 'Hypothesis_7': 'the acquisition of the klaipeda tobacco company is the biggest investment in the baltic states.', 'Label_7': 'false', 'Premise_8': "in jerusalem, the faithful celebrated mass at the church of the holy sepulcher, traditionally believed to mark the site where jesus was crucified, buried and then resurrected. brown-robed friars marched into the church to the sound of bagpipes, followed by clergymen in purple capes and others bearing crosses. and in the earthquake-ravaged central italian city of l'aquila, survivors gathered in makeshift chapels set up in tent cities that are housing some of the 55,000 people driven from their homes by monday's 6.3-magnitude temblor.", 'Hypothesis_8': 'a 6.3-magnitude earthquake struck the center of italy.', 'Label_8': 'true', 'Premise_9': "a four-day state of emergency has been declared in the capital of mongolia, ulaanbaatar after violent protests occurred after allegations of vote rigging and fraud in sunday's elections. reports state that 5 people have been killed, and over 300 injured. the injured were police and protesters alike, suffering from smoke poisoning, rubber bullets, and stoning. among the injured was a japanese citizen, who was reportedly flown to japan in the morning.", 'Hypothesis_9': '300 people were killed in mongolia.', 'Label_9': 'false', 'Premise_10': "the settlement must be approved by citigroup's board of directors and the board of regents of the university of california, the lead plaintiff for investors in the case.", 'Hypothesis_10': "the settlement is pending approval by citigroup's directors and the board of regents at the university of california.", 'Label_10': 'true', 'Premise_11': 'the drawbacks of legalization do not imply that our current version of prohibition is the optimal drug strategy; it may well be possible to implement prohibition in less harmful ways.', 'Hypothesis_11': 'drug legalization has benefits.', 'Label_11': 'false', 'Premise_12': "miller, the pulitzer prize-winning playwright whose most famous fictional creation,  loman in 'death of a salesman' came to symbolize the american dream gone awry, has died.", 'Hypothesis_12': "playwright miller, the pulitzer prize-winning author of 'death of a salesman', has died.", 'Label_12': 'true', 'Premise_13': 'the common binding of catholic faith did little to prevent the bavarians from slaughtering fellow believers in the 19th century under prussian protestant officers.', 'Hypothesis_13': '19 bavarians are catholic.', 'Label_13': 'false', 'Premise_14': 'italian director federico fellini was older than his american peers at his first nomination and, like other foreigners, had not been nominated for his earlier masterworks, "la strada" and "nights of cabiria", though both films had won the best foreign-language picture in 1956 and 1957, respectively. fellini later received an honorary oscar in 1993, which was basically a compensatory gesture.', 'Hypothesis_14': 'an italian director is awarded an honorary oscar.', 'Label_14': 'true', 'Premise_15': 'an israeli judicial inquiry has ruled out prosecuting the police officers who shot dead 13 israeli arabs during a violent demonstration in 2000.', 'Hypothesis_15': 'israel will not prosecute the police who killed 13 israeli arabs during pro-palestinian protests in 2000, because of a lack of evidence, an official inquiry said yesterday.', 'Label_15': 'false'}
['{}\n The question is: {}. True or False?\nThe Answer is: {}']
{0: ['true'], 1: ['false']}
./checkpoints/rte/meta-llama/Llama-2-7b-hf/icl_attack/icl_attack-seed-42-shot-8/icl_attack_log.csv
<textattack.attacker.Attacker object at 0x7f0207a095b0>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (2): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (3): WordSwapHomoglyphSwap
    (4): WordSwapEmbedding(
        (max_candidates):  5
        (embedding):  WordEmbedding
      )
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.15
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.8
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (2): RepeatModification
    (3): StopwordModification
    (4): InstructionModification(
        (columns_to_ignore):  ['sentence', 'label_', 'premise', 'hypothesis']
      )
  (is_black_box):  True
) 


+-------------------------------+---------+
| Attack Results                |         |
+-------------------------------+---------+
| Number of successful attacks: | 31      |
| Number of failed attacks:     | 175     |
| Number of skipped attacks:    | 71      |
| Original accuracy:            | 74.37   |
| Accuracy under attack:        | 63.18   |
| Attack success rate:          | 15.05   |
| Average perturbed word %:     | 0.15    |
| Average num. words per input: | 795.02  |
| Avg num queries:              | 1147.47 |
| Adv confidence:               | 0.52    |
+-------------------------------+---------+
Attack time: 31367.525433540344
Attack time: 31367.525433540344
