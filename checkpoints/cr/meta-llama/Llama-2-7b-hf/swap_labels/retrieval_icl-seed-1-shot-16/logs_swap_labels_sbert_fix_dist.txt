1
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=4, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='cr', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=True, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-16_sbert_fix_dist', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=250, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_cr.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_cr.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-16_sbert_fix_dist
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=4, beta=1.0, cache_dir='./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-16_sbert_fix_dist/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='cr', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=True, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-16_sbert_fix_dist', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=250, ralm_save_path='./data/ralm/cr_sbert.pkl', replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_cr.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_cr.yaml', weight_decay=0.01)
Length of anchor subsample 32
Length of icl examples 2
Finished loading model
Loading retrieved examples from ./data/ralm/cr_sbert.pkl
ICL examples
{'label': 1, 'sentence': "they 're easy to use", 'idx': 0, 'Example_0': 'really easy to use', 'Label_0': 'positive', 'Example_1': 'all in all suprisingly easy to use', 'Label_1': 'positive', 'Example_2': 'second , it is incredibly easy to use', 'Label_2': 'positive', 'Example_3': 'in general it is easy to use and well laid out', 'Label_3': 'positive', 'Example_4': 'very simple to use', 'Label_4': 'positive', 'Example_5': 'the buttons and interface are very easy to use', 'Label_5': 'positive', 'Example_6': 'controls easy yo use and easy to get to', 'Label_6': 'positive', 'Example_7': 'easy to use a lot of reviews has mentioned about this', 'Label_7': 'positive', 'Example_8': "it ' s easy to use , and yet very feature rich", 'Label_8': 'positive', 'Example_9': 'the controls are easy to understand and big enough that they are easy to see and use', 'Label_9': 'positive', 'Example_10': 'the other controls are all very easy to use', 'Label_10': 'positive', 'Example_11': 'both are very easy to learn use , and intuitive enough for even a novice', 'Label_11': 'positive', 'Example_12': 'they were easy to setup with plenty of power to hog through anything i have encountered', 'Label_12': 'positive', 'Example_13': "fact is , it could n ' t be easier to use", 'Label_13': 'positive', 'Example_14': 'the menus are easy to navigate and the buttons are easy to use', 'Label_14': 'positive', 'Example_15': "very easy to use for someone like me who ' s just hopping on the digital camera bandwagon", 'Label_15': 'positive', 'Example_16': 'the unit is easy to use and intuitive', 'Label_16': 'positive', 'Example_17': '1 ) the champ is easy to use', 'Label_17': 'positive', 'Example_18': "it ' s easier and much more convenient to use because it doesn ' t have clumsy and confusing ( not to mention expensive ) refills", 'Label_18': 'positive', 'Example_19': 'simple click buttons , back buttons volume and display are very easy to read , access and use', 'Label_19': 'positive', 'Example_20': 'the menus are very easy to navigate', 'Label_20': 'positive', 'Example_21': 'i prefer things that are simple', 'Label_21': 'positive', 'Example_22': 'its easy to use and the sheer fun of being able to use an array of nikon accessories like the telephoto and wide angle lenses is the proverbial icing on the cake', 'Label_22': 'positive', 'Example_23': 'it is easy enough to use for a beginner like me but it has plenty of features for me to grow into', 'Label_23': 'positive', 'Example_24': 'extremely convenient', 'Label_24': 'positive', 'Example_25': '2 it is easy enough for my grandmother to use', 'Label_25': 'positive', 'Example_26': 'whether you are a novice or an expert , its ease of use and functionality goes together', 'Label_26': 'positive', 'Example_27': 'cuts are easy and smooth', 'Label_27': 'positive', 'Example_28': 'great product , easy to use , economical , effective , absolutly fabulous', 'Label_28': 'positive', 'Example_29': 'they really are awfully small', 'Label_29': 'negative', 'Example_30': "it ' s easy to use ( just a flip of the lid , and the diaper is gone ! )", 'Label_30': 'positive', 'Example_31': "it ' s also so easy to use and holds a great deal of diapers", 'Label_31': 'positive'}
{'label': 1, 'sentence': "they 're easy to use", 'idx': 0, 'Example_0': 'really easy to use', 'Label_0': 'positive', 'Example_1': 'all in all suprisingly easy to use', 'Label_1': 'positive', 'Example_2': 'second , it is incredibly easy to use', 'Label_2': 'positive', 'Example_3': 'in general it is easy to use and well laid out', 'Label_3': 'positive', 'Example_4': 'very simple to use', 'Label_4': 'positive', 'Example_5': 'the buttons and interface are very easy to use', 'Label_5': 'positive', 'Example_6': 'controls easy yo use and easy to get to', 'Label_6': 'positive', 'Example_7': 'easy to use a lot of reviews has mentioned about this', 'Label_7': 'positive', 'Example_8': "it ' s easy to use , and yet very feature rich", 'Label_8': 'positive', 'Example_9': 'the controls are easy to understand and big enough that they are easy to see and use', 'Label_9': 'positive', 'Example_10': 'the other controls are all very easy to use', 'Label_10': 'positive', 'Example_11': 'both are very easy to learn use , and intuitive enough for even a novice', 'Label_11': 'positive', 'Example_12': 'they were easy to setup with plenty of power to hog through anything i have encountered', 'Label_12': 'positive', 'Example_13': "fact is , it could n ' t be easier to use", 'Label_13': 'positive', 'Example_14': 'the menus are easy to navigate and the buttons are easy to use', 'Label_14': 'positive', 'Example_15': "very easy to use for someone like me who ' s just hopping on the digital camera bandwagon", 'Label_15': 'positive', 'Example_16': 'the unit is easy to use and intuitive', 'Label_16': 'positive', 'Example_17': '1 ) the champ is easy to use', 'Label_17': 'positive', 'Example_18': "it ' s easier and much more convenient to use because it doesn ' t have clumsy and confusing ( not to mention expensive ) refills", 'Label_18': 'positive', 'Example_19': 'simple click buttons , back buttons volume and display are very easy to read , access and use', 'Label_19': 'positive', 'Example_20': 'the menus are very easy to navigate', 'Label_20': 'positive', 'Example_21': 'i prefer things that are simple', 'Label_21': 'positive', 'Example_22': 'its easy to use and the sheer fun of being able to use an array of nikon accessories like the telephoto and wide angle lenses is the proverbial icing on the cake', 'Label_22': 'positive', 'Example_23': 'it is easy enough to use for a beginner like me but it has plenty of features for me to grow into', 'Label_23': 'positive', 'Example_24': 'extremely convenient', 'Label_24': 'positive', 'Example_25': '2 it is easy enough for my grandmother to use', 'Label_25': 'positive', 'Example_26': 'whether you are a novice or an expert , its ease of use and functionality goes together', 'Label_26': 'positive', 'Example_27': 'cuts are easy and smooth', 'Label_27': 'positive', 'Example_28': 'great product , easy to use , economical , effective , absolutly fabulous', 'Label_28': 'positive', 'Example_29': 'they really are awfully small', 'Label_29': 'negative', 'Example_30': "it ' s easy to use ( just a flip of the lid , and the diaper is gone ! )", 'Label_30': 'positive', 'Example_31': "it ' s also so easy to use and holds a great deal of diapers", 'Label_31': 'positive'}
['Review: {}\nSentiment: {}']
{0: ['negative'], 1: ['positive']}
./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-16_sbert_fix_dist/swap_labels_fix_dist_log.csv
<textattack.attacker.Attacker object at 0x7fbe4702cb80>
Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapDuo
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): UniformSwap(
        (threshold):  1
        (compare_against_original):  True
      )
    (2): InstructionModification(
        (columns_to_ignore):  ['sentence', 'example_', 'premise', 'hypothesis']
      )
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 73     |
| Number of failed attacks:     | 280    |
| Number of skipped attacks:    | 23     |
| Original accuracy:            | 93.88  |
| Accuracy under attack:        | 74.47  |
| Attack success rate:          | 20.68  |
| Average perturbed word %:     | 0.66   |
| Average num. words per input: | 599.12 |
| Avg num queries:              | 202.48 |
| Adv confidence:               | 0.65   |
| Average Original Perplexity:  | 26.32  |
| Average Attack Perplexity:    | 26.27  |
| Average Attack USE Score:     | 0.99   |
+-------------------------------+--------+
Attack time: 7030.336058139801
Attack time: 7030.336058139801
