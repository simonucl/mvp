1
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=4, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='cr', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-16', model_id='0', model_type='icl_attack', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=250, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_cr.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_cr.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-16
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=4, beta=1.0, cache_dir='./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-16/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='cr', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-16', model_id='0', model_type='icl_attack', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=2, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=250, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_cr.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_cr.yaml', weight_decay=0.01)
Length of anchor subsample 0
Length of icl examples 2
Finished loading model
ICL examples
{'label': 1, 'sentence': "they 're easy to use", 'idx': 0, 'Example_0': "the only things i have found that i havent liked is that the lcd is hard to read in daylight but everyone else ' s is too", 'Label_0': 'negative', 'Example_1': 'im able to keep my phone on for about a week ( mostly stand by ) to three days ( regular use )', 'Label_1': 'positive', 'Example_2': 'no way to contact their customer service', 'Label_2': 'negative', 'Example_3': 'as any digital camera owner knows is that when you go to take a picture of a moving object to expect some blurring but with some preliminary testing we had simone move there hands back and forth under the lense and another person take the picture and suprisingly a crystal clear image appeared on the decently sized screen', 'Label_3': 'positive', 'Example_4': 'a little weighty ( 9 ounces no biggie ) , but otherwise fine', 'Label_4': 'negative', 'Example_5': 'my brother had an old linksys b band wireless router in his home and it was like magic', 'Label_5': 'positive', 'Example_6': 'after several years of torture in the hands of at t customer service i am delighted to drop them , and look forward to august 2004 when i will convert our other 3 family phones from at t to t mobile !', 'Label_6': 'negative', 'Example_7': 'whether you are a novice or an expert , its ease of use and functionality goes together', 'Label_7': 'positive', 'Example_8': 'both of them keep disconnecting on me and interruptions are 3 or 4 times per day at best', 'Label_8': 'negative', 'Example_9': 'the interface works great', 'Label_9': 'positive', 'Example_10': "if it weren ' t so big i would probably by another since no shop is complete without a handful of routers", 'Label_10': 'negative', 'Example_11': 'i love this camera', 'Label_11': 'positive', 'Example_12': 'i loved it until it broke , but less than a month is not an acceptable period of time for something to work', 'Label_12': 'negative', 'Example_13': 'all the good reviews for the sd500 are true', 'Label_13': 'positive', 'Example_14': "in noisy environment , it ' s hard to hear from the earpiece", 'Label_14': 'negative', 'Example_15': "upside this one , like most nokias , receives a consistently strong signal ( i ' ve tried some samsung and sony ericsson models which were very weak on the reception front )", 'Label_15': 'positive', 'Example_16': 'it is buggy , slow and basically frustrates the heck out of the user', 'Label_16': 'negative', 'Example_17': 'the software you get with this camera is perfect', 'Label_17': 'positive', 'Example_18': "the zooming lever is shaky , i hope it does not operate mechanically , otherwise you ' ll feel uneasy", 'Label_18': 'negative', 'Example_19': "i love that you don ' t have to purchase expensive refills", 'Label_19': 'positive', 'Example_20': 'this unit was working fine for the 1st month and a half and then the color signal disappeared', 'Label_20': 'negative', 'Example_21': 'i didnt have any installation problems and the touch pad is fine , even if it is sort of inaccurate', 'Label_21': 'positive', 'Example_22': 'software is absolutely terrible', 'Label_22': 'negative', 'Example_23': "it is so small that i am able to keep it in my pocket , and i don ' t have to fear that it will get ruined in my pocket because it is so durable", 'Label_23': 'positive', 'Example_24': "it ' s oftentimes hard to get a good grip on the router , activate the chuck lock , and get enough muscle behind the wrench to get the collet loosened up", 'Label_24': 'negative', 'Example_25': 'i bought this slick phone and i am very happy with it', 'Label_25': 'positive', 'Example_26': 'was a bit wary because the software is windows only and i have an mac', 'Label_26': 'negative', 'Example_27': 'but that is good for me because symantec soft wares are a bit hard to master for me who are not savvy on computers', 'Label_27': 'positive', 'Example_28': "doesn ' t have alot of good games on it", 'Label_28': 'negative', 'Example_29': 'i received this item for christmas and it has met and exceeded all my standards', 'Label_29': 'positive', 'Example_30': 'speaker volume is loud and clear but it sacrifices the battery life', 'Label_30': 'negative', 'Example_31': 'it really is the perfect travel camera , plus it offers the convenience of digital photography', 'Label_31': 'positive'}
{'label': 1, 'sentence': "they 're easy to use", 'idx': 0, 'Example_0': "the only things i have found that i havent liked is that the lcd is hard to read in daylight but everyone else ' s is too", 'Label_0': 'negative', 'Example_1': 'im able to keep my phone on for about a week ( mostly stand by ) to three days ( regular use )', 'Label_1': 'positive', 'Example_2': 'no way to contact their customer service', 'Label_2': 'negative', 'Example_3': 'as any digital camera owner knows is that when you go to take a picture of a moving object to expect some blurring but with some preliminary testing we had simone move there hands back and forth under the lense and another person take the picture and suprisingly a crystal clear image appeared on the decently sized screen', 'Label_3': 'positive', 'Example_4': 'a little weighty ( 9 ounces no biggie ) , but otherwise fine', 'Label_4': 'negative', 'Example_5': 'my brother had an old linksys b band wireless router in his home and it was like magic', 'Label_5': 'positive', 'Example_6': 'after several years of torture in the hands of at t customer service i am delighted to drop them , and look forward to august 2004 when i will convert our other 3 family phones from at t to t mobile !', 'Label_6': 'negative', 'Example_7': 'whether you are a novice or an expert , its ease of use and functionality goes together', 'Label_7': 'positive', 'Example_8': 'both of them keep disconnecting on me and interruptions are 3 or 4 times per day at best', 'Label_8': 'negative', 'Example_9': 'the interface works great', 'Label_9': 'positive', 'Example_10': "if it weren ' t so big i would probably by another since no shop is complete without a handful of routers", 'Label_10': 'negative', 'Example_11': 'i love this camera', 'Label_11': 'positive', 'Example_12': 'i loved it until it broke , but less than a month is not an acceptable period of time for something to work', 'Label_12': 'negative', 'Example_13': 'all the good reviews for the sd500 are true', 'Label_13': 'positive', 'Example_14': "in noisy environment , it ' s hard to hear from the earpiece", 'Label_14': 'negative', 'Example_15': "upside this one , like most nokias , receives a consistently strong signal ( i ' ve tried some samsung and sony ericsson models which were very weak on the reception front )", 'Label_15': 'positive', 'Example_16': 'it is buggy , slow and basically frustrates the heck out of the user', 'Label_16': 'negative', 'Example_17': 'the software you get with this camera is perfect', 'Label_17': 'positive', 'Example_18': "the zooming lever is shaky , i hope it does not operate mechanically , otherwise you ' ll feel uneasy", 'Label_18': 'negative', 'Example_19': "i love that you don ' t have to purchase expensive refills", 'Label_19': 'positive', 'Example_20': 'this unit was working fine for the 1st month and a half and then the color signal disappeared', 'Label_20': 'negative', 'Example_21': 'i didnt have any installation problems and the touch pad is fine , even if it is sort of inaccurate', 'Label_21': 'positive', 'Example_22': 'software is absolutely terrible', 'Label_22': 'negative', 'Example_23': "it is so small that i am able to keep it in my pocket , and i don ' t have to fear that it will get ruined in my pocket because it is so durable", 'Label_23': 'positive', 'Example_24': "it ' s oftentimes hard to get a good grip on the router , activate the chuck lock , and get enough muscle behind the wrench to get the collet loosened up", 'Label_24': 'negative', 'Example_25': 'i bought this slick phone and i am very happy with it', 'Label_25': 'positive', 'Example_26': 'was a bit wary because the software is windows only and i have an mac', 'Label_26': 'negative', 'Example_27': 'but that is good for me because symantec soft wares are a bit hard to master for me who are not savvy on computers', 'Label_27': 'positive', 'Example_28': "doesn ' t have alot of good games on it", 'Label_28': 'negative', 'Example_29': 'i received this item for christmas and it has met and exceeded all my standards', 'Label_29': 'positive', 'Example_30': 'speaker volume is loud and clear but it sacrifices the battery life', 'Label_30': 'negative', 'Example_31': 'it really is the perfect travel camera , plus it offers the convenience of digital photography', 'Label_31': 'positive'}
['Review: {}\nSentiment: {}']
{0: ['negative'], 1: ['positive']}
./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-16/swap_labels_log.csv
<textattack.attacker.Attacker object at 0x7fa868557b20>
Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapLabel(
        (label_map):  ['negative', 'positive']
      )
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): InstructionModification(
        (columns_to_ignore):  ['sentence', 'example_', 'premise', 'hypothesis']
      )
    (2): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 328    |
| Number of failed attacks:     | 12     |
| Number of skipped attacks:    | 36     |
| Original accuracy:            | 90.43  |
| Accuracy under attack:        | 3.19   |
| Attack success rate:          | 96.47  |
| Average perturbed word %:     | 0.63   |
| Average num. words per input: | 615.47 |
| Avg num queries:              | 122.26 |
| Adv confidence:               | 0.54   |
| Average Original Perplexity:  | 6.21   |
| Average Attack Perplexity:    | 6.27   |
| Average Attack USE Score:     | 0.99   |
+-------------------------------+--------+
Attack time: 3722.6881053447723
Attack time: 3722.6881053447723
