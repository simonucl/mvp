1
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=1, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-16', model_id='0', model_type='icl_attack', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-16
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=1, beta=1.0, cache_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-16/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-16', model_id='0', model_type='icl_attack', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
Length of anchor subsample 0
Length of icl examples 3
Finished loading model
ICL examples
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': 'well her husband died they were in the military together and she just did not want to take care of the house', 'Hypothesis_0': 'while they were in the military her husband died.', 'Label_0': 'yes', 'Premise_1': 'when bathing in the sea became popular at the end of the 18th century, wealthy families from edinburgh began to spend days here taking the waters in state-of-the art bathing machines. ', 'Hypothesis_1': 'there were tensions between locals who welcomed the increased tourism, and those who did not.', 'Label_1': 'maybe', 'Premise_2': "he suggested to her repeatedly that it was 4.30, and not 4 o'clock when she had heard the voices. ", 'Hypothesis_2': 'he agreed with her on the timing.', 'Label_2': 'no', 'Premise_3': "kind of like k mart except it's a little better than what k mart sells i think", 'Hypothesis_3': 'it is close to k mart, but has a better selection.', 'Label_3': 'yes', 'Premise_4': "why, it's their chineseness, of course.", 'Hypothesis_4': 'their chineseness caused the faux pa, obviously.', 'Label_4': 'maybe', 'Premise_5': 'at the same time, the data indicate many missed opportunities for treatment in the ed.', 'Hypothesis_5': 'the data showed that every opportunity for treatment was exhausted.', 'Label_5': 'no', 'Premise_6': "well it's so crowded up there", 'Hypothesis_6': "the person says that it's very crowded up there.", 'Label_6': 'yes', 'Premise_7': 'this approach could be implemented through addition of a pulse jet fabric filter (pjff) when aci is installed.', 'Hypothesis_7': 'the approach will be an improvement.', 'Label_7': 'maybe', 'Premise_8': 'we would have died last night if it were not for you.', 'Hypothesis_8': 'we would have been alright without you last night.', 'Label_8': 'no', 'Premise_9': "' ) also, unlike back east, there's no vertiginous obsession with how young these ipo-heads are, because almost everybody is scandalously young.", 'Hypothesis_9': "almost everybody is scandalously young, so there's no obsession about the age of these ipo-heads.", 'Label_9': 'yes', 'Premise_10': "yeah that's it's a different kind of bread and it's somewhat of a harder crust it's not the soft", 'Hypothesis_10': 'the bread is different, with a harder crust that i prefer.', 'Label_10': 'maybe', 'Premise_11': 'participate directly in the oversight process as an independent congressional entity.', 'Hypothesis_11': 'the oversight process cannot be participated in directly.', 'Label_11': 'no', 'Premise_12': "yes, sir, but they'd all cleared out.", 'Hypothesis_12': "that's right but they've already cleared out.", 'Label_12': 'yes', 'Premise_13': 'the museum also includes works by fellow painters braque, matisse, mire, degas, renoir, and rousseau collected by picasso during his lifetime.', 'Hypothesis_13': "picasso's favorite painter in his collection was matisse. ", 'Label_13': 'maybe', 'Premise_14': "'running diagnostic,' the computer chirped.", 'Hypothesis_14': 'the computer stayed silent all the time.', 'Label_14': 'no', 'Premise_15': "also in the crypt are the remains of napoleon's son, brought to france from vienna by hitler in 1940.", 'Hypothesis_15': "napoleon's son's remains were brought to france by hitler in the start of the 1940s.", 'Label_15': 'yes', 'Premise_16': "the weather grew cool enough that they didn't have to stop in the afternoon.", 'Hypothesis_16': 'the weather was 72 degrees.', 'Label_16': 'maybe', 'Premise_17': "oh um i think he's got good intentions but i'm not sure if the way he goes about what he does is really right", 'Hypothesis_17': "he's got no goal in my mind but whatever he's doing, it's clearly working.", 'Label_17': 'no', 'Premise_18': 'these parents pressure school systems to be more rigorous and give more homework.', 'Hypothesis_18': 'these parents attempt to farce schools to assign more difficult work to students.', 'Label_18': 'yes', 'Premise_19': "okay well i'm going to tell you what i'd have", 'Hypothesis_19': 'i like talking to people about things i would have.', 'Label_19': 'maybe', 'Premise_20': 'jean shope expressed her belief that addressing alcohol problems in the emergency department is the failure not just of primary care, but of many systems.', 'Hypothesis_20': 'alcohol related issues have always been dealt with. ', 'Label_20': 'no', 'Premise_21': "changes of nationality have left alsace with a distinctive dialect, architecture, cuisine, and local pride ' the best of both worlds.", 'Hypothesis_21': 'alsace has a distinctive culture to it. ', 'Label_21': 'yes', 'Premise_22': 'the original slaves whom the spanish had released after 1655 became known as  maroons,  from the spanish word cimarr??n (which means  wild  or  untamed ).', 'Hypothesis_22': 'slaves were released and some became respected.', 'Label_22': 'maybe', 'Premise_23': 'cinemas on the champs-elysees, in montparnasse, st-germain-des-pres, bastille, and the forum des halles all show vo movies.', 'Hypothesis_23': 'vo movies are those that have been rated to be violent.', 'Label_23': 'no', 'Premise_24': "they just  that's that's incredible", 'Hypothesis_24': "i'm amazed they did that.", 'Label_24': 'yes', 'Premise_25': 'the ultimate goal of the data reliability assessment is to determine whether you can use the data to answer the research question.', 'Hypothesis_25': 'the data reliability assessment has an ultimate goal that is difficult to reach.', 'Label_25': 'maybe', 'Premise_26': 'so they renovated the old sweet candy company building for tomax.', 'Hypothesis_26': "they didn't have the money to renovate the old building.", 'Label_26': 'no', 'Premise_27': 'all at once blood erupted from the eyes and mouth of the helm.', 'Hypothesis_27': 'the blood came out from the eyes.', 'Label_27': 'yes', 'Premise_28': 'as more powerful computers place more responsibility for data processing in the hands of the end users, the needed controls should be identified and implemented.', 'Hypothesis_28': 'computers require more responsibility for data processing with the people who use the software on their home computers.', 'Label_28': 'maybe', 'Premise_29': 'yeah i drink beer', 'Hypothesis_29': "i don't drink beer ever.", 'Label_29': 'no', 'Premise_30': "this unfortunate result goes unmentioned in penn's summary, and the dlc's press release begins as though it never  democratic rank and file voters are following president clinton into the vital center of the national debate, according to a new survey.", 'Hypothesis_30': "penn's summary entirely fails to mention this unfortunate result.", 'Label_30': 'yes', 'Premise_31': '6a may be viewed as candidates to become workshared, if the discount is increased.', 'Hypothesis_31': 'the discount would have to be increased by at least half before it will be taken seriously.', 'Label_31': 'maybe', 'Premise_32': 'there are a variety of routes, which can last from a morning to several days.', 'Hypothesis_32': 'there is only one route.', 'Label_32': 'no', 'Premise_33': 'in a style best described as chinese palladian, with its neo-classical columns and heavy hardwood doors, the furnishings and decor bear witness to the great proserity of baba entrepreneurs.', 'Hypothesis_33': 'in the architectural style named chinese palladian, there are used heavy hardwood doors.', 'Label_33': 'yes', 'Premise_34': "but they showed reruns of dallas and it was great because i could turn it on and all of the people were very familiar to me and i'd seen all of the shows so i knew what was going on", 'Hypothesis_34': "it's been about 15 years since i watched dallas when it was first on tv.", 'Label_34': 'maybe', 'Premise_35': 'no my husband does', 'Hypothesis_35': 'i enjoy music, but my husband does not.', 'Label_35': 'no', 'Premise_36': '5 million worth of tickets wednesday--a new high for single-day and opening-day grosses--but its $61.', 'Hypothesis_36': 'wednesday saw more tickets sold than any day ever.', 'Label_36': 'yes', 'Premise_37': 'mintie, who turns 48 this month, started uncommon good in december 1999.', 'Hypothesis_37': 'uncommon good has helped a wide variety of people.', 'Label_37': 'maybe', 'Premise_38': 'in the center of the square stood a statue of a nude man with a spear piercing the mouth of a large worm with the head of a grotesque woman.', 'Hypothesis_38': 'the man has clothes on and the womens face is nice. ', 'Label_38': 'no', 'Premise_39': "and you know they just haven't done a real complete case here to my thinking", 'Hypothesis_39': "i don't think they have really completed the case.", 'Label_39': 'yes', 'Premise_40': 'that, at any rate, was what i was telling them.', 'Hypothesis_40': 'i told them the budget would not be viable for this district.', 'Label_40': 'maybe', 'Premise_41': "teodoro trinfan's come in with some news you oughta hear. ", 'Hypothesis_41': 'teodoro trinfan has come in with no updated reports. ', 'Label_41': 'no', 'Premise_42': "trees that they make paper out of and so every time i recycle newspapers uh in fact there's uh there's a uh kimberly and clark the the makers of kleenex and such", 'Hypothesis_42': 'they make paper out of trees.', 'Label_42': 'yes', 'Premise_43': 'plus costing the taxpayers twenty five thousand dollars a year just to keep the guy locked up', 'Hypothesis_43': 'keeping the guy in jail for 30 years was costing a lot of money.', 'Label_43': 'maybe', 'Premise_44': 'he collapsed screaming.', 'Hypothesis_44': "he didn't make a sound as he collapsed.", 'Label_44': 'no', 'Premise_45': "uh um well they have some watches that look really nice there's one that's got some diamonds on it", 'Hypothesis_45': 'they have a number of attractive watches, one of which contains diamonds. ', 'Label_45': 'yes', 'Premise_46': 'we know, we know.', 'Hypothesis_46': 'we know about the hidden cookies.', 'Label_46': 'maybe', 'Premise_47': 'we try to teach our kids as much as we can at home you know we have we try to spend like monday nights we call it family home evening and', 'Hypothesis_47': 'we did not have the time to teach them anything at home.', 'Label_47': 'no'}
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': 'well her husband died they were in the military together and she just did not want to take care of the house', 'Hypothesis_0': 'while they were in the military her husband died.', 'Label_0': 'yes', 'Premise_1': 'when bathing in the sea became popular at the end of the 18th century, wealthy families from edinburgh began to spend days here taking the waters in state-of-the art bathing machines. ', 'Hypothesis_1': 'there were tensions between locals who welcomed the increased tourism, and those who did not.', 'Label_1': 'maybe', 'Premise_2': "he suggested to her repeatedly that it was 4.30, and not 4 o'clock when she had heard the voices. ", 'Hypothesis_2': 'he agreed with her on the timing.', 'Label_2': 'no', 'Premise_3': "kind of like k mart except it's a little better than what k mart sells i think", 'Hypothesis_3': 'it is close to k mart, but has a better selection.', 'Label_3': 'yes', 'Premise_4': "why, it's their chineseness, of course.", 'Hypothesis_4': 'their chineseness caused the faux pa, obviously.', 'Label_4': 'maybe', 'Premise_5': 'at the same time, the data indicate many missed opportunities for treatment in the ed.', 'Hypothesis_5': 'the data showed that every opportunity for treatment was exhausted.', 'Label_5': 'no', 'Premise_6': "well it's so crowded up there", 'Hypothesis_6': "the person says that it's very crowded up there.", 'Label_6': 'yes', 'Premise_7': 'this approach could be implemented through addition of a pulse jet fabric filter (pjff) when aci is installed.', 'Hypothesis_7': 'the approach will be an improvement.', 'Label_7': 'maybe', 'Premise_8': 'we would have died last night if it were not for you.', 'Hypothesis_8': 'we would have been alright without you last night.', 'Label_8': 'no', 'Premise_9': "' ) also, unlike back east, there's no vertiginous obsession with how young these ipo-heads are, because almost everybody is scandalously young.", 'Hypothesis_9': "almost everybody is scandalously young, so there's no obsession about the age of these ipo-heads.", 'Label_9': 'yes', 'Premise_10': "yeah that's it's a different kind of bread and it's somewhat of a harder crust it's not the soft", 'Hypothesis_10': 'the bread is different, with a harder crust that i prefer.', 'Label_10': 'maybe', 'Premise_11': 'participate directly in the oversight process as an independent congressional entity.', 'Hypothesis_11': 'the oversight process cannot be participated in directly.', 'Label_11': 'no', 'Premise_12': "yes, sir, but they'd all cleared out.", 'Hypothesis_12': "that's right but they've already cleared out.", 'Label_12': 'yes', 'Premise_13': 'the museum also includes works by fellow painters braque, matisse, mire, degas, renoir, and rousseau collected by picasso during his lifetime.', 'Hypothesis_13': "picasso's favorite painter in his collection was matisse. ", 'Label_13': 'maybe', 'Premise_14': "'running diagnostic,' the computer chirped.", 'Hypothesis_14': 'the computer stayed silent all the time.', 'Label_14': 'no', 'Premise_15': "also in the crypt are the remains of napoleon's son, brought to france from vienna by hitler in 1940.", 'Hypothesis_15': "napoleon's son's remains were brought to france by hitler in the start of the 1940s.", 'Label_15': 'yes', 'Premise_16': "the weather grew cool enough that they didn't have to stop in the afternoon.", 'Hypothesis_16': 'the weather was 72 degrees.', 'Label_16': 'maybe', 'Premise_17': "oh um i think he's got good intentions but i'm not sure if the way he goes about what he does is really right", 'Hypothesis_17': "he's got no goal in my mind but whatever he's doing, it's clearly working.", 'Label_17': 'no', 'Premise_18': 'these parents pressure school systems to be more rigorous and give more homework.', 'Hypothesis_18': 'these parents attempt to farce schools to assign more difficult work to students.', 'Label_18': 'yes', 'Premise_19': "okay well i'm going to tell you what i'd have", 'Hypothesis_19': 'i like talking to people about things i would have.', 'Label_19': 'maybe', 'Premise_20': 'jean shope expressed her belief that addressing alcohol problems in the emergency department is the failure not just of primary care, but of many systems.', 'Hypothesis_20': 'alcohol related issues have always been dealt with. ', 'Label_20': 'no', 'Premise_21': "changes of nationality have left alsace with a distinctive dialect, architecture, cuisine, and local pride ' the best of both worlds.", 'Hypothesis_21': 'alsace has a distinctive culture to it. ', 'Label_21': 'yes', 'Premise_22': 'the original slaves whom the spanish had released after 1655 became known as  maroons,  from the spanish word cimarr??n (which means  wild  or  untamed ).', 'Hypothesis_22': 'slaves were released and some became respected.', 'Label_22': 'maybe', 'Premise_23': 'cinemas on the champs-elysees, in montparnasse, st-germain-des-pres, bastille, and the forum des halles all show vo movies.', 'Hypothesis_23': 'vo movies are those that have been rated to be violent.', 'Label_23': 'no', 'Premise_24': "they just  that's that's incredible", 'Hypothesis_24': "i'm amazed they did that.", 'Label_24': 'yes', 'Premise_25': 'the ultimate goal of the data reliability assessment is to determine whether you can use the data to answer the research question.', 'Hypothesis_25': 'the data reliability assessment has an ultimate goal that is difficult to reach.', 'Label_25': 'maybe', 'Premise_26': 'so they renovated the old sweet candy company building for tomax.', 'Hypothesis_26': "they didn't have the money to renovate the old building.", 'Label_26': 'no', 'Premise_27': 'all at once blood erupted from the eyes and mouth of the helm.', 'Hypothesis_27': 'the blood came out from the eyes.', 'Label_27': 'yes', 'Premise_28': 'as more powerful computers place more responsibility for data processing in the hands of the end users, the needed controls should be identified and implemented.', 'Hypothesis_28': 'computers require more responsibility for data processing with the people who use the software on their home computers.', 'Label_28': 'maybe', 'Premise_29': 'yeah i drink beer', 'Hypothesis_29': "i don't drink beer ever.", 'Label_29': 'no', 'Premise_30': "this unfortunate result goes unmentioned in penn's summary, and the dlc's press release begins as though it never  democratic rank and file voters are following president clinton into the vital center of the national debate, according to a new survey.", 'Hypothesis_30': "penn's summary entirely fails to mention this unfortunate result.", 'Label_30': 'yes', 'Premise_31': '6a may be viewed as candidates to become workshared, if the discount is increased.', 'Hypothesis_31': 'the discount would have to be increased by at least half before it will be taken seriously.', 'Label_31': 'maybe', 'Premise_32': 'there are a variety of routes, which can last from a morning to several days.', 'Hypothesis_32': 'there is only one route.', 'Label_32': 'no', 'Premise_33': 'in a style best described as chinese palladian, with its neo-classical columns and heavy hardwood doors, the furnishings and decor bear witness to the great proserity of baba entrepreneurs.', 'Hypothesis_33': 'in the architectural style named chinese palladian, there are used heavy hardwood doors.', 'Label_33': 'yes', 'Premise_34': "but they showed reruns of dallas and it was great because i could turn it on and all of the people were very familiar to me and i'd seen all of the shows so i knew what was going on", 'Hypothesis_34': "it's been about 15 years since i watched dallas when it was first on tv.", 'Label_34': 'maybe', 'Premise_35': 'no my husband does', 'Hypothesis_35': 'i enjoy music, but my husband does not.', 'Label_35': 'no', 'Premise_36': '5 million worth of tickets wednesday--a new high for single-day and opening-day grosses--but its $61.', 'Hypothesis_36': 'wednesday saw more tickets sold than any day ever.', 'Label_36': 'yes', 'Premise_37': 'mintie, who turns 48 this month, started uncommon good in december 1999.', 'Hypothesis_37': 'uncommon good has helped a wide variety of people.', 'Label_37': 'maybe', 'Premise_38': 'in the center of the square stood a statue of a nude man with a spear piercing the mouth of a large worm with the head of a grotesque woman.', 'Hypothesis_38': 'the man has clothes on and the womens face is nice. ', 'Label_38': 'no', 'Premise_39': "and you know they just haven't done a real complete case here to my thinking", 'Hypothesis_39': "i don't think they have really completed the case.", 'Label_39': 'yes', 'Premise_40': 'that, at any rate, was what i was telling them.', 'Hypothesis_40': 'i told them the budget would not be viable for this district.', 'Label_40': 'maybe', 'Premise_41': "teodoro trinfan's come in with some news you oughta hear. ", 'Hypothesis_41': 'teodoro trinfan has come in with no updated reports. ', 'Label_41': 'no', 'Premise_42': "trees that they make paper out of and so every time i recycle newspapers uh in fact there's uh there's a uh kimberly and clark the the makers of kleenex and such", 'Hypothesis_42': 'they make paper out of trees.', 'Label_42': 'yes', 'Premise_43': 'plus costing the taxpayers twenty five thousand dollars a year just to keep the guy locked up', 'Hypothesis_43': 'keeping the guy in jail for 30 years was costing a lot of money.', 'Label_43': 'maybe', 'Premise_44': 'he collapsed screaming.', 'Hypothesis_44': "he didn't make a sound as he collapsed.", 'Label_44': 'no', 'Premise_45': "uh um well they have some watches that look really nice there's one that's got some diamonds on it", 'Hypothesis_45': 'they have a number of attractive watches, one of which contains diamonds. ', 'Label_45': 'yes', 'Premise_46': 'we know, we know.', 'Hypothesis_46': 'we know about the hidden cookies.', 'Label_46': 'maybe', 'Premise_47': 'we try to teach our kids as much as we can at home you know we have we try to spend like monday nights we call it family home evening and', 'Hypothesis_47': 'we did not have the time to teach them anything at home.', 'Label_47': 'no'}
['Premise: {}\nHypothesis: {}\nPrediction: {}']
{0: ['yes'], 1: ['maybe'], 2: ['no']}
./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-16/swap_labels_log.csv
<textattack.attacker.Attacker object at 0x7f0603ef5910>
Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapLabel(
        (label_map):  ['yes', 'maybe', 'no']
      )
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): InstructionModification(
        (columns_to_ignore):  ['sentence', 'example_', 'premise', 'hypothesis']
      )
    (2): RepeatModification
  (is_black_box):  True
) 

