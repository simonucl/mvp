1
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=2, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=True, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-4_sbert_fix_dist', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=250, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=4, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-4_sbert_fix_dist
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=2, beta=1.0, cache_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-4_sbert_fix_dist/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=True, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-4_sbert_fix_dist', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=250, ralm_save_path='./data/ralm/mnli_sbert.pkl', replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=4, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
Length of anchor subsample 12
Length of icl examples 3
Finished loading model
Loading retrieved examples from ./data/ralm/mnli_sbert.pkl
ICL examples
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': "when you sign your ten forty form you're signing a away you're rights i mean your your rights to uh uh protect yourself", 'Hypothesis_0': 'you still have rights, even if you signed.', 'Label_0': 'no', 'Premise_1': "oh okay so it's just another job uh it must be especially frustrating because even your rights in there  are", 'Hypothesis_1': 'your rights are not in there, so that makes it easy. ', 'Label_1': 'no', 'Premise_2': 'special rights for gays.', 'Hypothesis_2': 'special rights for everyone.', 'Label_2': 'maybe', 'Premise_3': "oh sure i think that's that's i feel that you know for certain cases that i that i am willing to give up my rights to secure the rights of others i guess is what i'm saying", 'Hypothesis_3': "i am willing to surrender my rights for others'.", 'Label_3': 'yes', 'Premise_4': "and uh i've noticed that now more and more individual people are speaking out for their own rights rather than massing together", 'Hypothesis_4': "people are more interested in their own rights than in others' rights", 'Label_4': 'maybe', 'Premise_5': "yeah i think you've got to have a good fight you know you have to have a lot of controversy", 'Hypothesis_5': 'i think you have to have a good fight if you want to keep your rights.', 'Label_5': 'maybe', 'Premise_6': 'devolving decisionmaking authority.', 'Hypothesis_6': 'retaining the decision making rights', 'Label_6': 'no', 'Premise_7': "compare 1999 china with 1979  1999 china permits vast economic freedom, sponsors competitive village elections, allows the establishment of nongovernmental organizations, tolerates environmental and women's rights activism, and is starting to develop a reliable legal system.", 'Hypothesis_7': 'the country still has much progress to be made with the rights of their people.', 'Label_7': 'maybe', 'Premise_8': 'in the other instances, there is at least a trade-off posited between individual rights and competing public purposes, like the protection of children.', 'Hypothesis_8': "at least in some instances there's a trade-off between rights and public purposes.", 'Label_8': 'yes', 'Premise_9': '[y]ou can give people all the rights you want, but if they have no way to enforce those rights, those rights are meaningless.', 'Hypothesis_9': 'rights should be given to people along with the means to enforce them.', 'Label_9': 'maybe', 'Premise_10': "oh okay so it's just another job uh it must be especially frustrating because even your rights in there  are", 'Hypothesis_10': 'even your rights are in there, so it must be more frustrating. ', 'Label_10': 'yes', 'Premise_11': "and it's here that the new left's scrupulous scholarship inadvertently dovetails with the right's racist interpretations.", 'Hypothesis_11': 'the right welcomes everyone.', 'Label_11': 'no'}
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': "when you sign your ten forty form you're signing a away you're rights i mean your your rights to uh uh protect yourself", 'Hypothesis_0': 'you still have rights, even if you signed.', 'Label_0': 'no', 'Premise_1': "oh okay so it's just another job uh it must be especially frustrating because even your rights in there  are", 'Hypothesis_1': 'your rights are not in there, so that makes it easy. ', 'Label_1': 'no', 'Premise_2': 'special rights for gays.', 'Hypothesis_2': 'special rights for everyone.', 'Label_2': 'maybe', 'Premise_3': "oh sure i think that's that's i feel that you know for certain cases that i that i am willing to give up my rights to secure the rights of others i guess is what i'm saying", 'Hypothesis_3': "i am willing to surrender my rights for others'.", 'Label_3': 'yes', 'Premise_4': "and uh i've noticed that now more and more individual people are speaking out for their own rights rather than massing together", 'Hypothesis_4': "people are more interested in their own rights than in others' rights", 'Label_4': 'maybe', 'Premise_5': "yeah i think you've got to have a good fight you know you have to have a lot of controversy", 'Hypothesis_5': 'i think you have to have a good fight if you want to keep your rights.', 'Label_5': 'maybe', 'Premise_6': 'devolving decisionmaking authority.', 'Hypothesis_6': 'retaining the decision making rights', 'Label_6': 'no', 'Premise_7': "compare 1999 china with 1979  1999 china permits vast economic freedom, sponsors competitive village elections, allows the establishment of nongovernmental organizations, tolerates environmental and women's rights activism, and is starting to develop a reliable legal system.", 'Hypothesis_7': 'the country still has much progress to be made with the rights of their people.', 'Label_7': 'maybe', 'Premise_8': 'in the other instances, there is at least a trade-off posited between individual rights and competing public purposes, like the protection of children.', 'Hypothesis_8': "at least in some instances there's a trade-off between rights and public purposes.", 'Label_8': 'yes', 'Premise_9': '[y]ou can give people all the rights you want, but if they have no way to enforce those rights, those rights are meaningless.', 'Hypothesis_9': 'rights should be given to people along with the means to enforce them.', 'Label_9': 'maybe', 'Premise_10': "oh okay so it's just another job uh it must be especially frustrating because even your rights in there  are", 'Hypothesis_10': 'even your rights are in there, so it must be more frustrating. ', 'Label_10': 'yes', 'Premise_11': "and it's here that the new left's scrupulous scholarship inadvertently dovetails with the right's racist interpretations.", 'Hypothesis_11': 'the right welcomes everyone.', 'Label_11': 'no'}
['Premise: {}\nHypothesis: {}\nPrediction: {}']
{0: ['yes'], 1: ['maybe'], 2: ['no']}
./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-4_sbert_fix_dist/swap_labels_fix_dist_log.csv
<textattack.attacker.Attacker object at 0x7f00bee223d0>
Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapDuo
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): UniformSwap(
        (threshold):  1
        (compare_against_original):  True
      )
    (2): InstructionModification(
        (columns_to_ignore):  ['sentence', 'example_', 'premise', 'hypothesis']
      )
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 466    |
| Number of failed attacks:     | 109    |
| Number of skipped attacks:    | 425    |
| Original accuracy:            | 57.5   |
| Accuracy under attack:        | 10.9   |
| Attack success rate:          | 81.04  |
| Average perturbed word %:     | 1.04   |
| Average num. words per input: | 384.65 |
| Avg num queries:              | 67.26  |
| Adv confidence:               | 0.67   |
| Average Original Perplexity:  | 20.39  |
| Average Attack Perplexity:    | 20.38  |
| Average Attack USE Score:     | 0.98   |
+-------------------------------+--------+
Attack time: 3101.2969603538513
Attack time: 3101.2969603538513
