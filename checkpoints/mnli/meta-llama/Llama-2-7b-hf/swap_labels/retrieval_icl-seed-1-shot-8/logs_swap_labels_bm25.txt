1
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=2, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8_bm25', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='bm25', sampled_num=1, seed=1, shot=8, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8_bm25
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='swap_labels', batch_size=2, beta=1.0, cache_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8_bm25/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.5, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8_bm25', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, ralm_save_path='./data/ralm/mnli_bm25.pkl', replace_ratio=0.1, retrieve_method='bm25', sampled_num=1, seed=1, shot=8, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
Length of anchor subsample 24
Length of icl examples 3
Finished loading model
Loading retrieved examples from ./data/ralm/mnli_bm25.pkl
ICL examples
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': 'but he never asks whether lawsuits and rights are the only way to prevent these bad things.', 'Hypothesis_0': 'he never asks if they are the only way to not make bad things happen, said the news.', 'Label_0': 'maybe', 'Premise_1': 'but he never asks whether lawsuits and rights are the only way to prevent these bad things.', 'Hypothesis_1': 'he always asks if they are the only way to not make bad things happen.', 'Label_1': 'no', 'Premise_2': 'but he never asks whether lawsuits and rights are the only way to prevent these bad things.', 'Hypothesis_2': 'he never asks if they are the only way to not make bad things happen.', 'Label_2': 'yes', 'Premise_3': 'for the poor and vulnerable, the justice system represents the place of last resort - the place where essential rights are enforced and defended.', 'Hypothesis_3': 'the justice system is a last resort for the poor.', 'Label_3': 'yes', 'Premise_4': 'for the poor and vulnerable, the justice system represents the place of last resort - the place where essential rights are enforced and defended.', 'Hypothesis_4': 'for the non-poor, the justice system is the first place they go to.', 'Label_4': 'maybe', 'Premise_5': 'with its new look and new aim, the prospects are good despite the warnings.', 'Hypothesis_5': 'the prospects seem dire as warnings suggest, and the new look is wasted.', 'Label_5': 'no', 'Premise_6': 'with its new look and new aim, the prospects are good despite the warnings.', 'Hypothesis_6': 'the new appearance and goal are a result of a board review.', 'Label_6': 'maybe', 'Premise_7': 'with its new look and new aim, the prospects are good despite the warnings.', 'Hypothesis_7': 'with a renovated appearance and goal, the potentials are good even in light of warnings.', 'Label_7': 'yes', 'Premise_8': 'new zealand has no written constitution but rather it has two documents of importance-the treaty of waitangi and the bill of rights act.', 'Hypothesis_8': 'new zealand has no constitution in writing.', 'Label_8': 'yes', 'Premise_9': 'new zealand has no written constitution but rather it has two documents of importance-the treaty of waitangi and the bill of rights act.', 'Hypothesis_9': 'there are no documents of importance.', 'Label_9': 'no', 'Premise_10': 'new zealand has no written constitution but rather it has two documents of importance-the treaty of waitangi and the bill of rights act.', 'Hypothesis_10': 'the documents of importance are all that is required.', 'Label_10': 'maybe', 'Premise_11': 'agreed to the terms of employment um as far as the new hires i i hired on just early enough that i i missed it um where the new hires were concerned but uh', 'Hypothesis_11': "i hired the new employees because i thought they'd be a good fit for the company.", 'Label_11': 'maybe', 'Premise_12': 'agreed to the terms of employment um as far as the new hires i i hired on just early enough that i i missed it um where the new hires were concerned but uh', 'Hypothesis_12': 'the new employees agreed to the contract.', 'Label_12': 'yes', 'Premise_13': 'agreed to the terms of employment um as far as the new hires i i hired on just early enough that i i missed it um where the new hires were concerned but uh', 'Hypothesis_13': 'i fired everyone and then quit myself.', 'Label_13': 'no', 'Premise_14': 'the civil rights movement was great.', 'Hypothesis_14': 'the civil rights movement was good for the country and its citizens.', 'Label_14': 'maybe', 'Premise_15': 'the civil rights movement was great.', 'Hypothesis_15': 'it was really good, the civil rights movement.', 'Label_15': 'yes', 'Premise_16': 'the civil rights movement was great.', 'Hypothesis_16': 'we should have never had the civil rights movement.', 'Label_16': 'no', 'Premise_17': 'yeah nice talking with you are you calling from texas by the way', 'Hypothesis_17': 'it was great to speak with you. by the way, are you from texas?', 'Label_17': 'yes', 'Premise_18': 'yeah nice talking with you are you calling from texas by the way', 'Hypothesis_18': 'it has been a great conversation, but i need to know if you are from texas.', 'Label_18': 'maybe', 'Premise_19': 'yeah nice talking with you are you calling from texas by the way', 'Hypothesis_19': 'i did not enjoy our talk and i do not care where you are from.', 'Label_19': 'no', 'Premise_20': "big boom yeah there's something about um the industry in the state that um there's enough i know we moved here from houston and um the city had it's enough money it was really nice that they had uh", 'Hypothesis_20': 'the city is poor.', 'Label_20': 'no', 'Premise_21': "big boom yeah there's something about um the industry in the state that um there's enough i know we moved here from houston and um the city had it's enough money it was really nice that they had uh", 'Hypothesis_21': 'the industry in the state is having a big boom.', 'Label_21': 'yes', 'Premise_22': "big boom yeah there's something about um the industry in the state that um there's enough i know we moved here from houston and um the city had it's enough money it was really nice that they had uh", 'Hypothesis_22': "houston doesn't have as much money as this city.", 'Label_22': 'maybe', 'Premise_23': 'all are varied and challenging enough for the best players.', 'Hypothesis_23': "the land is so slanted that it's challenging for everyone!", 'Label_23': 'maybe'}
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': 'but he never asks whether lawsuits and rights are the only way to prevent these bad things.', 'Hypothesis_0': 'he never asks if they are the only way to not make bad things happen, said the news.', 'Label_0': 'maybe', 'Premise_1': 'but he never asks whether lawsuits and rights are the only way to prevent these bad things.', 'Hypothesis_1': 'he always asks if they are the only way to not make bad things happen.', 'Label_1': 'no', 'Premise_2': 'but he never asks whether lawsuits and rights are the only way to prevent these bad things.', 'Hypothesis_2': 'he never asks if they are the only way to not make bad things happen.', 'Label_2': 'yes', 'Premise_3': 'for the poor and vulnerable, the justice system represents the place of last resort - the place where essential rights are enforced and defended.', 'Hypothesis_3': 'the justice system is a last resort for the poor.', 'Label_3': 'yes', 'Premise_4': 'for the poor and vulnerable, the justice system represents the place of last resort - the place where essential rights are enforced and defended.', 'Hypothesis_4': 'for the non-poor, the justice system is the first place they go to.', 'Label_4': 'maybe', 'Premise_5': 'with its new look and new aim, the prospects are good despite the warnings.', 'Hypothesis_5': 'the prospects seem dire as warnings suggest, and the new look is wasted.', 'Label_5': 'no', 'Premise_6': 'with its new look and new aim, the prospects are good despite the warnings.', 'Hypothesis_6': 'the new appearance and goal are a result of a board review.', 'Label_6': 'maybe', 'Premise_7': 'with its new look and new aim, the prospects are good despite the warnings.', 'Hypothesis_7': 'with a renovated appearance and goal, the potentials are good even in light of warnings.', 'Label_7': 'yes', 'Premise_8': 'new zealand has no written constitution but rather it has two documents of importance-the treaty of waitangi and the bill of rights act.', 'Hypothesis_8': 'new zealand has no constitution in writing.', 'Label_8': 'yes', 'Premise_9': 'new zealand has no written constitution but rather it has two documents of importance-the treaty of waitangi and the bill of rights act.', 'Hypothesis_9': 'there are no documents of importance.', 'Label_9': 'no', 'Premise_10': 'new zealand has no written constitution but rather it has two documents of importance-the treaty of waitangi and the bill of rights act.', 'Hypothesis_10': 'the documents of importance are all that is required.', 'Label_10': 'maybe', 'Premise_11': 'agreed to the terms of employment um as far as the new hires i i hired on just early enough that i i missed it um where the new hires were concerned but uh', 'Hypothesis_11': "i hired the new employees because i thought they'd be a good fit for the company.", 'Label_11': 'maybe', 'Premise_12': 'agreed to the terms of employment um as far as the new hires i i hired on just early enough that i i missed it um where the new hires were concerned but uh', 'Hypothesis_12': 'the new employees agreed to the contract.', 'Label_12': 'yes', 'Premise_13': 'agreed to the terms of employment um as far as the new hires i i hired on just early enough that i i missed it um where the new hires were concerned but uh', 'Hypothesis_13': 'i fired everyone and then quit myself.', 'Label_13': 'no', 'Premise_14': 'the civil rights movement was great.', 'Hypothesis_14': 'the civil rights movement was good for the country and its citizens.', 'Label_14': 'maybe', 'Premise_15': 'the civil rights movement was great.', 'Hypothesis_15': 'it was really good, the civil rights movement.', 'Label_15': 'yes', 'Premise_16': 'the civil rights movement was great.', 'Hypothesis_16': 'we should have never had the civil rights movement.', 'Label_16': 'no', 'Premise_17': 'yeah nice talking with you are you calling from texas by the way', 'Hypothesis_17': 'it was great to speak with you. by the way, are you from texas?', 'Label_17': 'yes', 'Premise_18': 'yeah nice talking with you are you calling from texas by the way', 'Hypothesis_18': 'it has been a great conversation, but i need to know if you are from texas.', 'Label_18': 'maybe', 'Premise_19': 'yeah nice talking with you are you calling from texas by the way', 'Hypothesis_19': 'i did not enjoy our talk and i do not care where you are from.', 'Label_19': 'no', 'Premise_20': "big boom yeah there's something about um the industry in the state that um there's enough i know we moved here from houston and um the city had it's enough money it was really nice that they had uh", 'Hypothesis_20': 'the city is poor.', 'Label_20': 'no', 'Premise_21': "big boom yeah there's something about um the industry in the state that um there's enough i know we moved here from houston and um the city had it's enough money it was really nice that they had uh", 'Hypothesis_21': 'the industry in the state is having a big boom.', 'Label_21': 'yes', 'Premise_22': "big boom yeah there's something about um the industry in the state that um there's enough i know we moved here from houston and um the city had it's enough money it was really nice that they had uh", 'Hypothesis_22': "houston doesn't have as much money as this city.", 'Label_22': 'maybe', 'Premise_23': 'all are varied and challenging enough for the best players.', 'Hypothesis_23': "the land is so slanted that it's challenging for everyone!", 'Label_23': 'maybe'}
['Premise: {}\nHypothesis: {}\nPrediction: {}']
{0: ['yes'], 1: ['maybe'], 2: ['no']}
./checkpoints/mnli/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8_bm25/swap_labels_log.csv
<textattack.attacker.Attacker object at 0x7f46a511da90>
Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapLabel(
        (label_map):  ['yes', 'maybe', 'no']
      )
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.5
        (compare_against_original):  True
      )
    (1): InstructionModification(
        (columns_to_ignore):  ['sentence', 'example_', 'premise', 'hypothesis']
      )
    (2): RepeatModification
  (is_black_box):  True
) 

