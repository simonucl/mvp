1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=4, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-8', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=8, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-8
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=4, beta=1.0, cache_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-8/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-8', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=1, shot=8, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
Finished loading ood dataset
{'premise': 'how about if it was uh a seventeen and a half year old with a a list and all uh of  what do they call it uh criminal as long as your armed over the history of a violent crime', 'hypothesis': 'i think that they should be tried as adults. ', 'label': 1, 'idx': 362024}
Finished replacing ood dataset
{'premise': 'how about if it was uh a seventeen and a half year old with a a list and all uh of  what do they call it uh criminal as long as your armed over the history of a violent crime', 'hypothesis': 'i think that they should be tried as adults. ', 'label': 1, 'idx': 362024}
Length of anchor subsample 0
Length of icl examples 3
Finished loading model
ICL examples
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': '* H1 high street trading profit 53 million stg versus 53 million stg year ago\n', 'Hypothesis_0': 'Darnell faces a maximum penalty of 30 years. Sentencing is set for October.\n', 'Label_0': 'yes', 'Premise_1': 'when bathing in the sea became popular at the end of the 18th century, wealthy families from edinburgh began to spend days here taking the waters in state-of-the art bathing machines. ', 'Hypothesis_1': 'there were tensions between locals who welcomed the increased tourism, and those who did not.', 'Label_1': 'maybe', 'Premise_2': "Faith was a patient at Children's Hospital of Michigan at Detroit Medical Center, known as DMC. DMC hasn't commented.\n", 'Hypothesis_2': 'The victim of a weekend homicide in Copiah County has been identified as 37-year-old Jason Youngblood.\n', 'Label_2': 'no', 'Premise_3': "kind of like k mart except it's a little better than what k mart sells i think", 'Hypothesis_3': 'it is close to k mart, but has a better selection.', 'Label_3': 'yes', 'Premise_4': '* Trevena Inc - on track to submitting new drug application to FDA for olinvo in Q4 of this year Source text for Eikon: Further company coverage:\n', 'Hypothesis_4': 'First Manhattan Co. maintained its stake in shares of Science Applications International Corporation during the third quarter, according to its most recent 13F filing with the SEC.\n', 'Label_4': 'maybe', 'Premise_5': 'at the same time, the data indicate many missed opportunities for treatment in the ed.', 'Hypothesis_5': 'the data showed that every opportunity for treatment was exhausted.', 'Label_5': 'no', 'Premise_6': 'March 30 Starpharma Holdings Ltd\n', 'Hypothesis_6': 'Mining stocks have fallen on the back of a slump in the price of iron ore, the metal used to make steel.\n', 'Label_6': 'yes', 'Premise_7': 'Eight fire crews responded about 4.45am to the blaze at the Mexican restaurant on Victoria Street.\n', 'Hypothesis_7': 'Start the conversation, or Read more at Lewistown Sentinel.\n', 'Label_7': 'maybe', 'Premise_8': 'PHOTOS: Check out the latest pics of Leslie Jones\n', 'Hypothesis_8': 'Dwyer says the house may have to be condemned and demolished due to the condition inside and the odor.\n', 'Label_8': 'no', 'Premise_9': 'At least six players have already come out and said that they won’t be in attendance at the White House, and Brady was asked about it on Tuesday. Check out the link below to hear what he had to say.\n', 'Hypothesis_9': 'Holcomb, the House, and the Senate still need to find agreement not just on how much, but also how to raise taxes.\n', 'Label_9': 'yes', 'Premise_10': 'Knights of Columbus Tootsie Roll drive begins\n', 'Hypothesis_10': 'Northstar Merlot\n', 'Label_10': 'maybe', 'Premise_11': 'Bishop Michael Mulvey made a campus visit of Sacred Heart School in Rockport during National Catholic Schools Week. It was his first opportunity Bishop Mulvey had to see the new and temporary portables that have been brought it to get the school up and running after Hurricane Harvey\'s devastating effect."The school children are so happy to be back home and they expressed their loving gratitude to Bishop Mulvey for his support," Father Ray Yrlas, pastor of Sacred Heart, said.Photos by Mr. Fred Gibbs. (Double click on photo to see album.)\n', 'Hypothesis_11': 'Roger Hannah, a spokesman for the U.S. Nuclear Regulatory Commission, says the agency is allowing resident NRC inspectors at the facility to handle the issue.\n', 'Label_11': 'no', 'Premise_12': 'Acosta’s assessment came while complaining the Trump administration was not taking certain issues seriously enough. He lamented Kardashian’s meeting wasn’t “a serious thing” to have happen at the White House.\n', 'Hypothesis_12': '1:41 USM hopes to turn oysters into gold\n', 'Label_12': 'yes', 'Premise_13': 'the museum also includes works by fellow painters braque, matisse, mire, degas, renoir, and rousseau collected by picasso during his lifetime.', 'Hypothesis_13': "picasso's favorite painter in his collection was matisse. ", 'Label_13': 'maybe', 'Premise_14': 'The lockdown is safety protocol, police said.\n', 'Hypothesis_14': 'Every paper egg sold will help to fund transformative and life-changing programs and services for individuals living with disabilities. You can also purchase eggs online at www.paperegg.ca and send a personalized Easter Seals Spring eCard to your family and friends.\n', 'Label_14': 'no', 'Premise_15': "also in the crypt are the remains of napoleon's son, brought to france from vienna by hitler in 1940.", 'Hypothesis_15': "napoleon's son's remains were brought to france by hitler in the start of the 1940s.", 'Label_15': 'yes', 'Premise_16': "the weather grew cool enough that they didn't have to stop in the afternoon.", 'Hypothesis_16': 'the weather was 72 degrees.', 'Label_16': 'maybe', 'Premise_17': "oh um i think he's got good intentions but i'm not sure if the way he goes about what he does is really right", 'Hypothesis_17': "he's got no goal in my mind but whatever he's doing, it's clearly working.", 'Label_17': 'no', 'Premise_18': 'Aug 14 (Reuters) - Global Link Communications Holdings Ltd :\n', 'Hypothesis_18': 'He was fined $900 plus $1,050 in court fees and $2,609 in restitution. He was ordered to get a chemical dependency evaluation and follow the recommendations, and was placed on supervised probation for five years.\n', 'Label_18': 'yes', 'Premise_19': 'A 24-year-old man was arrested after he allegedly confessed to intentionally ramming a police vehicle with his car. He told police he did it because he wanted to be arrested. "He told police that he wanted\n', 'Hypothesis_19': "Police believe her brother was the gunman's intended target.\n", 'Label_19': 'maybe', 'Premise_20': 'jean shope expressed her belief that addressing alcohol problems in the emergency department is the failure not just of primary care, but of many systems.', 'Hypothesis_20': 'alcohol related issues have always been dealt with. ', 'Label_20': 'no', 'Premise_21': "changes of nationality have left alsace with a distinctive dialect, architecture, cuisine, and local pride ' the best of both worlds.", 'Hypothesis_21': 'alsace has a distinctive culture to it. ', 'Label_21': 'yes', 'Premise_22': 'the original slaves whom the spanish had released after 1655 became known as  maroons,  from the spanish word cimarr??n (which means  wild  or  untamed ).', 'Hypothesis_22': 'slaves were released and some became respected.', 'Label_22': 'maybe', 'Premise_23': 'Mark Grant and Don Orsillo send their thoughts and prayers to Ted Leitner\n', 'Hypothesis_23': 'https://vigilance.fr/vulnerability/...\n', 'Label_23': 'no'}
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': '* H1 high street trading profit 53 million stg versus 53 million stg year ago\n', 'Hypothesis_0': 'Darnell faces a maximum penalty of 30 years. Sentencing is set for October.\n', 'Label_0': 'yes', 'Premise_1': 'when bathing in the sea became popular at the end of the 18th century, wealthy families from edinburgh began to spend days here taking the waters in state-of-the art bathing machines. ', 'Hypothesis_1': 'there were tensions between locals who welcomed the increased tourism, and those who did not.', 'Label_1': 'maybe', 'Premise_2': "Faith was a patient at Children's Hospital of Michigan at Detroit Medical Center, known as DMC. DMC hasn't commented.\n", 'Hypothesis_2': 'The victim of a weekend homicide in Copiah County has been identified as 37-year-old Jason Youngblood.\n', 'Label_2': 'no', 'Premise_3': "kind of like k mart except it's a little better than what k mart sells i think", 'Hypothesis_3': 'it is close to k mart, but has a better selection.', 'Label_3': 'yes', 'Premise_4': '* Trevena Inc - on track to submitting new drug application to FDA for olinvo in Q4 of this year Source text for Eikon: Further company coverage:\n', 'Hypothesis_4': 'First Manhattan Co. maintained its stake in shares of Science Applications International Corporation during the third quarter, according to its most recent 13F filing with the SEC.\n', 'Label_4': 'maybe', 'Premise_5': 'at the same time, the data indicate many missed opportunities for treatment in the ed.', 'Hypothesis_5': 'the data showed that every opportunity for treatment was exhausted.', 'Label_5': 'no', 'Premise_6': 'March 30 Starpharma Holdings Ltd\n', 'Hypothesis_6': 'Mining stocks have fallen on the back of a slump in the price of iron ore, the metal used to make steel.\n', 'Label_6': 'yes', 'Premise_7': 'Eight fire crews responded about 4.45am to the blaze at the Mexican restaurant on Victoria Street.\n', 'Hypothesis_7': 'Start the conversation, or Read more at Lewistown Sentinel.\n', 'Label_7': 'maybe', 'Premise_8': 'PHOTOS: Check out the latest pics of Leslie Jones\n', 'Hypothesis_8': 'Dwyer says the house may have to be condemned and demolished due to the condition inside and the odor.\n', 'Label_8': 'no', 'Premise_9': 'At least six players have already come out and said that they won’t be in attendance at the White House, and Brady was asked about it on Tuesday. Check out the link below to hear what he had to say.\n', 'Hypothesis_9': 'Holcomb, the House, and the Senate still need to find agreement not just on how much, but also how to raise taxes.\n', 'Label_9': 'yes', 'Premise_10': 'Knights of Columbus Tootsie Roll drive begins\n', 'Hypothesis_10': 'Northstar Merlot\n', 'Label_10': 'maybe', 'Premise_11': 'Bishop Michael Mulvey made a campus visit of Sacred Heart School in Rockport during National Catholic Schools Week. It was his first opportunity Bishop Mulvey had to see the new and temporary portables that have been brought it to get the school up and running after Hurricane Harvey\'s devastating effect."The school children are so happy to be back home and they expressed their loving gratitude to Bishop Mulvey for his support," Father Ray Yrlas, pastor of Sacred Heart, said.Photos by Mr. Fred Gibbs. (Double click on photo to see album.)\n', 'Hypothesis_11': 'Roger Hannah, a spokesman for the U.S. Nuclear Regulatory Commission, says the agency is allowing resident NRC inspectors at the facility to handle the issue.\n', 'Label_11': 'no', 'Premise_12': 'Acosta’s assessment came while complaining the Trump administration was not taking certain issues seriously enough. He lamented Kardashian’s meeting wasn’t “a serious thing” to have happen at the White House.\n', 'Hypothesis_12': '1:41 USM hopes to turn oysters into gold\n', 'Label_12': 'yes', 'Premise_13': 'the museum also includes works by fellow painters braque, matisse, mire, degas, renoir, and rousseau collected by picasso during his lifetime.', 'Hypothesis_13': "picasso's favorite painter in his collection was matisse. ", 'Label_13': 'maybe', 'Premise_14': 'The lockdown is safety protocol, police said.\n', 'Hypothesis_14': 'Every paper egg sold will help to fund transformative and life-changing programs and services for individuals living with disabilities. You can also purchase eggs online at www.paperegg.ca and send a personalized Easter Seals Spring eCard to your family and friends.\n', 'Label_14': 'no', 'Premise_15': "also in the crypt are the remains of napoleon's son, brought to france from vienna by hitler in 1940.", 'Hypothesis_15': "napoleon's son's remains were brought to france by hitler in the start of the 1940s.", 'Label_15': 'yes', 'Premise_16': "the weather grew cool enough that they didn't have to stop in the afternoon.", 'Hypothesis_16': 'the weather was 72 degrees.', 'Label_16': 'maybe', 'Premise_17': "oh um i think he's got good intentions but i'm not sure if the way he goes about what he does is really right", 'Hypothesis_17': "he's got no goal in my mind but whatever he's doing, it's clearly working.", 'Label_17': 'no', 'Premise_18': 'Aug 14 (Reuters) - Global Link Communications Holdings Ltd :\n', 'Hypothesis_18': 'He was fined $900 plus $1,050 in court fees and $2,609 in restitution. He was ordered to get a chemical dependency evaluation and follow the recommendations, and was placed on supervised probation for five years.\n', 'Label_18': 'yes', 'Premise_19': 'A 24-year-old man was arrested after he allegedly confessed to intentionally ramming a police vehicle with his car. He told police he did it because he wanted to be arrested. "He told police that he wanted\n', 'Hypothesis_19': "Police believe her brother was the gunman's intended target.\n", 'Label_19': 'maybe', 'Premise_20': 'jean shope expressed her belief that addressing alcohol problems in the emergency department is the failure not just of primary care, but of many systems.', 'Hypothesis_20': 'alcohol related issues have always been dealt with. ', 'Label_20': 'no', 'Premise_21': "changes of nationality have left alsace with a distinctive dialect, architecture, cuisine, and local pride ' the best of both worlds.", 'Hypothesis_21': 'alsace has a distinctive culture to it. ', 'Label_21': 'yes', 'Premise_22': 'the original slaves whom the spanish had released after 1655 became known as  maroons,  from the spanish word cimarr??n (which means  wild  or  untamed ).', 'Hypothesis_22': 'slaves were released and some became respected.', 'Label_22': 'maybe', 'Premise_23': 'Mark Grant and Don Orsillo send their thoughts and prayers to Ted Leitner\n', 'Hypothesis_23': 'https://vigilance.fr/vulnerability/...\n', 'Label_23': 'no'}
['Premise: {}\nHypothesis: {}\nPrediction: {}']
{0: ['yes'], 1: ['maybe'], 2: ['no']}
./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-1-shot-8/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7fd6d18ab280>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.33
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 0      |
| Number of failed attacks:     | 556    |
| Number of skipped attacks:    | 444    |
| Original accuracy:            | 55.6   |
| Accuracy under attack:        | 55.6   |
| Attack success rate:          | 0.0    |
| Average perturbed word %:     | nan    |
| Average num. words per input: | 946.54 |
| Avg num queries:              | 1.0    |
| Adv confidence:               | nan    |
+-------------------------------+--------+
Attack time: 1922.83682513237
Attack time: 1922.83682513237
