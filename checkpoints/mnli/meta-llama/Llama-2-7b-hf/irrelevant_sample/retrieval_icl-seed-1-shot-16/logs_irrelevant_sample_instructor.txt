1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=2, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/retrieval_icl-seed-1-shot-16_instructor', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='instructor', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/retrieval_icl-seed-1-shot-16_instructor
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=2, beta=1.0, cache_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/retrieval_icl-seed-1-shot-16_instructor/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/retrieval_icl-seed-1-shot-16_instructor', model_id='0', model_type='retrieval_icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, ralm_save_path='./data/ralm/mnli_instructor_ood.pkl', replace_ratio=0.1, retrieve_method='instructor', sampled_num=1, save_icl_examples_path=None, seed=1, shot=16, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
Finished loading ood dataset
{'premise': 'how about if it was uh a seventeen and a half year old with a a list and all uh of  what do they call it uh criminal as long as your armed over the history of a violent crime', 'hypothesis': 'i think that they should be tried as adults. ', 'label': 1, 'idx': 362024}
Finished replacing ood dataset
{'premise': 'how about if it was uh a seventeen and a half year old with a a list and all uh of  what do they call it uh criminal as long as your armed over the history of a violent crime', 'hypothesis': 'i think that they should be tried as adults. ', 'label': 1, 'idx': 362024}
load INSTRUCTOR_Transformer
max_seq_length  512
Length of anchor subsample 48
Length of icl examples 3
Finished loading model
Loading retrieved examples from ./data/ralm/mnli_instructor_ood.pkl
ICL examples
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': 'perhaps rightfully so.', 'Hypothesis_0': 'perhaps with right.', 'Label_0': 'yes', 'Premise_1': '15 consequently, the number of new accesses', 'Hypothesis_1': 'there are new accesses now.', 'Label_1': 'yes', 'Premise_2': "it's pretty nice", 'Hypothesis_2': "it's nice. ", 'Label_2': 'yes', 'Premise_3': 'Twitter\n', 'Hypothesis_3': 'What’s New:\n', 'Label_3': 'no', 'Premise_4': "it's nice to have", 'Hypothesis_4': 'it is nice to be in possession of.', 'Label_4': 'yes', 'Premise_5': 'unconstitutional?', 'Hypothesis_5': 'there was a new amendment proposed.', 'Label_5': 'maybe', 'Premise_6': "yeah that's right it's kind of nice too to have that fall", 'Hypothesis_6': "it's kind of nice too", 'Label_6': 'yes', 'Premise_7': 'how lovely.', 'Hypothesis_7': 'it is nice.', 'Label_7': 'yes', 'Premise_8': "so it's uh yeah it's uh pretty nice", 'Hypothesis_8': "it's pretty nice.", 'Label_8': 'yes', 'Premise_9': 'The Ontario Provincial Police’s Marine Unit of the Georgian Bay Detachment stopped several vessels recently where operators had no life jackets or any other safety equipment aboard.\n', 'Hypothesis_9': 'The Latest:\n', 'Label_9': 'maybe', 'Premise_10': 'Stand-up by Aisha Brown, Nick Beaton, Jackie Pirico, Nitish Sakhuja & more helps launch Hunter Collins’s new sketch comedy album Nincom2oop. 7:30 pm. Pwyc.\n', 'Hypothesis_10': 'The Latest:\n', 'Label_10': 'yes', 'Premise_11': 'Dallam\n', 'Hypothesis_11': 'The Latest:\n', 'Label_11': 'no', 'Premise_12': 'Needless to say, there’s a lot that was wrong with this car:\n', 'Hypothesis_12': 'The Latest:\n', 'Label_12': 'maybe', 'Premise_13': 'A composite image of Bella was shared by millions of people on social media after her body was found on Deer Island in June 2015.\n', 'Hypothesis_13': 'The Latest:\n', 'Label_13': 'no', 'Premise_14': 'In a Facebook post, SCDF said it was alerted to the incident at about 9.20am.\n', 'Hypothesis_14': 'The Latest:\n', 'Label_14': 'maybe', 'Premise_15': "Travelers looking to avoid Tropical Storm Nate may find it's not yet so easy to change plans.\n", 'Hypothesis_15': 'The Latest:\n', 'Label_15': 'yes', 'Premise_16': 'Second Period_3, New Jersey, Palmieri 20 (Zajac, Hall), 10:31 (pp). Penalties_Anaheim bench, served by Perry (too many men on the ice), 9:57; Vatanen, NJ, (hooking), 12:30.\n', 'Hypothesis_16': 'The Latest:\n', 'Label_16': 'maybe', 'Premise_17': 'Copyright © 2018 The Washington Times, LLC.\n', 'Hypothesis_17': 'The Latest:\n', 'Label_17': 'maybe', 'Premise_18': 'Idle Muse Theatre Company announces casting the Chicago premiere of The Scullery Maid written by playwright Joseph Zettelmaier . The cast features Lydia Hiller as MIriam, Dave Skvarla as King Edward III, Anne Marie Lewis as Bess, Leslie Hull as Dulcie, and George Ellison as Pascal.\n', 'Hypothesis_18': 'The Latest:\n', 'Label_18': 'no', 'Premise_19': 'The view of Tathra from a helicopter shows a clear picture of just how chaotic the loss of property was, with embers having travelled well ahead of the fire front to destroy houses throughout the town, seemingly at random.\n', 'Hypothesis_19': 'The Latest:\n', 'Label_19': 'yes', 'Premise_20': 'Dailor also credited Atlanta fans for the band\'s 18 years of success. "Our first show had hundreds of people," he added, "and they came out to support us from the time we were playing the Parasite House to the Fox Theatre."\n', 'Hypothesis_20': 'The Latest:\n', 'Label_20': 'no', 'Premise_21': 'The Cincinnati-based supermarket retailer chain didn’t name specific titles.\n', 'Hypothesis_21': 'The Latest:\n', 'Label_21': 'maybe', 'Premise_22': 'She said every single delay had a real effect on students‚ on their ability to access accommodation and food‚ books and ultimately on their ability to succeed.\n', 'Hypothesis_22': 'The Latest:\n', 'Label_22': 'no', 'Premise_23': 'privacy right', 'Hypothesis_23': 'privacy is a right.', 'Label_23': 'maybe', 'Premise_24': '[y]ou can give people all the rights you want, but if they have no way to enforce those rights, those rights are meaningless.', 'Hypothesis_24': 'rights should be given to people along with the means to enforce them.', 'Label_24': 'maybe', 'Premise_25': ' federal communications  access to telecommunications equipment and services by persons with disabilities', 'Hypothesis_25': 'the change in accessibility was implemented recently.', 'Label_25': 'maybe', 'Premise_26': "that's ok.", 'Hypothesis_26': 'that is permissible.', 'Label_26': 'yes', 'Premise_27': "and to actually sit so it's really nice to see that", 'Hypothesis_27': 'that is nice to see.', 'Label_27': 'yes', 'Premise_28': 'Check out all of the athletes headed to PyeongChang 2018, in our Team Canada roster.\n', 'Hypothesis_28': 'The new features are:\n', 'Label_28': 'no', 'Premise_29': "they don't make casts like that any more.", 'Hypothesis_29': 'the new casts have some benefits.', 'Label_29': 'maybe', 'Premise_30': 'that is correct', 'Hypothesis_30': "that's right. ", 'Label_30': 'yes', 'Premise_31': 'but so many of the cases we handle have to do with basic rights and a decent life.', 'Hypothesis_31': 'many of the cases involve basic rights.', 'Label_31': 'yes', 'Premise_32': "oh that's really nice", 'Hypothesis_32': "that's really nice.", 'Label_32': 'yes', 'Premise_33': 'perhaps rightfully so.', 'Hypothesis_33': 'maybe rightfully so.', 'Label_33': 'yes', 'Premise_34': 'qualitative data  a sourcebook of new methods.', 'Hypothesis_34': 'new methods have been created.', 'Label_34': 'yes', 'Premise_35': "oh is that right that's wonderful", 'Hypothesis_35': "really? that's nice.", 'Label_35': 'yes', 'Premise_36': 'so convenient a thing it is to be a reasonable creature, since it enables one to find or make a reason for everything one has a mind to do.', 'Hypothesis_36': "it's convenient to be reasonable.", 'Label_36': 'yes', 'Premise_37': 'praise goes to its new emphasis on convenience--many recipes require just 20 minutes--and its inclusion of such ethnic dishes as tapas and asian noodles.', 'Hypothesis_37': "it's nice that convenience is emphasized.", 'Label_37': 'yes', 'Premise_38': "yeah they're they're lean-to's they're um yeah they're pretty nice they're they're uh", 'Hypothesis_38': "they're pretty nice yes.", 'Label_38': 'yes', 'Premise_39': 'wallace laid out in flamboyant and often witty form much of what would soon become the program of the new right.', 'Hypothesis_39': 'the new right had a program which was based on the contributions of wallace.', 'Label_39': 'yes', 'Premise_40': 'are you my oh how nice', 'Hypothesis_40': "that's rather pleasant.", 'Label_40': 'yes', 'Premise_41': 'The full list of NEDRA record holders is available here.\n', 'Hypothesis_41': 'New strategy :\n', 'Label_41': 'maybe', 'Premise_42': 'Sponsored by: Lily Frost & Aporia Records\n', 'Hypothesis_42': 'New strategy :\n', 'Label_42': 'maybe', 'Premise_43': 'Shoureshi was named the university’s new president in May. He replaced Wim Wiewel, who had been president since 2008, but announced his intention to step away from the job last summer.\n', 'Hypothesis_43': 'New strategy :\n', 'Label_43': 'no', 'Premise_44': 'Meghan is the only royal to be named on the list, beating the likes of Kate Middleton, 36, and even the Queen, 91.\n', 'Hypothesis_44': 'New strategy :\n', 'Label_44': 'maybe', 'Premise_45': "isn't this amazing?", 'Hypothesis_45': "isn't this great?", 'Label_45': 'maybe', 'Premise_46': "so how about you oh that's good", 'Hypothesis_46': 'that is nice to hear.', 'Label_46': 'yes', 'Premise_47': "oh okay so it's just another job uh it must be especially frustrating because even your rights in there  are", 'Hypothesis_47': 'your rights are not in there, so that makes it easy. ', 'Label_47': 'no'}
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': 'perhaps rightfully so.', 'Hypothesis_0': 'perhaps with right.', 'Label_0': 'yes', 'Premise_1': '15 consequently, the number of new accesses', 'Hypothesis_1': 'there are new accesses now.', 'Label_1': 'yes', 'Premise_2': "it's pretty nice", 'Hypothesis_2': "it's nice. ", 'Label_2': 'yes', 'Premise_3': 'Twitter\n', 'Hypothesis_3': 'What’s New:\n', 'Label_3': 'no', 'Premise_4': "it's nice to have", 'Hypothesis_4': 'it is nice to be in possession of.', 'Label_4': 'yes', 'Premise_5': 'unconstitutional?', 'Hypothesis_5': 'there was a new amendment proposed.', 'Label_5': 'maybe', 'Premise_6': "yeah that's right it's kind of nice too to have that fall", 'Hypothesis_6': "it's kind of nice too", 'Label_6': 'yes', 'Premise_7': 'how lovely.', 'Hypothesis_7': 'it is nice.', 'Label_7': 'yes', 'Premise_8': "so it's uh yeah it's uh pretty nice", 'Hypothesis_8': "it's pretty nice.", 'Label_8': 'yes', 'Premise_9': 'The Ontario Provincial Police’s Marine Unit of the Georgian Bay Detachment stopped several vessels recently where operators had no life jackets or any other safety equipment aboard.\n', 'Hypothesis_9': 'The Latest:\n', 'Label_9': 'maybe', 'Premise_10': 'Stand-up by Aisha Brown, Nick Beaton, Jackie Pirico, Nitish Sakhuja & more helps launch Hunter Collins’s new sketch comedy album Nincom2oop. 7:30 pm. Pwyc.\n', 'Hypothesis_10': 'The Latest:\n', 'Label_10': 'yes', 'Premise_11': 'Dallam\n', 'Hypothesis_11': 'The Latest:\n', 'Label_11': 'no', 'Premise_12': 'Needless to say, there’s a lot that was wrong with this car:\n', 'Hypothesis_12': 'The Latest:\n', 'Label_12': 'maybe', 'Premise_13': 'A composite image of Bella was shared by millions of people on social media after her body was found on Deer Island in June 2015.\n', 'Hypothesis_13': 'The Latest:\n', 'Label_13': 'no', 'Premise_14': 'In a Facebook post, SCDF said it was alerted to the incident at about 9.20am.\n', 'Hypothesis_14': 'The Latest:\n', 'Label_14': 'maybe', 'Premise_15': "Travelers looking to avoid Tropical Storm Nate may find it's not yet so easy to change plans.\n", 'Hypothesis_15': 'The Latest:\n', 'Label_15': 'yes', 'Premise_16': 'Second Period_3, New Jersey, Palmieri 20 (Zajac, Hall), 10:31 (pp). Penalties_Anaheim bench, served by Perry (too many men on the ice), 9:57; Vatanen, NJ, (hooking), 12:30.\n', 'Hypothesis_16': 'The Latest:\n', 'Label_16': 'maybe', 'Premise_17': 'Copyright © 2018 The Washington Times, LLC.\n', 'Hypothesis_17': 'The Latest:\n', 'Label_17': 'maybe', 'Premise_18': 'Idle Muse Theatre Company announces casting the Chicago premiere of The Scullery Maid written by playwright Joseph Zettelmaier . The cast features Lydia Hiller as MIriam, Dave Skvarla as King Edward III, Anne Marie Lewis as Bess, Leslie Hull as Dulcie, and George Ellison as Pascal.\n', 'Hypothesis_18': 'The Latest:\n', 'Label_18': 'no', 'Premise_19': 'The view of Tathra from a helicopter shows a clear picture of just how chaotic the loss of property was, with embers having travelled well ahead of the fire front to destroy houses throughout the town, seemingly at random.\n', 'Hypothesis_19': 'The Latest:\n', 'Label_19': 'yes', 'Premise_20': 'Dailor also credited Atlanta fans for the band\'s 18 years of success. "Our first show had hundreds of people," he added, "and they came out to support us from the time we were playing the Parasite House to the Fox Theatre."\n', 'Hypothesis_20': 'The Latest:\n', 'Label_20': 'no', 'Premise_21': 'The Cincinnati-based supermarket retailer chain didn’t name specific titles.\n', 'Hypothesis_21': 'The Latest:\n', 'Label_21': 'maybe', 'Premise_22': 'She said every single delay had a real effect on students‚ on their ability to access accommodation and food‚ books and ultimately on their ability to succeed.\n', 'Hypothesis_22': 'The Latest:\n', 'Label_22': 'no', 'Premise_23': 'privacy right', 'Hypothesis_23': 'privacy is a right.', 'Label_23': 'maybe', 'Premise_24': '[y]ou can give people all the rights you want, but if they have no way to enforce those rights, those rights are meaningless.', 'Hypothesis_24': 'rights should be given to people along with the means to enforce them.', 'Label_24': 'maybe', 'Premise_25': ' federal communications  access to telecommunications equipment and services by persons with disabilities', 'Hypothesis_25': 'the change in accessibility was implemented recently.', 'Label_25': 'maybe', 'Premise_26': "that's ok.", 'Hypothesis_26': 'that is permissible.', 'Label_26': 'yes', 'Premise_27': "and to actually sit so it's really nice to see that", 'Hypothesis_27': 'that is nice to see.', 'Label_27': 'yes', 'Premise_28': 'Check out all of the athletes headed to PyeongChang 2018, in our Team Canada roster.\n', 'Hypothesis_28': 'The new features are:\n', 'Label_28': 'no', 'Premise_29': "they don't make casts like that any more.", 'Hypothesis_29': 'the new casts have some benefits.', 'Label_29': 'maybe', 'Premise_30': 'that is correct', 'Hypothesis_30': "that's right. ", 'Label_30': 'yes', 'Premise_31': 'but so many of the cases we handle have to do with basic rights and a decent life.', 'Hypothesis_31': 'many of the cases involve basic rights.', 'Label_31': 'yes', 'Premise_32': "oh that's really nice", 'Hypothesis_32': "that's really nice.", 'Label_32': 'yes', 'Premise_33': 'perhaps rightfully so.', 'Hypothesis_33': 'maybe rightfully so.', 'Label_33': 'yes', 'Premise_34': 'qualitative data  a sourcebook of new methods.', 'Hypothesis_34': 'new methods have been created.', 'Label_34': 'yes', 'Premise_35': "oh is that right that's wonderful", 'Hypothesis_35': "really? that's nice.", 'Label_35': 'yes', 'Premise_36': 'so convenient a thing it is to be a reasonable creature, since it enables one to find or make a reason for everything one has a mind to do.', 'Hypothesis_36': "it's convenient to be reasonable.", 'Label_36': 'yes', 'Premise_37': 'praise goes to its new emphasis on convenience--many recipes require just 20 minutes--and its inclusion of such ethnic dishes as tapas and asian noodles.', 'Hypothesis_37': "it's nice that convenience is emphasized.", 'Label_37': 'yes', 'Premise_38': "yeah they're they're lean-to's they're um yeah they're pretty nice they're they're uh", 'Hypothesis_38': "they're pretty nice yes.", 'Label_38': 'yes', 'Premise_39': 'wallace laid out in flamboyant and often witty form much of what would soon become the program of the new right.', 'Hypothesis_39': 'the new right had a program which was based on the contributions of wallace.', 'Label_39': 'yes', 'Premise_40': 'are you my oh how nice', 'Hypothesis_40': "that's rather pleasant.", 'Label_40': 'yes', 'Premise_41': 'The full list of NEDRA record holders is available here.\n', 'Hypothesis_41': 'New strategy :\n', 'Label_41': 'maybe', 'Premise_42': 'Sponsored by: Lily Frost & Aporia Records\n', 'Hypothesis_42': 'New strategy :\n', 'Label_42': 'maybe', 'Premise_43': 'Shoureshi was named the university’s new president in May. He replaced Wim Wiewel, who had been president since 2008, but announced his intention to step away from the job last summer.\n', 'Hypothesis_43': 'New strategy :\n', 'Label_43': 'no', 'Premise_44': 'Meghan is the only royal to be named on the list, beating the likes of Kate Middleton, 36, and even the Queen, 91.\n', 'Hypothesis_44': 'New strategy :\n', 'Label_44': 'maybe', 'Premise_45': "isn't this amazing?", 'Hypothesis_45': "isn't this great?", 'Label_45': 'maybe', 'Premise_46': "so how about you oh that's good", 'Hypothesis_46': 'that is nice to hear.', 'Label_46': 'yes', 'Premise_47': "oh okay so it's just another job uh it must be especially frustrating because even your rights in there  are", 'Hypothesis_47': 'your rights are not in there, so that makes it easy. ', 'Label_47': 'no'}
['Premise: {}\nHypothesis: {}\nPrediction: {}']
{0: ['yes'], 1: ['maybe'], 2: ['no']}
./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/retrieval_icl-seed-1-shot-16_instructor/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7ff5c92704f0>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.33
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 


+-------------------------------+---------+
| Attack Results                |         |
+-------------------------------+---------+
| Number of successful attacks: | 0       |
| Number of failed attacks:     | 545     |
| Number of skipped attacks:    | 455     |
| Original accuracy:            | 54.5    |
| Accuracy under attack:        | 54.5    |
| Attack success rate:          | 0.0     |
| Average perturbed word %:     | nan     |
| Average num. words per input: | 1344.12 |
| Avg num queries:              | 1.0     |
| Adv confidence:               | nan     |
+-------------------------------+---------+
Attack time: 3552.8786447048187
Attack time: 3552.8786447048187
