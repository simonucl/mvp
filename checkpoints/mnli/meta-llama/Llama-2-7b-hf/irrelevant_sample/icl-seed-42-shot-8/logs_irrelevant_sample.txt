1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=4, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-8', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=42, shot=8, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-8
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=4, beta=1.0, cache_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-8/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-8', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=42, shot=8, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
Finished loading ood dataset
{'premise': 'how about if it was uh a seventeen and a half year old with a a list and all uh of  what do they call it uh criminal as long as your armed over the history of a violent crime', 'hypothesis': 'i think that they should be tried as adults. ', 'label': 1, 'idx': 362024}
Finished replacing ood dataset
{'premise': 'It wasn’t immediately known whether Lane has an attorney.\n', 'hypothesis': 'The Snowy Owl Theater, a 240-seat energy efficient venue, outside Leavenworth. It was brainchild of two very different people, Harriet Bullitt, environmentalist and progressive from the family that founded King Broadcasting, and Wilfred Woods, longtime publisher of the Wenatchee World, Republican donor, and champion of dams on the Columbia River.\n', 'label': 1, 'idx': 362024}
Length of anchor subsample 0
Length of icl examples 3
Finished loading model
ICL examples
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': 'Trend : Near term up\n', 'Hypothesis_0': 'Geraldine also writes of improving her technique, while photographing this boat, the Arctic. ‘There has always been such a glare of snow with nothing to relieve that it gave no definition when photographed, and made a poor negative. I tried it under every condition of light, and finally found by stopping my lens very low and taking the photo when the afternoon sun was very bright, throwing strong shadows that I succeeded in getting a fine negative’\n', 'Label_0': 'yes', 'Premise_1': 'oh you do have to make reservations there', 'Hypothesis_1': 'you have to make reservations at the hotel.', 'Label_1': 'maybe', 'Premise_2': 'teaching here is conducted in both chinese and english.', 'Hypothesis_2': 'the teaching is done in french and taiwanese. ', 'Label_2': 'no', 'Premise_3': 'lentauw finished ninth despite being chased into a cornfield by dogs.', 'Hypothesis_3': 'lentauw was chased by dogs and still finished ninth.', 'Label_3': 'yes', 'Premise_4': 'accordingly, he wished them goodbye, and they left the hotel.', 'Hypothesis_4': 'accordingly, he hugged them and led the out of the hotel.', 'Label_4': 'maybe', 'Premise_5': 'others who have signed up for pk have subsequently turned up on republican mailing lists.', 'Hypothesis_5': 'no one signed up for pk and the republican lists.', 'Label_5': 'no', 'Premise_6': 'she was unable to chew gum while the braces were on, so now she is going cow wild, so to speak.', 'Hypothesis_6': 'she had braces on in the past.', 'Label_6': 'yes', 'Premise_7': 'Here is a chronological look back to when it happened and how it got to this point.\n', 'Hypothesis_7': 'PHOTOS: Check out the latest pics of Nicole Kidman\n', 'Label_7': 'maybe', 'Premise_8': 'other people get this.', 'Hypothesis_8': 'nobody knew what they were saying', 'Label_8': 'no', 'Premise_9': "doing so for all rules, they said, could overwhelm the agencies' systems; may be unnecessary for some relatively uncontroversial rules; and may be a less effective use of the agency's resources than more traditional methods (e.g.", 'Hypothesis_9': "the thing that more traditional methods may be a more effective use of the agency's resources.", 'Label_9': 'yes', 'Premise_10': 'Former WWE Cruiserweight Champion and CWC competitor Tajiri will be making his full-time return to WWE this week on Tuesday’s episode of 205 Live.\n', 'Hypothesis_10': 'The problem with being raised in a liberal family in a liberal city (“the People’s Republic of Santa Monica”) and attending a liberal high school is that when you systematically rebel against everyone and everything you perceive as “liberal,” good or bad, you may end up as an adviser to President Donald Trump, defending his most ridiculous claims and saying things like this:\n', 'Label_10': 'maybe', 'Premise_11': 'Thank you\n', 'Hypothesis_11': 'NJ Transit tweets the alert was canceled after the child was found. His condition is not known.\n', 'Label_11': 'no', 'Premise_12': 'most pubs also serve food they are good places to have lunch and some have dining rooms.', 'Hypothesis_12': 'some pubs have dining rooms, and they are good places to have lunch in.', 'Label_12': 'yes', 'Premise_13': "how come  i've been kind of um i guess the commercials are getting to me the toyota commercials and i know that a lot of people i've i've known that have had toyotas have been just extremely happy with them that hardly had any problems at all", 'Hypothesis_13': 'i own a honda but i would be open to getting a toyota someday.', 'Label_13': 'maybe', 'Premise_14': 'tel aviv is in many ways the epitome of the new israel dream.', 'Hypothesis_14': 'in a lot of ways, tel aviv is the furthest thing possible from the new israel dream.', 'Label_14': 'no', 'Premise_15': 'June 14 The following bids, mergers, acquisitions and disposals were reported by 2000 GMT on Wednesday:\n', 'Hypothesis_15': 'According to Metro police, the driver was exiting the I-65 northbound ramp to get onto I-440 when they lost control, left the ramp and dropped to I-65 below.\n', 'Label_15': 'yes', 'Premise_16': "i i wouldn't want it i wouldn't want to be one of those people that's being taken care of somehow knowing that this person is doing it to get out of a sentence or or you know because they were bad in some other way", 'Hypothesis_16': 'i would only want to take care of someone if i wanted to. ', 'Label_16': 'maybe', 'Premise_17': 'the amida hall of hasedera houses the image of a seated amida buddha, endowed by minamoto no yoritomo when he was 42 a particularly unlucky age according to popular japanese belief.', 'Hypothesis_17': 'the image of a seated amida buddha is not housed in the amida hall of hasedera.', 'Label_17': 'no', 'Premise_18': 'you should see many of the  grouper, amberjack, red or rock hind, stingrays, atlantic rays, and moray eels.', 'Hypothesis_18': "it's possible to see different types of sea life including stingrays and moray eels.", 'Label_18': 'yes', 'Premise_19': 'Parry’s side now sit just 15 points above the drop zone in midtable ahead of their home clash with Pontblyddyn on Saturday.\n', 'Hypothesis_19': 'Megan Smith, 17, has been missing since Wednesday, January 31, from Newcastle.\n', 'Label_19': 'maybe', 'Premise_20': "perhaps this was a subversive act, the urinal-drain-guard manufacturer inviting us to piss on the united states' failed drug policy.", 'Hypothesis_20': 'the united states is noted for its effective drug policy.', 'Label_20': 'no', 'Premise_21': 'Overnight, the lava was moving fast enough to cover about six football fields an hour, according to U.S. Geological Survey scientist Wendy Stovall.\n', 'Hypothesis_21': 'Act 1998 bill 2018 indicates that new vehicles in Uganda pay import duty of 25%, VAT l8%, infrastructure levy 2% withholding tax 6%, and registration fees while cars above 5 years pay environment levy of 35% to 50% which is too high.\n', 'Label_21': 'yes', 'Premise_22': "ca'daan heard hoof beats approaching.", 'Hypothesis_22': "the hoof beats of demon riders were heard by ca'daan.", 'Label_22': 'maybe', 'Premise_23': "she has ignored mick's please for forgiveness over his affair with brazilian beauty luciana giminez morad, the paper said.", 'Hypothesis_23': "she listened to mick's please for forgiveness over his affair with a brazilian beauty and eventually forgave him, according to the paper.", 'Label_23': 'no'}
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': 'Trend : Near term up\n', 'Hypothesis_0': 'Geraldine also writes of improving her technique, while photographing this boat, the Arctic. ‘There has always been such a glare of snow with nothing to relieve that it gave no definition when photographed, and made a poor negative. I tried it under every condition of light, and finally found by stopping my lens very low and taking the photo when the afternoon sun was very bright, throwing strong shadows that I succeeded in getting a fine negative’\n', 'Label_0': 'yes', 'Premise_1': 'oh you do have to make reservations there', 'Hypothesis_1': 'you have to make reservations at the hotel.', 'Label_1': 'maybe', 'Premise_2': 'teaching here is conducted in both chinese and english.', 'Hypothesis_2': 'the teaching is done in french and taiwanese. ', 'Label_2': 'no', 'Premise_3': 'lentauw finished ninth despite being chased into a cornfield by dogs.', 'Hypothesis_3': 'lentauw was chased by dogs and still finished ninth.', 'Label_3': 'yes', 'Premise_4': 'accordingly, he wished them goodbye, and they left the hotel.', 'Hypothesis_4': 'accordingly, he hugged them and led the out of the hotel.', 'Label_4': 'maybe', 'Premise_5': 'others who have signed up for pk have subsequently turned up on republican mailing lists.', 'Hypothesis_5': 'no one signed up for pk and the republican lists.', 'Label_5': 'no', 'Premise_6': 'she was unable to chew gum while the braces were on, so now she is going cow wild, so to speak.', 'Hypothesis_6': 'she had braces on in the past.', 'Label_6': 'yes', 'Premise_7': 'Here is a chronological look back to when it happened and how it got to this point.\n', 'Hypothesis_7': 'PHOTOS: Check out the latest pics of Nicole Kidman\n', 'Label_7': 'maybe', 'Premise_8': 'other people get this.', 'Hypothesis_8': 'nobody knew what they were saying', 'Label_8': 'no', 'Premise_9': "doing so for all rules, they said, could overwhelm the agencies' systems; may be unnecessary for some relatively uncontroversial rules; and may be a less effective use of the agency's resources than more traditional methods (e.g.", 'Hypothesis_9': "the thing that more traditional methods may be a more effective use of the agency's resources.", 'Label_9': 'yes', 'Premise_10': 'Former WWE Cruiserweight Champion and CWC competitor Tajiri will be making his full-time return to WWE this week on Tuesday’s episode of 205 Live.\n', 'Hypothesis_10': 'The problem with being raised in a liberal family in a liberal city (“the People’s Republic of Santa Monica”) and attending a liberal high school is that when you systematically rebel against everyone and everything you perceive as “liberal,” good or bad, you may end up as an adviser to President Donald Trump, defending his most ridiculous claims and saying things like this:\n', 'Label_10': 'maybe', 'Premise_11': 'Thank you\n', 'Hypothesis_11': 'NJ Transit tweets the alert was canceled after the child was found. His condition is not known.\n', 'Label_11': 'no', 'Premise_12': 'most pubs also serve food they are good places to have lunch and some have dining rooms.', 'Hypothesis_12': 'some pubs have dining rooms, and they are good places to have lunch in.', 'Label_12': 'yes', 'Premise_13': "how come  i've been kind of um i guess the commercials are getting to me the toyota commercials and i know that a lot of people i've i've known that have had toyotas have been just extremely happy with them that hardly had any problems at all", 'Hypothesis_13': 'i own a honda but i would be open to getting a toyota someday.', 'Label_13': 'maybe', 'Premise_14': 'tel aviv is in many ways the epitome of the new israel dream.', 'Hypothesis_14': 'in a lot of ways, tel aviv is the furthest thing possible from the new israel dream.', 'Label_14': 'no', 'Premise_15': 'June 14 The following bids, mergers, acquisitions and disposals were reported by 2000 GMT on Wednesday:\n', 'Hypothesis_15': 'According to Metro police, the driver was exiting the I-65 northbound ramp to get onto I-440 when they lost control, left the ramp and dropped to I-65 below.\n', 'Label_15': 'yes', 'Premise_16': "i i wouldn't want it i wouldn't want to be one of those people that's being taken care of somehow knowing that this person is doing it to get out of a sentence or or you know because they were bad in some other way", 'Hypothesis_16': 'i would only want to take care of someone if i wanted to. ', 'Label_16': 'maybe', 'Premise_17': 'the amida hall of hasedera houses the image of a seated amida buddha, endowed by minamoto no yoritomo when he was 42 a particularly unlucky age according to popular japanese belief.', 'Hypothesis_17': 'the image of a seated amida buddha is not housed in the amida hall of hasedera.', 'Label_17': 'no', 'Premise_18': 'you should see many of the  grouper, amberjack, red or rock hind, stingrays, atlantic rays, and moray eels.', 'Hypothesis_18': "it's possible to see different types of sea life including stingrays and moray eels.", 'Label_18': 'yes', 'Premise_19': 'Parry’s side now sit just 15 points above the drop zone in midtable ahead of their home clash with Pontblyddyn on Saturday.\n', 'Hypothesis_19': 'Megan Smith, 17, has been missing since Wednesday, January 31, from Newcastle.\n', 'Label_19': 'maybe', 'Premise_20': "perhaps this was a subversive act, the urinal-drain-guard manufacturer inviting us to piss on the united states' failed drug policy.", 'Hypothesis_20': 'the united states is noted for its effective drug policy.', 'Label_20': 'no', 'Premise_21': 'Overnight, the lava was moving fast enough to cover about six football fields an hour, according to U.S. Geological Survey scientist Wendy Stovall.\n', 'Hypothesis_21': 'Act 1998 bill 2018 indicates that new vehicles in Uganda pay import duty of 25%, VAT l8%, infrastructure levy 2% withholding tax 6%, and registration fees while cars above 5 years pay environment levy of 35% to 50% which is too high.\n', 'Label_21': 'yes', 'Premise_22': "ca'daan heard hoof beats approaching.", 'Hypothesis_22': "the hoof beats of demon riders were heard by ca'daan.", 'Label_22': 'maybe', 'Premise_23': "she has ignored mick's please for forgiveness over his affair with brazilian beauty luciana giminez morad, the paper said.", 'Hypothesis_23': "she listened to mick's please for forgiveness over his affair with a brazilian beauty and eventually forgave him, according to the paper.", 'Label_23': 'no'}
['Premise: {}\nHypothesis: {}\nPrediction: {}']
{0: ['yes'], 1: ['maybe'], 2: ['no']}
./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-8/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7f8dcf874760>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.33
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 0      |
| Number of failed attacks:     | 540    |
| Number of skipped attacks:    | 460    |
| Original accuracy:            | 54.0   |
| Accuracy under attack:        | 54.0   |
| Attack success rate:          | 0.0    |
| Average perturbed word %:     | nan    |
| Average num. words per input: | 947.54 |
| Avg num queries:              | 1.0    |
| Adv confidence:               | nan    |
+-------------------------------+--------+
Attack time: 1833.6252694129944
Attack time: 1833.6252694129944
