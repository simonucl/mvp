1
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=8, beta=1.0, checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-2', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=42, shot=2, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
meta-llama/Llama-2-7b-hf
Model Directory: ./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-2
1 Physical GPUs, 1 Logical GPUs
Namespace(adv_augment=0, alpha=None, attack_name='irrelevant_sample', batch_size=8, beta=1.0, cache_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-2/cache', checkpoint_interval=1000, config_file=None, data_dir='./data', dataset='mnli', dataset_path=None, ensemble_num=1, epsilon=1.0, examples_per_label=1, fix_dist=False, is_quantized=False, knn_T=None, knn_k=None, knn_model='bert-base-uncased', local_rank=0, local_world_size=1, lr=1e-05, mask_augment=False, mask_prob=0.15, mask_ratio=0.3, max_length=1024, max_percent_words=0.33, mode='attack', model='meta-llama/Llama-2-7b-hf', model_dir='./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-2', model_id='0', model_type='icl', norm='l2', num_epochs=20, num_examples=1000, num_iter=1, num_labels=3, num_template=-1, path='None', patience=10, pool_label_words='max', pool_templates='mean', precision='bfloat16', prompt_num=2, query_budget=-1, replace_ratio=0.1, retrieve_method='sbert', sampled_num=1, save_icl_examples_path=None, seed=42, shot=2, split='test', template_file='configs/templates_mnli.yaml', tindex=0, train_epoch=30, train_size=0.95, val_size=0.05, verbalizer_file='configs/verbalizer_mnli.yaml', weight_decay=0.01)
Finished loading ood dataset
{'premise': 'how about if it was uh a seventeen and a half year old with a a list and all uh of  what do they call it uh criminal as long as your armed over the history of a violent crime', 'hypothesis': 'i think that they should be tried as adults. ', 'label': 1, 'idx': 362024}
Finished replacing ood dataset
{'premise': 'It wasn’t immediately known whether Lane has an attorney.\n', 'hypothesis': 'The Snowy Owl Theater, a 240-seat energy efficient venue, outside Leavenworth. It was brainchild of two very different people, Harriet Bullitt, environmentalist and progressive from the family that founded King Broadcasting, and Wilfred Woods, longtime publisher of the Wenatchee World, Republican donor, and champion of dams on the Columbia River.\n', 'label': 1, 'idx': 362024}
Length of anchor subsample 0
Length of icl examples 3
Finished loading model
ICL examples
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': 'Trend : Near term up\n', 'Hypothesis_0': 'Geraldine also writes of improving her technique, while photographing this boat, the Arctic. ‘There has always been such a glare of snow with nothing to relieve that it gave no definition when photographed, and made a poor negative. I tried it under every condition of light, and finally found by stopping my lens very low and taking the photo when the afternoon sun was very bright, throwing strong shadows that I succeeded in getting a fine negative’\n', 'Label_0': 'yes', 'Premise_1': 'oh you do have to make reservations there', 'Hypothesis_1': 'you have to make reservations at the hotel.', 'Label_1': 'maybe', 'Premise_2': 'teaching here is conducted in both chinese and english.', 'Hypothesis_2': 'the teaching is done in french and taiwanese. ', 'Label_2': 'no', 'Premise_3': 'lentauw finished ninth despite being chased into a cornfield by dogs.', 'Hypothesis_3': 'lentauw was chased by dogs and still finished ninth.', 'Label_3': 'yes', 'Premise_4': 'accordingly, he wished them goodbye, and they left the hotel.', 'Hypothesis_4': 'accordingly, he hugged them and led the out of the hotel.', 'Label_4': 'maybe', 'Premise_5': 'others who have signed up for pk have subsequently turned up on republican mailing lists.', 'Hypothesis_5': 'no one signed up for pk and the republican lists.', 'Label_5': 'no'}
{'premise': 'the new rights are nice enough', 'hypothesis': 'everyone really likes the newest benefits ', 'label': 1, 'idx': 0, 'Premise_0': 'Trend : Near term up\n', 'Hypothesis_0': 'Geraldine also writes of improving her technique, while photographing this boat, the Arctic. ‘There has always been such a glare of snow with nothing to relieve that it gave no definition when photographed, and made a poor negative. I tried it under every condition of light, and finally found by stopping my lens very low and taking the photo when the afternoon sun was very bright, throwing strong shadows that I succeeded in getting a fine negative’\n', 'Label_0': 'yes', 'Premise_1': 'oh you do have to make reservations there', 'Hypothesis_1': 'you have to make reservations at the hotel.', 'Label_1': 'maybe', 'Premise_2': 'teaching here is conducted in both chinese and english.', 'Hypothesis_2': 'the teaching is done in french and taiwanese. ', 'Label_2': 'no', 'Premise_3': 'lentauw finished ninth despite being chased into a cornfield by dogs.', 'Hypothesis_3': 'lentauw was chased by dogs and still finished ninth.', 'Label_3': 'yes', 'Premise_4': 'accordingly, he wished them goodbye, and they left the hotel.', 'Hypothesis_4': 'accordingly, he hugged them and led the out of the hotel.', 'Label_4': 'maybe', 'Premise_5': 'others who have signed up for pk have subsequently turned up on republican mailing lists.', 'Hypothesis_5': 'no one signed up for pk and the republican lists.', 'Label_5': 'no'}
['Premise: {}\nHypothesis: {}\nPrediction: {}']
{0: ['yes'], 1: ['maybe'], 2: ['no']}
./checkpoints/mnli/meta-llama/Llama-2-7b-hf/irrelevant_sample/icl-seed-42-shot-2/irrelevant_sample_log.csv
<textattack.attacker.Attacker object at 0x7f08e08562b0>
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_percent):  0.33
        (compare_against_original):  True
      )
    (1): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.6
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (2): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (3): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (4): RepeatModification
    (5): StopwordModification
    (6): InstructionModification(
        (columns_to_ignore):  ['example_', 'label_']
      )
    (7): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
    (8): InputColumnModification(
        (matching_column_labels):  ['question', 'sentence']
        (columns_to_ignore):  {'question'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 0      |
| Number of failed attacks:     | 465    |
| Number of skipped attacks:    | 535    |
| Original accuracy:            | 46.5   |
| Accuracy under attack:        | 46.5   |
| Attack success rate:          | 0.0    |
| Average perturbed word %:     | nan    |
| Average num. words per input: | 214.54 |
| Avg num queries:              | 1.0    |
| Adv confidence:               | nan    |
+-------------------------------+--------+
Attack time: 128.36717224121094
Attack time: 128.36717224121094
