nohup: ignoring input
1+8+meta-llama/Llama-2-7b-hf+mvp
./checkpoints/rte/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-8
2024-03-14 01:23:04.139316: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-14 01:23:04.220363: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-14 01:23:16.797083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 37631 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:00:04.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:261: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
/mnt/data/robust/lib/python3.8/site-packages/datasets/load.py:756: FutureWarning: The repository for accuracy contains custom code which must be executed to correctly load the metric. You can inspect the repository content at https://raw.githubusercontent.com/huggingface/datasets/2.18.0/metrics/accuracy/accuracy.py
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this metric from the next major release of `datasets`.
  warnings.warn(
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:04<00:04,  4.76s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:05<00:00,  2.50s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:05<00:00,  2.84s/it]
Map:   0%|          | 0/277 [00:00<?, ? examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 277/277 [00:00<00:00, 4464.25 examples/s]
textattack: Unknown if model of class <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'> compatible with goal function <class 'textattack.goal_functions.classification.untargeted_classification.UntargetedClassification'>.
textattack: Logging to CSV at path ./checkpoints/rte/meta-llama/Llama-2-7b-hf/swap_labels/icl_attack-seed-1-shot-8/swap_labels_log.csv
  0% 0/277 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  0% 1/277 [00:01<08:48,  1.91s/it][Succeeded / Failed / Skipped / Total] 0 / 0 / 1 / 1:   0% 1/277 [00:02<10:43,  2.33s/it][Succeeded / Failed / Skipped / Total] 0 / 0 / 1 / 1:   1% 2/277 [00:02<05:41,  1.24s/it][Succeeded / Failed / Skipped / Total] 0 / 0 / 2 / 2:   1% 2/277 [00:02<05:59,  1.31s/it][Succeeded / Failed / Skipped / Total] 0 / 0 / 2 / 2:   1% 3/277 [00:08<12:21,  2.71s/it][Succeeded / Failed / Skipped / Total] 1 / 0 / 2 / 3:   1% 3/277 [00:08<12:34,  2.75s/it][Succeeded / Failed / Skipped / Total] 1 / 0 / 2 / 3:   1% 4/277 [00:13<15:38,  3.44s/it][Succeeded / Failed / Skipped / Total] 2 / 0 / 2 / 4:   1% 4/277 [00:13<15:47,  3.47s/it][Succeeded / Failed / Skipped / Total] 2 / 0 / 2 / 4:   2% 5/277 [00:16<15:06,  3.33s/it][Succeeded / Failed / Skipped / Total] 3 / 0 / 2 / 5:   2% 5/277 [00:16<15:13,  3.36s/it][Succeeded / Failed / Skipped / Total] 3 / 0 / 2 / 5:   2% 6/277 [00:26<20:01,  4.43s/it][Succeeded / Failed / Skipped / Total] 4 / 0 / 2 / 6:   2% 6/277 [00:26<20:07,  4.46s/it][Succeeded / Failed / Skipped / Total] 4 / 0 / 2 / 6:   3% 7/277 [00:36<23:32,  5.23s/it][Succeeded / Failed / Skipped / Total] 5 / 0 / 2 / 7:   3% 7/277 [00:36<23:37,  5.25s/it][Succeeded / Failed / Skipped / Total] 5 / 0 / 2 / 7:   3% 8/277 [00:44<24:52,  5.55s/it][Succeeded / Failed / Skipped / Total] 6 / 0 / 2 / 8:   3% 8/277 [00:44<24:56,  5.56s/it][Succeeded / Failed / Skipped / Total] 6 / 0 / 2 / 8:   3% 9/277 [00:52<25:51,  5.79s/it][Succeeded / Failed / Skipped / Total] 7 / 0 / 2 / 9:   3% 9/277 [00:52<25:55,  5.80s/it][Succeeded / Failed / Skipped / Total] 7 / 0 / 2 / 9:   4% 10/277 [00:52<23:19,  5.24s/it][Succeeded / Failed / Skipped / Total] 7 / 0 / 3 / 10:   4% 10/277 [00:52<23:22,  5.25s/it][Succeeded / Failed / Skipped / Total] 7 / 0 / 3 / 10:   4% 11/277 [01:06<26:45,  6.04s/it][Succeeded / Failed / Skipped / Total] 8 / 0 / 3 / 11:   4% 11/277 [01:06<26:49,  6.05s/it][Succeeded / Failed / Skipped / Total] 8 / 0 / 3 / 11:   4% 12/277 [01:09<25:31,  5.78s/it][Succeeded / Failed / Skipped / Total] 9 / 0 / 3 / 12:   4% 12/277 [01:09<25:33,  5.79s/it][Succeeded / Failed / Skipped / Total] 9 / 0 / 3 / 12:   5% 13/277 [01:19<26:48,  6.09s/it][Succeeded / Failed / Skipped / Total] 10 / 0 / 3 / 13:   5% 13/277 [01:19<26:51,  6.10s/it][Succeeded / Failed / Skipped / Total] 10 / 0 / 3 / 13:   5% 14/277 [01:22<25:43,  5.87s/it][Succeeded / Failed / Skipped / Total] 11 / 0 / 3 / 14:   5% 14/277 [01:22<25:46,  5.88s/it][Succeeded / Failed / Skipped / Total] 11 / 0 / 3 / 14:   5% 15/277 [01:22<24:00,  5.50s/it][Succeeded / Failed / Skipped / Total] 11 / 0 / 4 / 15:   5% 15/277 [01:22<24:02,  5.51s/it][Succeeded / Failed / Skipped / Total] 11 / 0 / 4 / 15:   6% 16/277 [01:36<26:08,  6.01s/it][Succeeded / Failed / Skipped / Total] 12 / 0 / 4 / 16:   6% 16/277 [01:36<26:10,  6.02s/it][Succeeded / Failed / Skipped / Total] 12 / 0 / 4 / 16:   6% 17/277 [01:39<25:15,  5.83s/it][Succeeded / Failed / Skipped / Total] 13 / 0 / 4 / 17:   6% 17/277 [01:39<25:17,  5.84s/it][Succeeded / Failed / Skipped / Total] 13 / 0 / 4 / 17:   6% 18/277 [01:42<24:28,  5.67s/it][Succeeded / Failed / Skipped / Total] 14 / 0 / 4 / 18:   6% 18/277 [01:42<24:30,  5.68s/it][Succeeded / Failed / Skipped / Total] 14 / 0 / 4 / 18:   7% 19/277 [01:53<25:47,  6.00s/it][Succeeded / Failed / Skipped / Total] 15 / 0 / 4 / 19:   7% 19/277 [01:54<25:49,  6.01s/it][Succeeded / Failed / Skipped / Total] 15 / 0 / 4 / 19:   7% 20/277 [01:54<24:28,  5.71s/it][Succeeded / Failed / Skipped / Total] 15 / 0 / 5 / 20:   7% 20/277 [01:54<24:30,  5.72s/it][Succeeded / Failed / Skipped / Total] 15 / 0 / 5 / 20:   8% 21/277 [02:02<24:47,  5.81s/it][Succeeded / Failed / Skipped / Total] 16 / 0 / 5 / 21:   8% 21/277 [02:02<24:49,  5.82s/it][Succeeded / Failed / Skipped / Total] 16 / 0 / 5 / 21:   8% 22/277 [02:12<25:34,  6.02s/it][Succeeded / Failed / Skipped / Total] 17 / 0 / 5 / 22:   8% 22/277 [02:12<25:35,  6.02s/it][Succeeded / Failed / Skipped / Total] 17 / 0 / 5 / 22:   8% 23/277 [02:15<24:55,  5.89s/it][Succeeded / Failed / Skipped / Total] 18 / 0 / 5 / 23:   8% 23/277 [02:15<24:57,  5.89s/it][Succeeded / Failed / Skipped / Total] 18 / 0 / 5 / 23:   9% 24/277 [02:23<25:12,  5.98s/it][Succeeded / Failed / Skipped / Total] 19 / 0 / 5 / 24:   9% 24/277 [02:23<25:14,  5.98s/it][Succeeded / Failed / Skipped / Total] 19 / 0 / 5 / 24:   9% 25/277 [02:29<25:03,  5.97s/it][Succeeded / Failed / Skipped / Total] 20 / 0 / 5 / 25:   9% 25/277 [02:29<25:04,  5.97s/it][Succeeded / Failed / Skipped / Total] 20 / 0 / 5 / 25:   9% 26/277 [02:51<27:40,  6.61s/it][Succeeded / Failed / Skipped / Total] 20 / 1 / 5 / 26:   9% 26/277 [02:52<27:41,  6.62s/it][Succeeded / Failed / Skipped / Total] 20 / 1 / 5 / 26:  10% 27/277 [02:52<26:34,  6.38s/it][Succeeded / Failed / Skipped / Total] 20 / 1 / 6 / 27:  10% 27/277 [02:52<26:36,  6.38s/it][Succeeded / Failed / Skipped / Total] 20 / 1 / 6 / 27:  10% 28/277 [02:59<26:40,  6.43s/it][Succeeded / Failed / Skipped / Total] 21 / 1 / 6 / 28:  10% 28/277 [03:00<26:41,  6.43s/it][Succeeded / Failed / Skipped / Total] 21 / 1 / 6 / 28:  10% 29/277 [03:22<28:54,  6.99s/it][Succeeded / Failed / Skipped / Total] 21 / 2 / 6 / 29:  10% 29/277 [03:22<28:55,  7.00s/it][Succeeded / Failed / Skipped / Total] 21 / 2 / 6 / 29:  11% 30/277 [03:23<27:52,  6.77s/it][Succeeded / Failed / Skipped / Total] 21 / 2 / 7 / 30:  11% 30/277 [03:23<27:53,  6.78s/it][Succeeded / Failed / Skipped / Total] 21 / 2 / 7 / 30:  11% 31/277 [03:35<28:26,  6.94s/it][Succeeded / Failed / Skipped / Total] 22 / 2 / 7 / 31:  11% 31/277 [03:35<28:27,  6.94s/it][Succeeded / Failed / Skipped / Total] 22 / 2 / 7 / 31:  12% 32/277 [03:45<28:45,  7.04s/it][Succeeded / Failed / Skipped / Total] 23 / 2 / 7 / 32:  12% 32/277 [03:45<28:46,  7.05s/it][Succeeded / Failed / Skipped / Total] 23 / 2 / 7 / 32:  12% 33/277 [03:55<29:03,  7.15s/it][Succeeded / Failed / Skipped / Total] 24 / 2 / 7 / 33:  12% 33/277 [03:55<29:04,  7.15s/it][Succeeded / Failed / Skipped / Total] 24 / 2 / 7 / 33:  12% 34/277 [04:11<29:56,  7.39s/it][Succeeded / Failed / Skipped / Total] 25 / 2 / 7 / 34:  12% 34/277 [04:11<29:57,  7.40s/it][Succeeded / Failed / Skipped / Total] 25 / 2 / 7 / 34:  13% 35/277 [04:11<29:00,  7.19s/it][Succeeded / Failed / Skipped / Total] 25 / 2 / 8 / 35:  13% 35/277 [04:11<29:01,  7.20s/it][Succeeded / Failed / Skipped / Total] 25 / 2 / 8 / 35:  13% 36/277 [04:14<28:24,  7.07s/it][Succeeded / Failed / Skipped / Total] 26 / 2 / 8 / 36:  13% 36/277 [04:14<28:25,  7.08s/it][Succeeded / Failed / Skipped / Total] 26 / 2 / 8 / 36:  13% 37/277 [04:20<28:07,  7.03s/it][Succeeded / Failed / Skipped / Total] 27 / 2 / 8 / 37:  13% 37/277 [04:20<28:07,  7.03s/it][Succeeded / Failed / Skipped / Total] 27 / 2 / 8 / 37:  14% 38/277 [04:20<27:17,  6.85s/it][Succeeded / Failed / Skipped / Total] 27 / 2 / 9 / 38:  14% 38/277 [04:20<27:18,  6.86s/it][Succeeded / Failed / Skipped / Total] 27 / 2 / 9 / 38:  14% 39/277 [04:20<26:30,  6.68s/it][Succeeded / Failed / Skipped / Total] 27 / 2 / 10 / 39:  14% 39/277 [04:20<26:31,  6.69s/it][Succeeded / Failed / Skipped / Total] 27 / 2 / 10 / 39:  14% 40/277 [04:32<26:55,  6.81s/it][Succeeded / Failed / Skipped / Total] 28 / 2 / 10 / 40:  14% 40/277 [04:32<26:55,  6.82s/it][Succeeded / Failed / Skipped / Total] 28 / 2 / 10 / 40:  15% 41/277 [04:38<26:40,  6.78s/it][Succeeded / Failed / Skipped / Total] 29 / 2 / 10 / 41:  15% 41/277 [04:38<26:41,  6.78s/it][Succeeded / Failed / Skipped / Total] 29 / 2 / 10 / 41:  15% 42/277 [04:40<26:12,  6.69s/it][Succeeded / Failed / Skipped / Total] 30 / 2 / 10 / 42:  15% 42/277 [04:41<26:12,  6.69s/it][Succeeded / Failed / Skipped / Total] 30 / 2 / 10 / 42:  16% 43/277 [04:44<25:45,  6.61s/it][Succeeded / Failed / Skipped / Total] 31 / 2 / 10 / 43:  16% 43/277 [04:44<25:46,  6.61s/it][Succeeded / Failed / Skipped / Total] 31 / 2 / 10 / 43:  16% 44/277 [04:44<25:05,  6.46s/it][Succeeded / Failed / Skipped / Total] 31 / 2 / 11 / 44:  16% 44/277 [04:44<25:06,  6.46s/it][Succeeded / Failed / Skipped / Total] 31 / 2 / 11 / 44:  16% 45/277 [04:56<25:27,  6.58s/it][Succeeded / Failed / Skipped / Total] 32 / 2 / 11 / 45:  16% 45/277 [04:56<25:28,  6.59s/it][Succeeded / Failed / Skipped / Total] 32 / 2 / 11 / 45:  17% 46/277 [05:13<26:14,  6.81s/it][Succeeded / Failed / Skipped / Total] 33 / 2 / 11 / 46:  17% 46/277 [05:13<26:14,  6.82s/it][Succeeded / Failed / Skipped / Total] 33 / 2 / 11 / 46:  17% 47/277 [05:16<25:48,  6.73s/it][Succeeded / Failed / Skipped / Total] 34 / 2 / 11 / 47:  17% 47/277 [05:16<25:49,  6.74s/it][Succeeded / Failed / Skipped / Total] 34 / 2 / 11 / 47:  17% 48/277 [05:31<26:22,  6.91s/it][Succeeded / Failed / Skipped / Total] 35 / 2 / 11 / 48:  17% 48/277 [05:31<26:23,  6.91s/it][Succeeded / Failed / Skipped / Total] 35 / 2 / 11 / 48:  18% 49/277 [05:54<27:30,  7.24s/it][Succeeded / Failed / Skipped / Total] 35 / 3 / 11 / 49:  18% 49/277 [05:54<27:30,  7.24s/it][Succeeded / Failed / Skipped / Total] 35 / 3 / 11 / 49:  18% 50/277 [05:54<26:51,  7.10s/it][Succeeded / Failed / Skipped / Total] 35 / 3 / 12 / 50:  18% 50/277 [05:55<26:52,  7.10s/it][Succeeded / Failed / Skipped / Total] 35 / 3 / 12 / 50:  18% 51/277 [06:08<27:14,  7.23s/it][Succeeded / Failed / Skipped / Total] 36 / 3 / 12 / 51:  18% 51/277 [06:08<27:14,  7.23s/it][Succeeded / Failed / Skipped / Total] 36 / 3 / 12 / 51:  19% 52/277 [06:09<26:36,  7.10s/it][Succeeded / Failed / Skipped / Total] 36 / 3 / 13 / 52:  19% 52/277 [06:09<26:37,  7.10s/it][Succeeded / Failed / Skipped / Total] 36 / 3 / 13 / 52:  19% 53/277 [06:19<26:42,  7.15s/it][Succeeded / Failed / Skipped / Total] 37 / 3 / 13 / 53:  19% 53/277 [06:19<26:42,  7.15s/it][Succeeded / Failed / Skipped / Total] 37 / 3 / 13 / 53:  19% 54/277 [06:22<26:17,  7.07s/it][Succeeded / Failed / Skipped / Total] 38 / 3 / 13 / 54:  19% 54/277 [06:22<26:18,  7.08s/it][Succeeded / Failed / Skipped / Total] 38 / 3 / 13 / 54:  20% 55/277 [06:22<25:43,  6.95s/it][Succeeded / Failed / Skipped / Total] 38 / 3 / 14 / 55:  20% 55/277 [06:22<25:43,  6.95s/it][Succeeded / Failed / Skipped / Total] 38 / 3 / 14 / 55:  20% 56/277 [06:22<25:09,  6.83s/it][Succeeded / Failed / Skipped / Total] 38 / 3 / 15 / 56:  20% 56/277 [06:22<25:10,  6.83s/it][Succeeded / Failed / Skipped / Total] 38 / 3 / 15 / 56:  21% 57/277 [06:30<25:08,  6.85s/it][Succeeded / Failed / Skipped / Total] 39 / 3 / 15 / 57:  21% 57/277 [06:30<25:08,  6.86s/it][Succeeded / Failed / Skipped / Total] 39 / 3 / 15 / 57:  21% 58/277 [06:38<25:04,  6.87s/it][Succeeded / Failed / Skipped / Total] 40 / 3 / 15 / 58:  21% 58/277 [06:38<25:05,  6.87s/it]/mnt/data/robust/lib/python3.8/multiprocessing/resource_tracker.py:203: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
