nohup: ignoring input
1+8+google/gemma-7b+mvp
./checkpoints/rte/google/gemma-7b/textbugger/icl-seed-1-shot-8
2024-03-14 15:58:42.661835: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-14 15:58:42.742747: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-14 15:58:55.284066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 37631 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:00:05.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:261: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
/mnt/data/robust/lib/python3.8/site-packages/datasets/load.py:756: FutureWarning: The repository for accuracy contains custom code which must be executed to correctly load the metric. You can inspect the repository content at https://raw.githubusercontent.com/huggingface/datasets/2.18.0/metrics/accuracy/accuracy.py
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this metric from the next major release of `datasets`.
  warnings.warn(
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [01:50<05:30, 110.17s/it]Downloading shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [02:59<02:52, 86.21s/it] Downloading shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [04:57<01:40, 100.46s/it]Downloading shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [05:44<00:00, 79.74s/it] Downloading shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [05:44<00:00, 86.25s/it]
The model was loaded with use_flash_attention_2=True, which is deprecated and may be removed in a future release. Please use `attn_implementation="flash_attention_2"` instead.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:02<00:07,  2.52s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:03<00:02,  1.44s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:03<00:01,  1.09s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:04<00:00,  1.19it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:04<00:00,  1.08s/it]
textattack: Unknown if model of class <class 'transformers.models.gemma.modeling_gemma.GemmaForCausalLM'> compatible with goal function <class 'textattack.goal_functions.classification.untargeted_classification.UntargetedClassification'>.
textattack: Logging to CSV at path ./checkpoints/rte/google/gemma-7b/textbugger/icl-seed-1-shot-8/textbugger_log.csv
  0% 0/277 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
  0% 1/277 [00:01<07:49,  1.70s/it][Succeeded / Failed / Skipped / Total] 0 / 0 / 1 / 1:   0% 1/277 [00:02<09:14,  2.01s/it]2024-03-14 16:06:19.729911: I tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:606] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
[Succeeded / Failed / Skipped / Total] 0 / 0 / 1 / 1:   1% 2/277 [00:15<35:34,  7.76s/it][Succeeded / Failed / Skipped / Total] 1 / 0 / 1 / 2:   1% 2/277 [00:15<35:38,  7.77s/it][Succeeded / Failed / Skipped / Total] 1 / 0 / 1 / 2:   1% 3/277 [00:30<46:24, 10.16s/it][Succeeded / Failed / Skipped / Total] 2 / 0 / 1 / 3:   1% 3/277 [00:30<46:27, 10.17s/it][Succeeded / Failed / Skipped / Total] 2 / 0 / 1 / 3:   1% 4/277 [00:30<34:54,  7.67s/it][Succeeded / Failed / Skipped / Total] 2 / 0 / 2 / 4:   1% 4/277 [00:30<34:56,  7.68s/it][Succeeded / Failed / Skipped / Total] 2 / 0 / 2 / 4:   2% 5/277 [00:38<34:46,  7.67s/it][Succeeded / Failed / Skipped / Total] 3 / 0 / 2 / 5:   2% 5/277 [00:38<34:48,  7.68s/it][Succeeded / Failed / Skipped / Total] 3 / 0 / 2 / 5:   2% 6/277 [00:43<32:59,  7.30s/it][Succeeded / Failed / Skipped / Total] 4 / 0 / 2 / 6:   2% 6/277 [00:43<33:00,  7.31s/it][Succeeded / Failed / Skipped / Total] 4 / 0 / 2 / 6:   3% 7/277 [00:54<35:17,  7.84s/it][Succeeded / Failed / Skipped / Total] 5 / 0 / 2 / 7:   3% 7/277 [00:54<35:18,  7.85s/it][Succeeded / Failed / Skipped / Total] 5 / 0 / 2 / 7:   3% 8/277 [01:04<36:13,  8.08s/it][Succeeded / Failed / Skipped / Total] 6 / 0 / 2 / 8:   3% 8/277 [01:04<36:14,  8.08s/it][Succeeded / Failed / Skipped / Total] 6 / 0 / 2 / 8:   3% 9/277 [01:09<34:19,  7.68s/it][Succeeded / Failed / Skipped / Total] 7 / 0 / 2 / 9:   3% 9/277 [01:09<34:20,  7.69s/it][Succeeded / Failed / Skipped / Total] 7 / 0 / 2 / 9:   4% 10/277 [01:14<33:20,  7.49s/it][Succeeded / Failed / Skipped / Total] 8 / 0 / 2 / 10:   4% 10/277 [01:14<33:20,  7.49s/it][Succeeded / Failed / Skipped / Total] 8 / 0 / 2 / 10:   4% 11/277 [01:20<32:37,  7.36s/it][Succeeded / Failed / Skipped / Total] 9 / 0 / 2 / 11:   4% 11/277 [01:20<32:38,  7.36s/it][Succeeded / Failed / Skipped / Total] 9 / 0 / 2 / 11:   4% 12/277 [01:21<29:51,  6.76s/it][Succeeded / Failed / Skipped / Total] 9 / 0 / 3 / 12:   4% 12/277 [01:21<29:52,  6.76s/it][Succeeded / Failed / Skipped / Total] 9 / 0 / 3 / 12:   5% 13/277 [01:26<29:15,  6.65s/it][Succeeded / Failed / Skipped / Total] 10 / 0 / 3 / 13:   5% 13/277 [01:26<29:15,  6.65s/it][Succeeded / Failed / Skipped / Total] 10 / 0 / 3 / 13:   5% 14/277 [01:33<29:12,  6.66s/it][Succeeded / Failed / Skipped / Total] 11 / 0 / 3 / 14:   5% 14/277 [01:33<29:12,  6.66s/it][Succeeded / Failed / Skipped / Total] 11 / 0 / 3 / 14:   5% 15/277 [01:38<28:33,  6.54s/it][Succeeded / Failed / Skipped / Total] 12 / 0 / 3 / 15:   5% 15/277 [01:38<28:34,  6.54s/it][Succeeded / Failed / Skipped / Total] 12 / 0 / 3 / 15:   6% 16/277 [01:38<26:43,  6.14s/it][Succeeded / Failed / Skipped / Total] 12 / 0 / 4 / 16:   6% 16/277 [01:38<26:43,  6.15s/it][Succeeded / Failed / Skipped / Total] 12 / 0 / 4 / 16:   6% 17/277 [01:38<25:06,  5.79s/it][Succeeded / Failed / Skipped / Total] 12 / 0 / 5 / 17:   6% 17/277 [01:38<25:06,  5.79s/it][Succeeded / Failed / Skipped / Total] 12 / 0 / 5 / 17:   6% 18/277 [01:44<25:09,  5.83s/it][Succeeded / Failed / Skipped / Total] 13 / 0 / 5 / 18:   6% 18/277 [01:44<25:09,  5.83s/it][Succeeded / Failed / Skipped / Total] 13 / 0 / 5 / 18:   7% 19/277 [01:51<25:11,  5.86s/it][Succeeded / Failed / Skipped / Total] 14 / 0 / 5 / 19:   7% 19/277 [01:51<25:11,  5.86s/it][Succeeded / Failed / Skipped / Total] 14 / 0 / 5 / 19:   7% 20/277 [02:00<25:42,  6.00s/it][Succeeded / Failed / Skipped / Total] 15 / 0 / 5 / 20:   7% 20/277 [02:00<25:42,  6.00s/it][Succeeded / Failed / Skipped / Total] 15 / 0 / 5 / 20:   8% 21/277 [02:04<25:16,  5.93s/it][Succeeded / Failed / Skipped / Total] 16 / 0 / 5 / 21:   8% 21/277 [02:04<25:17,  5.93s/it][Succeeded / Failed / Skipped / Total] 16 / 0 / 5 / 21:   8% 22/277 [02:54<33:43,  7.93s/it][Succeeded / Failed / Skipped / Total] 17 / 0 / 5 / 22:   8% 22/277 [02:54<33:43,  7.93s/it][Succeeded / Failed / Skipped / Total] 17 / 0 / 5 / 22:   8% 23/277 [05:27<1:00:16, 14.24s/it][Succeeded / Failed / Skipped / Total] 17 / 1 / 5 / 23:   8% 23/277 [05:27<1:00:16, 14.24s/it][Succeeded / Failed / Skipped / Total] 17 / 1 / 5 / 23:   9% 24/277 [05:56<1:02:36, 14.85s/it][Succeeded / Failed / Skipped / Total] 18 / 1 / 5 / 24:   9% 24/277 [05:56<1:02:36, 14.85s/it][Succeeded / Failed / Skipped / Total] 18 / 1 / 5 / 24:   9% 25/277 [05:56<59:53, 14.26s/it]  [Succeeded / Failed / Skipped / Total] 18 / 1 / 6 / 25:   9% 25/277 [05:56<59:54, 14.26s/it][Succeeded / Failed / Skipped / Total] 18 / 1 / 6 / 25:   9% 26/277 [06:30<1:02:52, 15.03s/it][Succeeded / Failed / Skipped / Total] 18 / 2 / 6 / 26:   9% 26/277 [06:30<1:02:52, 15.03s/it][Succeeded / Failed / Skipped / Total] 18 / 2 / 6 / 26:  10% 27/277 [06:35<1:01:04, 14.66s/it][Succeeded / Failed / Skipped / Total] 19 / 2 / 6 / 27:  10% 27/277 [06:35<1:01:04, 14.66s/it][Succeeded / Failed / Skipped / Total] 19 / 2 / 6 / 27:  10% 28/277 [06:49<1:00:37, 14.61s/it][Succeeded / Failed / Skipped / Total] 20 / 2 / 6 / 28:  10% 28/277 [06:49<1:00:37, 14.61s/it][Succeeded / Failed / Skipped / Total] 20 / 2 / 6 / 28:  10% 29/277 [07:39<1:05:32, 15.86s/it][Succeeded / Failed / Skipped / Total] 20 / 3 / 6 / 29:  10% 29/277 [07:39<1:05:32, 15.86s/it][Succeeded / Failed / Skipped / Total] 20 / 3 / 6 / 29:  11% 30/277 [07:40<1:03:07, 15.33s/it][Succeeded / Failed / Skipped / Total] 20 / 3 / 7 / 30:  11% 30/277 [07:40<1:03:07, 15.33s/it][Succeeded / Failed / Skipped / Total] 20 / 3 / 7 / 30:  11% 31/277 [07:40<1:00:51, 14.84s/it][Succeeded / Failed / Skipped / Total] 20 / 3 / 8 / 31:  11% 31/277 [07:40<1:00:52, 14.85s/it][Succeeded / Failed / Skipped / Total] 20 / 3 / 8 / 31:  12% 32/277 [07:53<1:00:21, 14.78s/it][Succeeded / Failed / Skipped / Total] 21 / 3 / 8 / 32:  12% 32/277 [07:53<1:00:21, 14.78s/it][Succeeded / Failed / Skipped / Total] 21 / 3 / 8 / 32:  12% 33/277 [08:09<1:00:22, 14.85s/it][Succeeded / Failed / Skipped / Total] 22 / 3 / 8 / 33:  12% 33/277 [08:09<1:00:22, 14.85s/it][Succeeded / Failed / Skipped / Total] 22 / 3 / 8 / 33:  12% 34/277 [08:55<1:03:44, 15.74s/it][Succeeded / Failed / Skipped / Total] 23 / 3 / 8 / 34:  12% 34/277 [08:55<1:03:44, 15.74s/it][Succeeded / Failed / Skipped / Total] 23 / 3 / 8 / 34:  13% 35/277 [09:00<1:02:15, 15.44s/it][Succeeded / Failed / Skipped / Total] 24 / 3 / 8 / 35:  13% 35/277 [09:00<1:02:15, 15.44s/it][Succeeded / Failed / Skipped / Total] 24 / 3 / 8 / 35:  13% 36/277 [09:00<1:00:17, 15.01s/it][Succeeded / Failed / Skipped / Total] 24 / 3 / 9 / 36:  13% 36/277 [09:00<1:00:18, 15.01s/it]/mnt/data/robust/lib/python3.8/multiprocessing/resource_tracker.py:203: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
