nohup: ignoring input
1+8+meta-llama/Llama-2-7b-hf+mvp
./checkpoints/sst2/meta-llama/Llama-2-7b-hf/textfooler/icl-seed-1-shot-8
./checkpoints/sst2/meta-llama/Llama-2-7b-hf/textfooler/icl-seed-1-shot-8/ablate+textfooler
2023-10-17 17:05:07.718762: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-10-17 17:05:08.448500: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2023-10-17 17:05:14.897210: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-10-17 17:05:14.907028: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-10-17 17:05:14.909424: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-10-17 17:05:14.922720: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-10-17 17:05:14.925098: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-10-17 17:05:14.927452: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-10-17 17:05:15.099248: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-10-17 17:05:15.100823: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-10-17 17:05:15.102221: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-10-17 17:05:15.103614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 79087 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-80GB, pci bus id: 0000:07:00.0, compute capability: 8.0
/mnt/ceph_rbd/mvp/src/utils/funcs.py:162: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Downloading builder script:   0%|          | 0.00/28.8k [00:00<?, ?B/s]Downloading builder script: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 28.8k/28.8k [00:00<00:00, 69.1MB/s]
Downloading metadata:   0%|          | 0.00/28.7k [00:00<?, ?B/s]Downloading metadata: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 28.7k/28.7k [00:00<00:00, 73.3MB/s]
Downloading readme:   0%|          | 0.00/27.9k [00:00<?, ?B/s]Downloading readme: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 27.9k/27.9k [00:00<00:00, 73.2MB/s]
Downloading data:   0%|          | 0.00/7.44M [00:00<?, ?B/s]Downloading data:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 6.80M/7.44M [00:00<00:00, 68.0MB/s]Downloading data: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7.44M/7.44M [00:00<00:00, 70.5MB/s]
Generating train split:   0%|          | 0/67349 [00:00<?, ? examples/s]Generating train split:   5%|â–Œ         | 3470/67349 [00:00<00:01, 34611.16 examples/s]Generating train split:  11%|â–ˆ         | 7331/67349 [00:00<00:01, 36960.08 examples/s]Generating train split:  17%|â–ˆâ–‹        | 11211/67349 [00:00<00:01, 37795.06 examples/s]Generating train split:  22%|â–ˆâ–ˆâ–       | 15040/67349 [00:00<00:01, 37988.71 examples/s]Generating train split:  28%|â–ˆâ–ˆâ–Š       | 18993/67349 [00:00<00:01, 38409.50 examples/s]Generating train split:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 24711/67349 [00:00<00:01, 38277.56 examples/s]Generating train split:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28543/67349 [00:00<00:01, 38287.99 examples/s]Generating train split:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 32405/67349 [00:00<00:00, 38385.13 examples/s]Generating train split:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 36266/67349 [00:00<00:00, 38451.42 examples/s]Generating train split:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 40140/67349 [00:01<00:00, 38534.58 examples/s]Generating train split:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 45962/67349 [00:01<00:00, 38640.05 examples/s]Generating train split:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 49840/67349 [00:01<00:00, 38675.89 examples/s]Generating train split:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 53728/67349 [00:01<00:00, 38731.45 examples/s]Generating train split:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 59506/67349 [00:01<00:00, 38648.18 examples/s]Generating train split:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65281/67349 [00:01<00:00, 38594.00 examples/s]Generating train split: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67349/67349 [00:01<00:00, 38336.69 examples/s]
Generating validation split:   0%|          | 0/872 [00:00<?, ? examples/s]Generating validation split: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 872/872 [00:00<00:00, 35105.52 examples/s]
Generating test split:   0%|          | 0/1821 [00:00<?, ? examples/s]Generating test split: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1821/1821 [00:00<00:00, 37340.21 examples/s]
Map:   0%|          | 0/67349 [00:00<?, ? examples/s]Map:   3%|â–Ž         | 1904/67349 [00:00<00:03, 18915.10 examples/s]Map:   6%|â–Œ         | 3849/67349 [00:00<00:03, 19220.11 examples/s]Map:   9%|â–Š         | 5803/67349 [00:00<00:03, 19362.80 examples/s]Map:  12%|â–ˆâ–        | 7754/67349 [00:00<00:03, 19418.55 examples/s]Map:  14%|â–ˆâ–        | 9697/67349 [00:00<00:02, 19419.02 examples/s]Map:  19%|â–ˆâ–Š        | 12563/67349 [00:00<00:02, 19277.95 examples/s]Map:  22%|â–ˆâ–ˆâ–       | 14504/67349 [00:00<00:02, 19314.73 examples/s]Map:  24%|â–ˆâ–ˆâ–       | 16460/67349 [00:00<00:02, 19383.50 examples/s]Map:  27%|â–ˆâ–ˆâ–‹       | 18434/67349 [00:00<00:02, 19485.67 examples/s]Map:  30%|â–ˆâ–ˆâ–ˆ       | 20405/67349 [00:01<00:02, 19548.42 examples/s]Map:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 22404/67349 [00:01<00:02, 19678.76 examples/s]Map:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 25305/67349 [00:01<00:02, 19543.34 examples/s]Map:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28250/67349 [00:01<00:01, 19572.94 examples/s]Map:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 30241/67349 [00:01<00:01, 19658.14 examples/s]Map:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 33212/67349 [00:01<00:01, 19706.82 examples/s]Map:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 36175/67349 [00:01<00:01, 19719.44 examples/s]Map:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 38157/67349 [00:01<00:01, 19741.84 examples/s]Map:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 41094/67349 [00:02<00:01, 19682.22 examples/s]Map:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 44054/67349 [00:02<00:01, 19693.30 examples/s]Map:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 47001/67349 [00:02<00:01, 19675.07 examples/s]Map:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 49000/67349 [00:02<00:00, 19670.95 examples/s]Map:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 50979/67349 [00:02<00:00, 19698.65 examples/s]Map:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 52976/67349 [00:02<00:00, 19765.70 examples/s]Map:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 55945/67349 [00:02<00:00, 19772.13 examples/s]Map:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 58897/67349 [00:03<00:00, 19737.19 examples/s]Map:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 60883/67349 [00:03<00:00, 19766.05 examples/s]Map:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63819/67349 [00:03<00:00, 19695.87 examples/s]Map:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 66715/67349 [00:03<00:00, 19565.86 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67349/67349 [00:03<00:00, 19572.14 examples/s]
Map:   0%|          | 0/872 [00:00<?, ? examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 872/872 [00:00<00:00, 17823.05 examples/s]
Map:   0%|          | 0/1821 [00:00<?, ? examples/s]Map:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 1763/1821 [00:00<00:00, 17527.51 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1821/1821 [00:00<00:00, 17180.07 examples/s]
Filter:   0%|          | 0/63981 [00:00<?, ? examples/s]Filter:  17%|â–ˆâ–‹        | 11000/63981 [00:00<00:00, 102878.59 examples/s]Filter:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 23000/63981 [00:00<00:00, 104185.31 examples/s]Filter:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35000/63981 [00:00<00:00, 107585.47 examples/s]Filter:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 47000/63981 [00:00<00:00, 109821.42 examples/s]Filter:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59000/63981 [00:00<00:00, 111161.92 examples/s]Filter: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 63981/63981 [00:00<00:00, 109275.16 examples/s]
Filter:   0%|          | 0/3368 [00:00<?, ? examples/s]Filter: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3368/3368 [00:00<00:00, 106410.47 examples/s]
Filter:   0%|          | 0/872 [00:00<?, ? examples/s]Filter: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 872/872 [00:00<00:00, 178611.76 examples/s]
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:03<00:03,  3.41s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:04<00:00,  2.19s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:04<00:00,  2.37s/it]
textattack: Unknown if model of class <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'> compatible with goal function <class 'textattack.goal_functions.classification.untargeted_classification.UntargetedClassification'>.
textattack: Logging to CSV at path None/attack_logs//textfooler_log.csv
  0%|          | 0/100 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
2023-10-17 17:07:06.979447: I tensorflow/core/common_runtime/executor.cc:1197] [/device:CPU:0] (DEBUG INFO) Executor start aborting (this does not indicate an error and you can ignore this message): INVALID_ARGUMENT: You must feed a value for placeholder tensor 'inputs' with dtype string
	 [[{{node inputs}}]]
2023-10-17 17:07:09.358486: I tensorflow/tsl/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2023-10-17 17:07:09.873101: I tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:637] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
  1%|          | 1/100 [00:30<50:02, 30.33s/it][Succeeded / Failed / Skipped / Total] 1 / 0 / 0 / 1:   1%|          | 1/100 [00:30<50:22, 30.53s/it][Succeeded / Failed / Skipped / Total] 1 / 0 / 0 / 1:   2%|â–         | 2/100 [00:31<25:22, 15.54s/it][Succeeded / Failed / Skipped / Total] 1 / 1 / 0 / 2:   2%|â–         | 2/100 [00:31<25:23, 15.54s/it][Succeeded / Failed / Skipped / Total] 1 / 1 / 0 / 2:   3%|â–Ž         | 3/100 [00:35<18:52, 11.68s/it][Succeeded / Failed / Skipped / Total] 1 / 2 / 0 / 3:   3%|â–Ž         | 3/100 [00:35<18:52, 11.68s/it][Succeeded / Failed / Skipped / Total] 1 / 2 / 0 / 3:   4%|â–         | 4/100 [00:37<14:50,  9.27s/it][Succeeded / Failed / Skipped / Total] 1 / 3 / 0 / 4:   4%|â–         | 4/100 [00:37<14:50,  9.27s/it][Succeeded / Failed / Skipped / Total] 1 / 3 / 0 / 4:   5%|â–Œ         | 5/100 [00:37<11:54,  7.52s/it][Succeeded / Failed / Skipped / Total] 1 / 4 / 0 / 5:   5%|â–Œ         | 5/100 [00:37<11:54,  7.52s/it][Succeeded / Failed / Skipped / Total] 1 / 4 / 0 / 5:   6%|â–Œ         | 6/100 [00:39<10:11,  6.51s/it][Succeeded / Failed / Skipped / Total] 2 / 4 / 0 / 6:   6%|â–Œ         | 6/100 [00:39<10:12,  6.51s/it][Succeeded / Failed / Skipped / Total] 2 / 4 / 0 / 6:   7%|â–‹         | 7/100 [00:40<08:55,  5.76s/it][Succeeded / Failed / Skipped / Total] 2 / 5 / 0 / 7:   7%|â–‹         | 7/100 [00:40<08:55,  5.76s/it][Succeeded / Failed / Skipped / Total] 2 / 5 / 0 / 7:   8%|â–Š         | 8/100 [00:42<08:10,  5.33s/it][Succeeded / Failed / Skipped / Total] 2 / 6 / 0 / 8:   8%|â–Š         | 8/100 [00:42<08:10,  5.33s/it][Succeeded / Failed / Skipped / Total] 2 / 6 / 0 / 8:   9%|â–‰         | 9/100 [00:43<07:23,  4.87s/it][Succeeded / Failed / Skipped / Total] 3 / 6 / 0 / 9:   9%|â–‰         | 9/100 [00:43<07:23,  4.87s/it][Succeeded / Failed / Skipped / Total] 3 / 6 / 0 / 9:  10%|â–ˆ         | 10/100 [00:47<07:07,  4.75s/it][Succeeded / Failed / Skipped / Total] 3 / 7 / 0 / 10:  10%|â–ˆ         | 10/100 [00:47<07:07,  4.75s/it][Succeeded / Failed / Skipped / Total] 3 / 7 / 0 / 10:  11%|â–ˆ         | 11/100 [00:49<06:41,  4.51s/it][Succeeded / Failed / Skipped / Total] 4 / 7 / 0 / 11:  11%|â–ˆ         | 11/100 [00:49<06:41,  4.51s/it][Succeeded / Failed / Skipped / Total] 4 / 7 / 0 / 11:  12%|â–ˆâ–        | 12/100 [00:53<06:30,  4.44s/it][Succeeded / Failed / Skipped / Total] 4 / 8 / 0 / 12:  12%|â–ˆâ–        | 12/100 [00:53<06:30,  4.44s/it][Succeeded / Failed / Skipped / Total] 4 / 8 / 0 / 12:  13%|â–ˆâ–Ž        | 13/100 [00:56<06:18,  4.35s/it][Succeeded / Failed / Skipped / Total] 4 / 9 / 0 / 13:  13%|â–ˆâ–Ž        | 13/100 [00:56<06:18,  4.35s/it][Succeeded / Failed / Skipped / Total] 4 / 9 / 0 / 13:  14%|â–ˆâ–        | 14/100 [00:57<05:54,  4.12s/it][Succeeded / Failed / Skipped / Total] 5 / 9 / 0 / 14:  14%|â–ˆâ–        | 14/100 [00:57<05:54,  4.12s/it][Succeeded / Failed / Skipped / Total] 5 / 9 / 0 / 14:  15%|â–ˆâ–Œ        | 15/100 [01:00<05:42,  4.03s/it][Succeeded / Failed / Skipped / Total] 6 / 9 / 0 / 15:  15%|â–ˆâ–Œ        | 15/100 [01:00<05:42,  4.03s/it][Succeeded / Failed / Skipped / Total] 6 / 9 / 0 / 15:  16%|â–ˆâ–Œ        | 16/100 [01:04<05:38,  4.02s/it][Succeeded / Failed / Skipped / Total] 6 / 10 / 0 / 16:  16%|â–ˆâ–Œ        | 16/100 [01:04<05:38,  4.03s/it]