1+8+meta-llama/Llama-2-7b-hf+mvp
./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-8
textattack: Updating TextAttack package dependencies.
textattack: Downloading NLTK required packages.
2024-03-07 01:30:32.208887: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:30:33.009064: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package averaged_perceptron_tagger to
[nltk_data]     /root/nltk_data...
[nltk_data]   Unzipping taggers/averaged_perceptron_tagger.zip.
[nltk_data] Downloading package stopwords to /root/nltk_data...
[nltk_data]   Unzipping corpora/stopwords.zip.
[nltk_data] Downloading package omw to /root/nltk_data...
[nltk_data] Downloading package universal_tagset to /root/nltk_data...
[nltk_data]   Unzipping taggers/universal_tagset.zip.
[nltk_data] Downloading package wordnet to /root/nltk_data...
[nltk_data] Downloading package punkt to /root/nltk_data...
[nltk_data]   Unzipping tokenizers/punkt.zip.
textattack: Downloading https://textattack.s3.amazonaws.com/word_embeddings/paragramcf.
  0%|          | 0.00/481M [00:00<?, ?B/s]  0%|          | 8.19k/481M [00:00<2:07:27, 63.0kB/s]  0%|          | 60.4k/481M [00:00<31:42, 253kB/s]     0%|          | 113k/481M [00:00<24:57, 321kB/s]   0%|          | 147k/481M [00:00<26:31, 302kB/s]  0%|          | 269k/481M [00:00<15:29, 517kB/s]  0%|          | 443k/481M [00:00<10:49, 740kB/s]  0%|          | 635k/481M [00:00<08:53, 902kB/s]  0%|          | 826k/481M [00:01<08:03, 994kB/s]  0%|          | 1.02M/481M [00:01<07:11, 1.11MB/s]  0%|          | 1.23M/481M [00:01<06:12, 1.29MB/s]  0%|          | 1.45M/481M [00:01<05:22, 1.49MB/s]  0%|          | 1.68M/481M [00:01<04:47, 1.67MB/s]  0%|          | 1.92M/481M [00:01<04:33, 1.76MB/s]  0%|          | 2.18M/481M [00:01<04:20, 1.84MB/s]  1%|          | 2.46M/481M [00:01<04:01, 1.98MB/s]  1%|          | 2.74M/481M [00:02<03:50, 2.07MB/s]  1%|          | 3.04M/481M [00:02<03:37, 2.20MB/s]  1%|          | 3.33M/481M [00:02<03:30, 2.27MB/s]  1%|          | 3.66M/481M [00:02<03:20, 2.39MB/s]  1%|          | 4.01M/481M [00:02<03:06, 2.56MB/s]  1%|          | 4.36M/481M [00:02<02:56, 2.70MB/s]  1%|          | 4.74M/481M [00:02<02:48, 2.83MB/s]  1%|          | 5.14M/481M [00:02<02:40, 2.98MB/s]  1%|          | 5.56M/481M [00:03<02:31, 3.15MB/s]  1%|          | 6.00M/481M [00:03<02:22, 3.34MB/s]  1%|▏         | 6.45M/481M [00:03<02:15, 3.52MB/s]  1%|▏         | 6.94M/481M [00:03<02:06, 3.74MB/s]  2%|▏         | 7.44M/481M [00:03<02:02, 3.87MB/s]  2%|▏         | 7.96M/481M [00:03<02:02, 3.86MB/s]  2%|▏         | 8.52M/481M [00:03<01:58, 4.00MB/s]  2%|▏         | 9.11M/481M [00:03<01:51, 4.25MB/s]  2%|▏         | 9.73M/481M [00:04<01:44, 4.49MB/s]  2%|▏         | 10.4M/481M [00:04<01:39, 4.72MB/s]  2%|▏         | 11.0M/481M [00:04<01:38, 4.76MB/s]  2%|▏         | 11.7M/481M [00:04<01:29, 5.23MB/s]  3%|▎         | 12.5M/481M [00:04<01:28, 5.29MB/s]  3%|▎         | 13.2M/481M [00:04<01:19, 5.89MB/s]  3%|▎         | 13.9M/481M [00:04<01:20, 5.77MB/s]  3%|▎         | 14.4M/481M [00:04<01:20, 5.78MB/s]  3%|▎         | 15.4M/481M [00:04<01:08, 6.79MB/s]  3%|▎         | 16.6M/481M [00:05<00:55, 8.42MB/s]  4%|▎         | 17.5M/481M [00:05<00:54, 8.54MB/s]  4%|▍         | 18.8M/481M [00:05<00:49, 9.32MB/s]  4%|▍         | 20.0M/481M [00:05<00:50, 9.06MB/s]  4%|▍         | 21.3M/481M [00:05<00:47, 9.77MB/s]  5%|▍         | 22.5M/481M [00:05<00:44, 10.3MB/s]  5%|▌         | 24.2M/481M [00:05<00:37, 12.1MB/s]  5%|▌         | 25.4M/481M [00:05<00:37, 12.1MB/s]  6%|▌         | 27.2M/481M [00:05<00:32, 13.8MB/s]  6%|▌         | 29.4M/481M [00:06<00:32, 14.0MB/s]  6%|▋         | 31.1M/481M [00:06<00:30, 14.7MB/s]  7%|▋         | 33.4M/481M [00:06<00:26, 16.8MB/s]  7%|▋         | 35.1M/481M [00:06<00:26, 16.7MB/s]  8%|▊         | 36.8M/481M [00:06<00:26, 16.5MB/s]  8%|▊         | 38.5M/481M [00:06<00:27, 16.1MB/s]  8%|▊         | 40.5M/481M [00:06<00:25, 17.2MB/s]  9%|▉         | 42.6M/481M [00:06<00:24, 17.6MB/s]  9%|▉         | 44.9M/481M [00:06<00:23, 18.7MB/s] 10%|▉         | 46.7M/481M [00:07<00:24, 18.1MB/s] 10%|█         | 48.5M/481M [00:07<00:26, 16.4MB/s] 10%|█         | 50.2M/481M [00:07<00:27, 15.6MB/s] 11%|█         | 52.6M/481M [00:07<00:24, 17.9MB/s] 11%|█▏        | 55.2M/481M [00:07<00:22, 19.0MB/s] 12%|█▏        | 57.9M/481M [00:07<00:20, 21.1MB/s] 12%|█▏        | 60.0M/481M [00:07<00:20, 20.7MB/s] 13%|█▎        | 62.1M/481M [00:07<00:20, 20.2MB/s] 13%|█▎        | 64.5M/481M [00:07<00:19, 21.2MB/s] 14%|█▍        | 67.5M/481M [00:08<00:18, 22.8MB/s] 15%|█▍        | 70.4M/481M [00:08<00:16, 24.5MB/s] 15%|█▌        | 73.5M/481M [00:08<00:15, 25.6MB/s] 16%|█▌        | 77.1M/481M [00:08<00:14, 28.7MB/s] 17%|█▋        | 80.0M/481M [00:08<00:14, 28.6MB/s] 17%|█▋        | 82.9M/481M [00:08<00:14, 28.1MB/s] 18%|█▊        | 85.7M/481M [00:08<00:14, 26.5MB/s] 18%|█▊        | 88.4M/481M [00:08<00:15, 26.0MB/s] 19%|█▉        | 91.3M/481M [00:08<00:15, 26.0MB/s] 20%|█▉        | 94.0M/481M [00:09<00:15, 24.7MB/s] 20%|██        | 97.1M/481M [00:09<00:15, 25.0MB/s] 21%|██        | 100M/481M [00:09<00:14, 26.4MB/s]  21%|██▏       | 103M/481M [00:09<00:14, 25.5MB/s] 22%|██▏       | 105M/481M [00:09<00:15, 23.9MB/s] 22%|██▏       | 108M/481M [00:09<00:17, 21.3MB/s] 23%|██▎       | 110M/481M [00:09<00:17, 21.2MB/s] 23%|██▎       | 113M/481M [00:09<00:18, 20.5MB/s] 24%|██▍       | 116M/481M [00:09<00:16, 22.2MB/s] 24%|██▍       | 118M/481M [00:10<00:17, 20.9MB/s] 25%|██▍       | 120M/481M [00:10<00:19, 18.6MB/s] 25%|██▌       | 122M/481M [00:10<00:18, 19.2MB/s] 26%|██▌       | 124M/481M [00:10<00:17, 20.1MB/s] 26%|██▋       | 126M/481M [00:10<00:17, 20.1MB/s] 27%|██▋       | 129M/481M [00:10<00:17, 20.0MB/s] 27%|██▋       | 131M/481M [00:10<00:15, 22.2MB/s] 28%|██▊       | 135M/481M [00:10<00:13, 25.3MB/s] 29%|██▊       | 137M/481M [00:10<00:13, 26.1MB/s] 29%|██▉       | 141M/481M [00:11<00:12, 27.1MB/s] 30%|██▉       | 143M/481M [00:11<00:12, 27.3MB/s] 30%|███       | 146M/481M [00:11<00:11, 28.0MB/s] 31%|███       | 149M/481M [00:11<00:11, 28.6MB/s] 32%|███▏      | 153M/481M [00:11<00:11, 28.8MB/s] 32%|███▏      | 156M/481M [00:11<00:10, 30.4MB/s] 33%|███▎      | 159M/481M [00:11<00:11, 28.9MB/s] 34%|███▍      | 163M/481M [00:11<00:10, 31.1MB/s] 35%|███▍      | 166M/481M [00:11<00:10, 31.1MB/s] 35%|███▌      | 169M/481M [00:12<00:10, 31.2MB/s] 36%|███▌      | 173M/481M [00:12<00:09, 31.5MB/s] 37%|███▋      | 176M/481M [00:12<00:10, 30.5MB/s] 37%|███▋      | 179M/481M [00:12<00:10, 29.9MB/s] 38%|███▊      | 182M/481M [00:12<00:10, 28.5MB/s] 38%|███▊      | 185M/481M [00:12<00:10, 27.1MB/s] 39%|███▉      | 189M/481M [00:12<00:10, 27.6MB/s] 40%|███▉      | 192M/481M [00:12<00:09, 29.6MB/s] 41%|████      | 195M/481M [00:12<00:09, 29.8MB/s] 41%|████      | 198M/481M [00:13<00:09, 29.6MB/s] 42%|████▏     | 201M/481M [00:13<00:09, 30.0MB/s] 43%|████▎     | 205M/481M [00:13<00:08, 31.0MB/s] 43%|████▎     | 208M/481M [00:13<00:09, 30.3MB/s] 44%|████▍     | 211M/481M [00:13<00:09, 29.0MB/s] 44%|████▍     | 214M/481M [00:13<00:09, 28.9MB/s] 45%|████▌     | 217M/481M [00:13<00:09, 28.8MB/s] 46%|████▌     | 220M/481M [00:13<00:09, 26.9MB/s] 46%|████▌     | 223M/481M [00:13<00:10, 25.9MB/s] 47%|████▋     | 225M/481M [00:14<00:11, 22.9MB/s] 47%|████▋     | 228M/481M [00:14<00:11, 22.9MB/s] 48%|████▊     | 230M/481M [00:14<00:10, 22.9MB/s] 48%|████▊     | 233M/481M [00:14<00:11, 20.8MB/s] 49%|████▊     | 235M/481M [00:14<00:12, 20.2MB/s] 49%|████▉     | 237M/481M [00:14<00:12, 20.3MB/s] 50%|████▉     | 240M/481M [00:14<00:11, 21.9MB/s] 50%|█████     | 242M/481M [00:14<00:10, 22.6MB/s] 51%|█████     | 245M/481M [00:14<00:10, 21.8MB/s] 51%|█████▏    | 247M/481M [00:15<00:11, 21.2MB/s] 52%|█████▏    | 250M/481M [00:15<00:10, 22.1MB/s] 53%|█████▎    | 253M/481M [00:15<00:09, 22.9MB/s] 53%|█████▎    | 257M/481M [00:15<00:08, 27.0MB/s] 54%|█████▍    | 260M/481M [00:15<00:07, 28.3MB/s] 55%|█████▍    | 263M/481M [00:15<00:07, 27.9MB/s] 55%|█████▌    | 266M/481M [00:15<00:07, 28.4MB/s] 56%|█████▌    | 270M/481M [00:15<00:06, 30.8MB/s] 57%|█████▋    | 273M/481M [00:15<00:06, 31.3MB/s] 57%|█████▋    | 276M/481M [00:16<00:06, 30.7MB/s] 58%|█████▊    | 279M/481M [00:16<00:06, 30.5MB/s] 59%|█████▊    | 282M/481M [00:16<00:06, 29.6MB/s] 59%|█████▉    | 285M/481M [00:16<00:06, 28.8MB/s] 60%|█████▉    | 288M/481M [00:16<00:07, 27.1MB/s] 60%|██████    | 291M/481M [00:16<00:07, 27.2MB/s] 61%|██████    | 293M/481M [00:16<00:07, 26.7MB/s] 62%|██████▏   | 296M/481M [00:16<00:06, 26.9MB/s] 62%|██████▏   | 299M/481M [00:16<00:07, 23.7MB/s] 63%|██████▎   | 301M/481M [00:17<00:08, 21.6MB/s] 63%|██████▎   | 304M/481M [00:17<00:08, 20.0MB/s] 64%|██████▎   | 306M/481M [00:17<00:08, 20.3MB/s] 64%|██████▍   | 309M/481M [00:17<00:08, 20.4MB/s] 65%|██████▍   | 311M/481M [00:17<00:08, 21.0MB/s] 65%|██████▌   | 314M/481M [00:17<00:07, 21.5MB/s] 66%|██████▌   | 316M/481M [00:17<00:08, 20.5MB/s] 66%|██████▌   | 318M/481M [00:17<00:08, 18.3MB/s] 67%|██████▋   | 321M/481M [00:18<00:08, 18.5MB/s] 67%|██████▋   | 324M/481M [00:18<00:08, 19.0MB/s] 68%|██████▊   | 327M/481M [00:18<00:08, 19.1MB/s] 69%|██████▊   | 330M/481M [00:18<00:07, 19.3MB/s] 69%|██████▉   | 333M/481M [00:18<00:07, 19.4MB/s] 70%|██████▉   | 336M/481M [00:18<00:07, 19.6MB/s] 70%|███████   | 339M/481M [00:18<00:06, 20.8MB/s] 71%|███████   | 342M/481M [00:19<00:06, 22.4MB/s] 72%|███████▏  | 345M/481M [00:19<00:05, 22.8MB/s] 72%|███████▏  | 348M/481M [00:19<00:05, 23.3MB/s] 73%|███████▎  | 350M/481M [00:19<00:05, 24.7MB/s] 73%|███████▎  | 353M/481M [00:19<00:05, 23.6MB/s] 74%|███████▍  | 356M/481M [00:19<00:05, 24.8MB/s] 75%|███████▍  | 359M/481M [00:19<00:04, 25.6MB/s] 75%|███████▌  | 362M/481M [00:19<00:04, 26.3MB/s] 76%|███████▌  | 365M/481M [00:20<00:04, 24.5MB/s] 76%|███████▋  | 368M/481M [00:20<00:04, 24.0MB/s] 77%|███████▋  | 371M/481M [00:20<00:04, 23.9MB/s] 78%|███████▊  | 374M/481M [00:20<00:04, 24.6MB/s] 78%|███████▊  | 376M/481M [00:20<00:04, 23.8MB/s] 79%|███████▊  | 379M/481M [00:20<00:04, 22.4MB/s] 79%|███████▉  | 381M/481M [00:20<00:04, 22.4MB/s] 80%|███████▉  | 384M/481M [00:20<00:03, 24.4MB/s] 80%|████████  | 387M/481M [00:20<00:03, 26.3MB/s] 81%|████████  | 390M/481M [00:21<00:03, 27.7MB/s] 82%|████████▏ | 394M/481M [00:21<00:02, 30.5MB/s] 83%|████████▎ | 398M/481M [00:21<00:02, 32.7MB/s] 83%|████████▎ | 401M/481M [00:21<00:02, 32.3MB/s] 84%|████████▍ | 404M/481M [00:21<00:02, 30.3MB/s] 85%|████████▍ | 408M/481M [00:21<00:02, 29.8MB/s] 85%|████████▌ | 411M/481M [00:21<00:02, 28.8MB/s] 86%|████████▌ | 413M/481M [00:21<00:02, 28.2MB/s] 87%|████████▋ | 417M/481M [00:21<00:02, 28.1MB/s] 87%|████████▋ | 420M/481M [00:22<00:02, 28.6MB/s] 88%|████████▊ | 423M/481M [00:22<00:02, 28.5MB/s] 89%|████████▊ | 427M/481M [00:22<00:01, 31.2MB/s] 89%|████████▉ | 430M/481M [00:22<00:01, 29.5MB/s] 90%|█████████ | 433M/481M [00:22<00:01, 30.1MB/s] 91%|█████████ | 436M/481M [00:22<00:01, 29.4MB/s] 91%|█████████▏| 439M/481M [00:22<00:01, 28.0MB/s] 92%|█████████▏| 442M/481M [00:22<00:01, 27.5MB/s] 92%|█████████▏| 445M/481M [00:22<00:01, 26.6MB/s] 93%|█████████▎| 448M/481M [00:23<00:01, 26.4MB/s] 94%|█████████▎| 450M/481M [00:23<00:01, 24.8MB/s] 94%|█████████▍| 453M/481M [00:23<00:01, 24.4MB/s] 95%|█████████▍| 456M/481M [00:23<00:01, 24.8MB/s] 95%|█████████▌| 459M/481M [00:23<00:00, 24.9MB/s] 96%|█████████▌| 461M/481M [00:23<00:00, 24.1MB/s] 96%|█████████▋| 464M/481M [00:23<00:00, 23.8MB/s] 97%|█████████▋| 466M/481M [00:23<00:00, 23.1MB/s] 97%|█████████▋| 469M/481M [00:23<00:00, 23.2MB/s] 98%|█████████▊| 471M/481M [00:24<00:00, 23.6MB/s] 98%|█████████▊| 474M/481M [00:24<00:00, 23.5MB/s] 99%|█████████▉| 476M/481M [00:24<00:00, 23.6MB/s] 99%|█████████▉| 479M/481M [00:24<00:00, 23.1MB/s]100%|█████████▉| 481M/481M [00:24<00:00, 22.9MB/s]100%|██████████| 481M/481M [00:24<00:00, 19.7MB/s]
textattack: Unzipping file /root/.cache/textattack/tmpv79_67o9.zip to /root/.cache/textattack/word_embeddings/paragramcf.
textattack: Successfully saved word_embeddings/paragramcf to cache.
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Downloading builder script:   0%|          | 0.00/1.65k [00:00<?, ?B/s]Downloading builder script: 4.21kB [00:00, 18.4MB/s]                   2024-03-07 01:31:10.032388: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:31:10.114686: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:31:10.117102: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:31:10.134465: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:31:10.136820: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:31:10.139144: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:31:12.457010: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:31:12.458629: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:31:12.460083: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:31:12.461531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0

Downloading readme:   0%|          | 0.00/255 [00:00<?, ?B/s]Downloading readme: 100%|██████████| 255/255 [00:00<00:00, 1.28MB/s]
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
Downloading data files:   0%|          | 0/2 [00:00<?, ?it/s]
Downloading data:   0%|          | 0.00/493k [00:00<?, ?B/s][A
Downloading data: 100%|██████████| 493k/493k [00:00<00:00, 1.47MB/s][ADownloading data: 100%|██████████| 493k/493k [00:00<00:00, 1.47MB/s]
Downloading data files:  50%|█████     | 1/2 [00:00<00:00,  2.95it/s]
Downloading data:   0%|          | 0.00/52.1k [00:00<?, ?B/s][A
Downloading data: 100%|██████████| 52.1k/52.1k [00:00<00:00, 295kB/s][ADownloading data: 100%|██████████| 52.1k/52.1k [00:00<00:00, 295kB/s]
Downloading data files: 100%|██████████| 2/2 [00:00<00:00,  4.08it/s]Downloading data files: 100%|██████████| 2/2 [00:00<00:00,  3.86it/s]
Extracting data files:   0%|          | 0/2 [00:00<?, ?it/s]Extracting data files: 100%|██████████| 2/2 [00:00<00:00, 2168.72it/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 3394 examples [00:00, 453272.23 examples/s]
Generating test split: 0 examples [00:00, ? examples/s]Generating test split: 376 examples [00:00, 227536.91 examples/s]
Map:   0%|          | 0/3394 [00:00<?, ? examples/s]Map:  59%|█████▉    | 2000/3394 [00:00<00:00, 19085.54 examples/s]Map: 100%|██████████| 3394/3394 [00:00<00:00, 19644.80 examples/s]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map: 100%|██████████| 376/376 [00:00<00:00, 17211.72 examples/s]
Map:   0%|          | 0/3224 [00:00<?, ? examples/s]Map:  35%|███▌      | 1138/3224 [00:00<00:00, 11311.56 examples/s]Map:  71%|███████▏  | 2302/3224 [00:00<00:00, 11500.17 examples/s]Map: 100%|██████████| 3224/3224 [00:00<00:00, 11474.76 examples/s]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map: 100%|██████████| 376/376 [00:00<00:00, 18059.85 examples/s]
Map:   0%|          | 0/170 [00:00<?, ? examples/s]Map: 100%|██████████| 170/170 [00:00<00:00, 9974.56 examples/s]
Downloading tokenizer_config.json:   0%|          | 0.00/776 [00:00<?, ?B/s]Downloading tokenizer_config.json: 100%|██████████| 776/776 [00:00<00:00, 184kB/s]
Downloading tokenizer.model:   0%|          | 0.00/500k [00:00<?, ?B/s]Downloading tokenizer.model: 100%|██████████| 500k/500k [00:00<00:00, 8.45MB/s]
Downloading tokenizer.json:   0%|          | 0.00/1.84M [00:00<?, ?B/s]Downloading tokenizer.json: 100%|██████████| 1.84M/1.84M [00:00<00:00, 4.98MB/s]Downloading tokenizer.json: 100%|██████████| 1.84M/1.84M [00:00<00:00, 4.96MB/s]
Downloading (…)cial_tokens_map.json:   0%|          | 0.00/414 [00:00<?, ?B/s]Downloading (…)cial_tokens_map.json: 100%|██████████| 414/414 [00:00<00:00, 181kB/s]
Downloading config.json:   0%|          | 0.00/609 [00:00<?, ?B/s]Downloading config.json: 100%|██████████| 609/609 [00:00<00:00, 147kB/s]
Downloading (…)fetensors.index.json:   0%|          | 0.00/26.8k [00:00<?, ?B/s]Downloading (…)fetensors.index.json: 100%|██████████| 26.8k/26.8k [00:00<00:00, 16.2MB/s]
Downloading shards:   0%|          | 0/2 [00:00<?, ?it/s]
Downloading (…)of-00002.safetensors:   0%|          | 0.00/9.98G [00:00<?, ?B/s][A
Downloading (…)of-00002.safetensors:   0%|          | 10.5M/9.98G [00:00<02:45, 60.3MB/s][A
Downloading (…)of-00002.safetensors:   0%|          | 31.5M/9.98G [00:00<01:23, 118MB/s] [A
Downloading (…)of-00002.safetensors:   1%|          | 52.4M/9.98G [00:00<01:05, 152MB/s][A
Downloading (…)of-00002.safetensors:   1%|          | 83.9M/9.98G [00:00<00:52, 188MB/s][A
Downloading (…)of-00002.safetensors:   1%|          | 115M/9.98G [00:00<00:48, 205MB/s] [A
Downloading (…)of-00002.safetensors:   1%|▏         | 147M/9.98G [00:00<00:43, 225MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 178M/9.98G [00:00<00:41, 239MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 210M/9.98G [00:01<00:39, 248MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 241M/9.98G [00:01<00:38, 254MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 273M/9.98G [00:01<00:37, 256MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 304M/9.98G [00:01<00:38, 254MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 336M/9.98G [00:01<00:38, 254MB/s][A
Downloading (…)of-00002.safetensors:   4%|▎         | 367M/9.98G [00:01<00:37, 254MB/s][A
Downloading (…)of-00002.safetensors:   4%|▍         | 398M/9.98G [00:01<00:37, 256MB/s][A
Downloading (…)of-00002.safetensors:   4%|▍         | 430M/9.98G [00:01<00:36, 258MB/s][A
Downloading (…)of-00002.safetensors:   5%|▍         | 461M/9.98G [00:01<00:36, 264MB/s][A
Downloading (…)of-00002.safetensors:   5%|▍         | 493M/9.98G [00:02<00:35, 266MB/s][A
Downloading (…)of-00002.safetensors:   5%|▌         | 524M/9.98G [00:02<00:35, 269MB/s][A
Downloading (…)of-00002.safetensors:   6%|▌         | 556M/9.98G [00:02<00:34, 269MB/s][A
Downloading (…)of-00002.safetensors:   6%|▌         | 587M/9.98G [00:02<00:34, 269MB/s][A
Downloading (…)of-00002.safetensors:   6%|▌         | 619M/9.98G [00:02<00:35, 262MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 650M/9.98G [00:02<00:35, 259MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 682M/9.98G [00:02<00:35, 260MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 713M/9.98G [00:02<00:35, 265MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 744M/9.98G [00:03<00:34, 265MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 776M/9.98G [00:03<00:34, 264MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 807M/9.98G [00:03<00:33, 271MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 839M/9.98G [00:03<00:33, 275MB/s][A
Downloading (…)of-00002.safetensors:   9%|▊         | 870M/9.98G [00:04<01:30, 100MB/s][A
Downloading (…)of-00002.safetensors:   9%|▉         | 891M/9.98G [00:04<01:35, 94.7MB/s][A
Downloading (…)of-00002.safetensors:   9%|▉         | 923M/9.98G [00:04<01:23, 108MB/s] [A
Downloading (…)of-00002.safetensors:   9%|▉         | 944M/9.98G [00:05<01:44, 86.1MB/s][A
Downloading (…)of-00002.safetensors:  10%|▉         | 965M/9.98G [00:05<01:29, 101MB/s] [A
Downloading (…)of-00002.safetensors:  10%|▉         | 986M/9.98G [00:05<01:52, 79.7MB/s][A
Downloading (…)of-00002.safetensors:  10%|█         | 1.01G/9.98G [00:05<02:10, 68.8MB/s][A
Downloading (…)of-00002.safetensors:  10%|█         | 1.04G/9.98G [00:06<01:34, 94.7MB/s][A
Downloading (…)of-00002.safetensors:  11%|█         | 1.07G/9.98G [00:06<01:13, 122MB/s] [A
Downloading (…)of-00002.safetensors:  11%|█         | 1.10G/9.98G [00:06<01:00, 147MB/s][A
Downloading (…)of-00002.safetensors:  11%|█▏        | 1.13G/9.98G [00:06<00:52, 168MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.16G/9.98G [00:06<00:46, 189MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.20G/9.98G [00:06<00:43, 202MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 1.23G/9.98G [00:06<00:40, 217MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.26G/9.98G [00:06<00:38, 229MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.29G/9.98G [00:07<00:42, 207MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.32G/9.98G [00:08<01:41, 84.9MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 1.34G/9.98G [00:08<02:04, 69.2MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▍        | 1.37G/9.98G [00:08<01:35, 90.4MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▍        | 1.41G/9.98G [00:08<01:15, 114MB/s] [A
Downloading (…)of-00002.safetensors:  14%|█▍        | 1.44G/9.98G [00:08<01:01, 139MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▍        | 1.47G/9.98G [00:08<00:52, 161MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▌        | 1.50G/9.98G [00:09<00:46, 184MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▌        | 1.53G/9.98G [00:09<00:41, 202MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▌        | 1.56G/9.98G [00:09<00:38, 217MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▌        | 1.59G/9.98G [00:09<00:36, 228MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▋        | 1.63G/9.98G [00:10<01:18, 107MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.65G/9.98G [00:10<01:53, 73.3MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.67G/9.98G [00:11<01:54, 72.8MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.70G/9.98G [00:11<01:26, 95.3MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 1.72G/9.98G [00:11<01:18, 105MB/s] [A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.75G/9.98G [00:11<01:03, 130MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.78G/9.98G [00:11<00:52, 156MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.81G/9.98G [00:11<00:45, 181MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 1.85G/9.98G [00:11<00:40, 202MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 1.88G/9.98G [00:11<00:36, 220MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 1.91G/9.98G [00:12<00:34, 232MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 1.94G/9.98G [00:12<01:22, 97.5MB/s][A
Downloading (…)of-00002.safetensors:  20%|█▉        | 1.96G/9.98G [00:13<02:03, 65.1MB/s][A
Downloading (…)of-00002.safetensors:  20%|█▉        | 1.98G/9.98G [00:13<01:45, 75.5MB/s][A
Downloading (…)of-00002.safetensors:  20%|██        | 2.00G/9.98G [00:13<01:28, 90.4MB/s][A
Downloading (…)of-00002.safetensors:  20%|██        | 2.03G/9.98G [00:13<01:07, 118MB/s] [A
Downloading (…)of-00002.safetensors:  21%|██        | 2.07G/9.98G [00:13<00:54, 146MB/s][A
Downloading (…)of-00002.safetensors:  21%|██        | 2.10G/9.98G [00:14<00:46, 168MB/s][A
Downloading (…)of-00002.safetensors:  21%|██▏       | 2.13G/9.98G [00:14<00:41, 189MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.16G/9.98G [00:14<00:37, 206MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.19G/9.98G [00:14<00:34, 223MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 2.22G/9.98G [00:14<00:33, 231MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.25G/9.98G [00:14<00:33, 233MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.29G/9.98G [00:14<00:32, 237MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 2.32G/9.98G [00:15<00:43, 176MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▎       | 2.35G/9.98G [00:15<00:56, 134MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.38G/9.98G [00:15<00:49, 155MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.41G/9.98G [00:15<00:43, 174MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 2.44G/9.98G [00:15<00:39, 193MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▍       | 2.47G/9.98G [00:16<01:02, 119MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▌       | 2.50G/9.98G [00:16<01:22, 90.6MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▌       | 2.52G/9.98G [00:17<01:26, 86.3MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▌       | 2.55G/9.98G [00:17<01:06, 111MB/s] [A
Downloading (…)of-00002.safetensors:  26%|██▌       | 2.58G/9.98G [00:17<00:54, 135MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▌       | 2.61G/9.98G [00:17<00:46, 159MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▋       | 2.64G/9.98G [00:17<00:40, 179MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.67G/9.98G [00:17<00:39, 187MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.71G/9.98G [00:17<00:36, 200MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 2.74G/9.98G [00:17<00:33, 214MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.77G/9.98G [00:18<00:32, 219MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.80G/9.98G [00:18<01:24, 85.0MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.82G/9.98G [00:19<01:26, 82.5MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 2.84G/9.98G [00:19<01:27, 81.9MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▉       | 2.87G/9.98G [00:19<01:07, 105MB/s] [A
Downloading (…)of-00002.safetensors:  29%|██▉       | 2.90G/9.98G [00:19<00:54, 129MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▉       | 2.94G/9.98G [00:19<00:46, 150MB/s][A
Downloading (…)of-00002.safetensors:  30%|██▉       | 2.97G/9.98G [00:20<00:41, 170MB/s][A
Downloading (…)of-00002.safetensors:  30%|███       | 3.00G/9.98G [00:20<00:37, 186MB/s][A
Downloading (…)of-00002.safetensors:  30%|███       | 3.03G/9.98G [00:20<00:34, 199MB/s][A
Downloading (…)of-00002.safetensors:  31%|███       | 3.06G/9.98G [00:20<00:32, 212MB/s][A
Downloading (…)of-00002.safetensors:  31%|███       | 3.09G/9.98G [00:20<00:31, 222MB/s][A
Downloading (…)of-00002.safetensors:  31%|███▏      | 3.12G/9.98G [00:21<01:13, 92.7MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.15G/9.98G [00:21<01:36, 71.0MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.18G/9.98G [00:22<01:14, 91.0MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.21G/9.98G [00:22<00:59, 114MB/s] [A
Downloading (…)of-00002.safetensors:  32%|███▏      | 3.24G/9.98G [00:22<00:49, 137MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.27G/9.98G [00:22<00:42, 159MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.30G/9.98G [00:22<00:37, 178MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 3.33G/9.98G [00:22<00:35, 189MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▎      | 3.37G/9.98G [00:22<00:32, 204MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▍      | 3.40G/9.98G [00:22<00:31, 212MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▍      | 3.43G/9.98G [00:23<01:00, 108MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▍      | 3.45G/9.98G [00:24<01:32, 70.4MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▍      | 3.47G/9.98G [00:24<01:25, 75.7MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▌      | 3.50G/9.98G [00:24<01:04, 99.8MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▌      | 3.53G/9.98G [00:24<00:52, 123MB/s] [A
Downloading (…)of-00002.safetensors:  36%|███▌      | 3.57G/9.98G [00:24<00:43, 146MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▌      | 3.60G/9.98G [00:24<00:37, 168MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▋      | 3.63G/9.98G [00:25<00:33, 191MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.66G/9.98G [00:25<00:30, 210MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.69G/9.98G [00:25<00:27, 226MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 3.72G/9.98G [00:25<00:26, 239MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.75G/9.98G [00:25<00:43, 144MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.77G/9.98G [00:26<01:29, 69.2MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.80G/9.98G [00:26<01:26, 71.6MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 3.83G/9.98G [00:27<01:04, 95.7MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▊      | 3.86G/9.98G [00:27<00:50, 122MB/s] [A
Downloading (…)of-00002.safetensors:  39%|███▉      | 3.89G/9.98G [00:27<00:41, 148MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▉      | 3.92G/9.98G [00:27<00:35, 172MB/s][A
Downloading (…)of-00002.safetensors:  40%|███▉      | 3.95G/9.98G [00:27<00:31, 193MB/s][A
Downloading (…)of-00002.safetensors:  40%|███▉      | 3.98G/9.98G [00:27<00:28, 210MB/s][A
Downloading (…)of-00002.safetensors:  40%|████      | 4.02G/9.98G [00:27<00:26, 221MB/s][A
Downloading (…)of-00002.safetensors:  41%|████      | 4.05G/9.98G [00:27<00:25, 231MB/s][A
Downloading (…)of-00002.safetensors:  41%|████      | 4.08G/9.98G [00:28<00:34, 171MB/s][A
Downloading (…)of-00002.safetensors:  41%|████      | 4.10G/9.98G [00:28<01:03, 92.1MB/s][A
Downloading (…)of-00002.safetensors:  41%|████▏     | 4.12G/9.98G [00:29<01:23, 69.8MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.14G/9.98G [00:29<01:09, 84.0MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.17G/9.98G [00:29<00:52, 111MB/s] [A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.20G/9.98G [00:29<00:41, 138MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 4.24G/9.98G [00:29<00:34, 165MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.27G/9.98G [00:29<00:30, 188MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.30G/9.98G [00:30<00:27, 208MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 4.33G/9.98G [00:30<00:25, 223MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▎     | 4.36G/9.98G [00:30<00:23, 237MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▍     | 4.39G/9.98G [00:30<00:23, 239MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▍     | 4.42G/9.98G [00:30<00:30, 182MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▍     | 4.46G/9.98G [00:30<00:27, 202MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▍     | 4.49G/9.98G [00:30<00:25, 217MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▌     | 4.52G/9.98G [00:30<00:24, 227MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.55G/9.98G [00:31<00:22, 240MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.58G/9.98G [00:31<00:21, 248MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 4.61G/9.98G [00:31<00:20, 256MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.65G/9.98G [00:31<00:20, 261MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.68G/9.98G [00:31<00:20, 265MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 4.71G/9.98G [00:31<00:19, 265MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.74G/9.98G [00:31<00:23, 222MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.77G/9.98G [00:31<00:22, 235MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.80G/9.98G [00:32<00:21, 245MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 4.83G/9.98G [00:32<00:20, 253MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 4.87G/9.98G [00:32<00:20, 252MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 4.90G/9.98G [00:32<00:19, 256MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 4.93G/9.98G [00:32<00:19, 258MB/s][A
Downloading (…)of-00002.safetensors:  50%|████▉     | 4.96G/9.98G [00:32<00:19, 262MB/s][A
Downloading (…)of-00002.safetensors:  50%|█████     | 4.99G/9.98G [00:32<00:19, 262MB/s][A
Downloading (…)of-00002.safetensors:  50%|█████     | 5.02G/9.98G [00:33<00:33, 147MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████     | 5.05G/9.98G [00:33<00:29, 166MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████     | 5.09G/9.98G [00:33<00:27, 181MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████▏    | 5.12G/9.98G [00:34<00:52, 92.4MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.14G/9.98G [00:34<00:51, 94.1MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.16G/9.98G [00:34<00:44, 108MB/s] [A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.19G/9.98G [00:34<00:35, 135MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 5.22G/9.98G [00:34<00:29, 162MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.25G/9.98G [00:34<00:25, 186MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.28G/9.98G [00:35<00:38, 122MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.31G/9.98G [00:35<00:43, 108MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 5.34G/9.98G [00:35<00:34, 133MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 5.37G/9.98G [00:35<00:29, 157MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 5.40G/9.98G [00:36<00:25, 181MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 5.43G/9.98G [00:36<00:22, 199MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▍    | 5.46G/9.98G [00:36<00:21, 215MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▌    | 5.49G/9.98G [00:36<00:19, 230MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▌    | 5.53G/9.98G [00:36<00:18, 240MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▌    | 5.56G/9.98G [00:36<00:17, 249MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▌    | 5.59G/9.98G [00:36<00:19, 224MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▋    | 5.62G/9.98G [00:36<00:18, 238MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.65G/9.98G [00:37<00:18, 239MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.68G/9.98G [00:37<00:19, 221MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 5.71G/9.98G [00:37<00:18, 235MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.75G/9.98G [00:37<00:17, 243MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.78G/9.98G [00:37<00:17, 240MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 5.81G/9.98G [00:37<00:18, 231MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▊    | 5.84G/9.98G [00:37<00:18, 226MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.87G/9.98G [00:37<00:18, 219MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.90G/9.98G [00:38<00:19, 211MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 5.93G/9.98G [00:38<00:18, 213MB/s][A
Downloading (…)of-00002.safetensors:  60%|█████▉    | 5.97G/9.98G [00:38<00:18, 214MB/s][A
Downloading (…)of-00002.safetensors:  60%|██████    | 6.00G/9.98G [00:38<00:19, 202MB/s][A
Downloading (…)of-00002.safetensors:  60%|██████    | 6.02G/9.98G [00:39<00:47, 83.5MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 6.04G/9.98G [00:39<00:50, 77.4MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 6.06G/9.98G [00:40<00:51, 75.8MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 6.08G/9.98G [00:40<00:50, 77.9MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████▏   | 6.11G/9.98G [00:40<00:36, 105MB/s] [A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.14G/9.98G [00:40<00:28, 135MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.18G/9.98G [00:40<00:23, 163MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 6.21G/9.98G [00:40<00:19, 189MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.24G/9.98G [00:40<00:17, 211MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.27G/9.98G [00:40<00:16, 230MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.30G/9.98G [00:41<00:15, 245MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 6.33G/9.98G [00:41<00:14, 255MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 6.36G/9.98G [00:41<00:13, 264MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 6.40G/9.98G [00:41<00:18, 196MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 6.43G/9.98G [00:41<00:16, 216MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▍   | 6.46G/9.98G [00:41<00:15, 224MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▌   | 6.49G/9.98G [00:41<00:14, 239MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▌   | 6.52G/9.98G [00:41<00:14, 246MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▌   | 6.55G/9.98G [00:42<00:14, 239MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▌   | 6.59G/9.98G [00:42<00:15, 216MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▋   | 6.62G/9.98G [00:42<00:14, 227MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.65G/9.98G [00:42<00:14, 231MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.68G/9.98G [00:42<00:14, 235MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 6.71G/9.98G [00:42<00:13, 248MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.74G/9.98G [00:42<00:12, 255MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.77G/9.98G [00:43<00:28, 114MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.79G/9.98G [00:44<00:42, 74.3MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 6.82G/9.98G [00:44<00:36, 86.6MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▊   | 6.85G/9.98G [00:44<00:28, 111MB/s] [A
Downloading (…)of-00002.safetensors:  69%|██████▉   | 6.88G/9.98G [00:44<00:23, 134MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▉   | 6.91G/9.98G [00:44<00:19, 160MB/s][A
Downloading (…)of-00002.safetensors:  70%|██████▉   | 6.94G/9.98G [00:44<00:16, 181MB/s][A
Downloading (…)of-00002.safetensors:  70%|██████▉   | 6.97G/9.98G [00:44<00:15, 198MB/s][A
Downloading (…)of-00002.safetensors:  70%|███████   | 7.00G/9.98G [00:45<00:13, 212MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 7.04G/9.98G [00:45<00:13, 220MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 7.07G/9.98G [00:45<00:13, 222MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 7.10G/9.98G [00:45<00:12, 233MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████▏  | 7.13G/9.98G [00:45<00:11, 242MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.16G/9.98G [00:45<00:11, 252MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.19G/9.98G [00:45<00:10, 258MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 7.22G/9.98G [00:45<00:10, 262MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.26G/9.98G [00:46<00:10, 264MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.29G/9.98G [00:46<00:10, 267MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 7.32G/9.98G [00:46<00:10, 256MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▎  | 7.35G/9.98G [00:46<00:10, 259MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▍  | 7.38G/9.98G [00:46<00:09, 263MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▍  | 7.41G/9.98G [00:46<00:09, 262MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▍  | 7.44G/9.98G [00:46<00:09, 265MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▍  | 7.48G/9.98G [00:46<00:09, 266MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▌  | 7.51G/9.98G [00:46<00:09, 268MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▌  | 7.54G/9.98G [00:47<00:09, 268MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▌  | 7.57G/9.98G [00:47<00:08, 269MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▌  | 7.60G/9.98G [00:47<00:08, 271MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.63G/9.98G [00:47<00:08, 273MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.67G/9.98G [00:47<00:10, 219MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.70G/9.98G [00:47<00:09, 230MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 7.73G/9.98G [00:47<00:09, 242MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.76G/9.98G [00:47<00:08, 250MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.79G/9.98G [00:48<00:08, 256MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 7.82G/9.98G [00:48<00:08, 258MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▊  | 7.85G/9.98G [00:48<00:08, 262MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▉  | 7.89G/9.98G [00:48<00:07, 269MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▉  | 7.92G/9.98G [00:48<00:07, 266MB/s][A
Downloading (…)of-00002.safetensors:  80%|███████▉  | 7.95G/9.98G [00:48<00:08, 250MB/s][A
Downloading (…)of-00002.safetensors:  80%|███████▉  | 7.98G/9.98G [00:48<00:07, 250MB/s][A
Downloading (…)of-00002.safetensors:  80%|████████  | 8.01G/9.98G [00:48<00:07, 250MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.04G/9.98G [00:49<00:07, 250MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.07G/9.98G [00:49<00:08, 235MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 8.11G/9.98G [00:49<00:07, 247MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.14G/9.98G [00:49<00:07, 252MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.17G/9.98G [00:49<00:07, 256MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 8.20G/9.98G [00:49<00:06, 261MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.23G/9.98G [00:49<00:06, 267MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.26G/9.98G [00:50<00:21, 78.0MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.28G/9.98G [00:51<00:19, 87.8MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 8.32G/9.98G [00:51<00:16, 99.2MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▎ | 8.34G/9.98G [00:51<00:25, 63.9MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 8.36G/9.98G [00:52<00:22, 70.6MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 8.38G/9.98G [00:52<00:21, 73.2MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 8.41G/9.98G [00:52<00:15, 99.4MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▍ | 8.44G/9.98G [00:52<00:12, 125MB/s] [A
Downloading (…)of-00002.safetensors:  85%|████████▍ | 8.47G/9.98G [00:52<00:09, 152MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▌ | 8.50G/9.98G [00:52<00:08, 176MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▌ | 8.54G/9.98G [00:53<00:07, 199MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▌ | 8.57G/9.98G [00:53<00:06, 218MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▌ | 8.60G/9.98G [00:53<00:05, 233MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.63G/9.98G [00:53<00:05, 237MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.66G/9.98G [00:53<00:07, 176MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.69G/9.98G [00:53<00:06, 187MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 8.72G/9.98G [00:53<00:06, 207MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.76G/9.98G [00:54<00:05, 223MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.79G/9.98G [00:54<00:05, 237MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 8.82G/9.98G [00:54<00:04, 245MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▊ | 8.85G/9.98G [00:54<00:04, 252MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▉ | 8.88G/9.98G [00:55<00:10, 108MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▉ | 8.91G/9.98G [00:55<00:08, 132MB/s][A
Downloading (…)of-00002.safetensors:  90%|████████▉ | 8.94G/9.98G [00:55<00:06, 156MB/s][A
Downloading (…)of-00002.safetensors:  90%|████████▉ | 8.98G/9.98G [00:55<00:05, 179MB/s][A
Downloading (…)of-00002.safetensors:  90%|█████████ | 9.01G/9.98G [00:55<00:04, 199MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 9.04G/9.98G [00:55<00:04, 212MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 9.07G/9.98G [00:55<00:03, 227MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 9.10G/9.98G [00:56<00:10, 86.7MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.13G/9.98G [00:56<00:09, 92.8MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.15G/9.98G [00:57<00:08, 99.4MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.19G/9.98G [00:57<00:06, 124MB/s] [A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 9.22G/9.98G [00:57<00:05, 149MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.25G/9.98G [00:57<00:04, 173MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.28G/9.98G [00:57<00:03, 195MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 9.31G/9.98G [00:57<00:03, 213MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▎| 9.34G/9.98G [00:57<00:02, 228MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 9.37G/9.98G [00:57<00:02, 240MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 9.41G/9.98G [00:58<00:02, 247MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▍| 9.44G/9.98G [00:58<00:04, 134MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▍| 9.46G/9.98G [00:59<00:06, 83.1MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▌| 9.48G/9.98G [00:59<00:07, 63.6MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▌| 9.50G/9.98G [00:59<00:06, 75.9MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 9.53G/9.98G [00:59<00:04, 101MB/s] [A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 9.56G/9.98G [01:00<00:03, 128MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 9.59G/9.98G [01:00<00:02, 155MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▋| 9.63G/9.98G [01:00<00:01, 180MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.66G/9.98G [01:00<00:01, 200MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.69G/9.98G [01:00<00:01, 218MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 9.72G/9.98G [01:00<00:01, 232MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.75G/9.98G [01:00<00:01, 210MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.78G/9.98G [01:00<00:00, 227MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 9.81G/9.98G [01:01<00:00, 237MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▊| 9.85G/9.98G [01:01<00:00, 245MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▉| 9.88G/9.98G [01:01<00:00, 252MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▉| 9.91G/9.98G [01:01<00:00, 258MB/s][A
Downloading (…)of-00002.safetensors: 100%|█████████▉| 9.94G/9.98G [01:01<00:00, 263MB/s][A
Downloading (…)of-00002.safetensors: 100%|█████████▉| 9.97G/9.98G [01:01<00:00, 212MB/s][ADownloading (…)of-00002.safetensors: 100%|██████████| 9.98G/9.98G [01:01<00:00, 162MB/s]
Downloading shards:  50%|█████     | 1/2 [01:01<01:01, 61.85s/it]
Downloading (…)of-00002.safetensors:   0%|          | 0.00/3.50G [00:00<?, ?B/s][A
Downloading (…)of-00002.safetensors:   1%|          | 31.5M/3.50G [00:00<00:13, 258MB/s][A
Downloading (…)of-00002.safetensors:   2%|▏         | 62.9M/3.50G [00:00<00:13, 260MB/s][A
Downloading (…)of-00002.safetensors:   3%|▎         | 94.4M/3.50G [00:00<00:13, 257MB/s][A
Downloading (…)of-00002.safetensors:   4%|▎         | 126M/3.50G [00:00<00:13, 247MB/s] [A
Downloading (…)of-00002.safetensors:   4%|▍         | 157M/3.50G [00:00<00:13, 255MB/s][A
Downloading (…)of-00002.safetensors:   5%|▌         | 189M/3.50G [00:00<00:12, 259MB/s][A
Downloading (…)of-00002.safetensors:   6%|▋         | 220M/3.50G [00:00<00:12, 262MB/s][A
Downloading (…)of-00002.safetensors:   7%|▋         | 252M/3.50G [00:00<00:12, 266MB/s][A
Downloading (…)of-00002.safetensors:   8%|▊         | 283M/3.50G [00:01<00:12, 268MB/s][A
Downloading (…)of-00002.safetensors:   9%|▉         | 315M/3.50G [00:01<00:12, 263MB/s][A
Downloading (…)of-00002.safetensors:  10%|▉         | 346M/3.50G [00:01<00:11, 265MB/s][A
Downloading (…)of-00002.safetensors:  11%|█         | 377M/3.50G [00:01<00:11, 264MB/s][A
Downloading (…)of-00002.safetensors:  12%|█▏        | 409M/3.50G [00:01<00:11, 262MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 440M/3.50G [00:01<00:11, 265MB/s][A
Downloading (…)of-00002.safetensors:  13%|█▎        | 472M/3.50G [00:01<00:11, 267MB/s][A
Downloading (…)of-00002.safetensors:  14%|█▍        | 503M/3.50G [00:01<00:11, 269MB/s][A
Downloading (…)of-00002.safetensors:  15%|█▌        | 535M/3.50G [00:02<00:11, 269MB/s][A
Downloading (…)of-00002.safetensors:  16%|█▌        | 566M/3.50G [00:02<00:10, 269MB/s][A
Downloading (…)of-00002.safetensors:  17%|█▋        | 598M/3.50G [00:02<00:10, 268MB/s][A
Downloading (…)of-00002.safetensors:  18%|█▊        | 629M/3.50G [00:02<00:10, 268MB/s][A
Downloading (…)of-00002.safetensors:  19%|█▉        | 661M/3.50G [00:02<00:10, 267MB/s][A
Downloading (…)of-00002.safetensors:  20%|█▉        | 692M/3.50G [00:02<00:10, 267MB/s][A
Downloading (…)of-00002.safetensors:  21%|██        | 724M/3.50G [00:02<00:10, 260MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 755M/3.50G [00:02<00:10, 255MB/s][A
Downloading (…)of-00002.safetensors:  22%|██▏       | 786M/3.50G [00:02<00:10, 262MB/s][A
Downloading (…)of-00002.safetensors:  23%|██▎       | 818M/3.50G [00:03<00:10, 268MB/s][A
Downloading (…)of-00002.safetensors:  24%|██▍       | 849M/3.50G [00:03<00:09, 273MB/s][A
Downloading (…)of-00002.safetensors:  25%|██▌       | 881M/3.50G [00:03<00:09, 275MB/s][A
Downloading (…)of-00002.safetensors:  26%|██▌       | 912M/3.50G [00:03<00:09, 277MB/s][A
Downloading (…)of-00002.safetensors:  27%|██▋       | 944M/3.50G [00:03<00:09, 280MB/s][A
Downloading (…)of-00002.safetensors:  28%|██▊       | 975M/3.50G [00:03<00:09, 277MB/s][A
Downloading (…)of-00002.safetensors:  29%|██▉       | 1.01G/3.50G [00:03<00:09, 271MB/s][A
Downloading (…)of-00002.safetensors:  30%|██▉       | 1.04G/3.50G [00:03<00:09, 268MB/s][A
Downloading (…)of-00002.safetensors:  31%|███       | 1.07G/3.50G [00:04<00:08, 271MB/s][A
Downloading (…)of-00002.safetensors:  31%|███▏      | 1.10G/3.50G [00:04<00:08, 272MB/s][A
Downloading (…)of-00002.safetensors:  32%|███▏      | 1.13G/3.50G [00:04<00:08, 266MB/s][A
Downloading (…)of-00002.safetensors:  33%|███▎      | 1.16G/3.50G [00:04<00:08, 267MB/s][A
Downloading (…)of-00002.safetensors:  34%|███▍      | 1.20G/3.50G [00:04<00:08, 268MB/s][A
Downloading (…)of-00002.safetensors:  35%|███▌      | 1.23G/3.50G [00:04<00:08, 268MB/s][A
Downloading (…)of-00002.safetensors:  36%|███▌      | 1.26G/3.50G [00:04<00:08, 272MB/s][A
Downloading (…)of-00002.safetensors:  37%|███▋      | 1.29G/3.50G [00:04<00:08, 271MB/s][A
Downloading (…)of-00002.safetensors:  38%|███▊      | 1.32G/3.50G [00:04<00:07, 276MB/s][A
Downloading (…)of-00002.safetensors:  39%|███▊      | 1.35G/3.50G [00:05<00:07, 280MB/s][A
Downloading (…)of-00002.safetensors:  40%|███▉      | 1.38G/3.50G [00:05<00:07, 282MB/s][A
Downloading (…)of-00002.safetensors:  40%|████      | 1.42G/3.50G [00:05<00:07, 286MB/s][A
Downloading (…)of-00002.safetensors:  41%|████▏     | 1.45G/3.50G [00:05<00:07, 288MB/s][A
Downloading (…)of-00002.safetensors:  42%|████▏     | 1.48G/3.50G [00:05<00:06, 291MB/s][A
Downloading (…)of-00002.safetensors:  43%|████▎     | 1.51G/3.50G [00:05<00:06, 294MB/s][A
Downloading (…)of-00002.safetensors:  44%|████▍     | 1.54G/3.50G [00:05<00:06, 295MB/s][A
Downloading (…)of-00002.safetensors:  45%|████▍     | 1.57G/3.50G [00:05<00:06, 290MB/s][A
Downloading (…)of-00002.safetensors:  46%|████▌     | 1.60G/3.50G [00:05<00:06, 289MB/s][A
Downloading (…)of-00002.safetensors:  47%|████▋     | 1.64G/3.50G [00:06<00:06, 292MB/s][A
Downloading (…)of-00002.safetensors:  48%|████▊     | 1.67G/3.50G [00:06<00:06, 294MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▊     | 1.70G/3.50G [00:06<00:06, 293MB/s][A
Downloading (…)of-00002.safetensors:  49%|████▉     | 1.73G/3.50G [00:06<00:06, 294MB/s][A
Downloading (…)of-00002.safetensors:  50%|█████     | 1.76G/3.50G [00:06<00:05, 295MB/s][A
Downloading (…)of-00002.safetensors:  51%|█████     | 1.79G/3.50G [00:06<00:05, 295MB/s][A
Downloading (…)of-00002.safetensors:  52%|█████▏    | 1.82G/3.50G [00:06<00:05, 295MB/s][A
Downloading (…)of-00002.safetensors:  53%|█████▎    | 1.86G/3.50G [00:06<00:05, 289MB/s][A
Downloading (…)of-00002.safetensors:  54%|█████▍    | 1.89G/3.50G [00:06<00:05, 286MB/s][A
Downloading (…)of-00002.safetensors:  55%|█████▍    | 1.92G/3.50G [00:07<00:05, 269MB/s][A
Downloading (…)of-00002.safetensors:  56%|█████▌    | 1.95G/3.50G [00:07<00:05, 259MB/s][A
Downloading (…)of-00002.safetensors:  57%|█████▋    | 1.98G/3.50G [00:07<00:05, 255MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 2.01G/3.50G [00:07<00:05, 258MB/s][A
Downloading (…)of-00002.safetensors:  58%|█████▊    | 2.04G/3.50G [00:07<00:05, 263MB/s][A
Downloading (…)of-00002.safetensors:  59%|█████▉    | 2.08G/3.50G [00:07<00:05, 265MB/s][A
Downloading (…)of-00002.safetensors:  60%|██████    | 2.11G/3.50G [00:07<00:05, 263MB/s][A
Downloading (…)of-00002.safetensors:  61%|██████    | 2.14G/3.50G [00:07<00:05, 258MB/s][A
Downloading (…)of-00002.safetensors:  62%|██████▏   | 2.17G/3.50G [00:07<00:05, 263MB/s][A
Downloading (…)of-00002.safetensors:  63%|██████▎   | 2.20G/3.50G [00:08<00:04, 268MB/s][A
Downloading (…)of-00002.safetensors:  64%|██████▍   | 2.23G/3.50G [00:08<00:04, 268MB/s][A
Downloading (…)of-00002.safetensors:  65%|██████▍   | 2.26G/3.50G [00:08<00:04, 262MB/s][A
Downloading (…)of-00002.safetensors:  66%|██████▌   | 2.30G/3.50G [00:08<00:04, 263MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 2.33G/3.50G [00:08<00:04, 268MB/s][A
Downloading (…)of-00002.safetensors:  67%|██████▋   | 2.36G/3.50G [00:08<00:04, 270MB/s][A
Downloading (…)of-00002.safetensors:  68%|██████▊   | 2.39G/3.50G [00:08<00:04, 270MB/s][A
Downloading (…)of-00002.safetensors:  69%|██████▉   | 2.42G/3.50G [00:08<00:03, 271MB/s][A
Downloading (…)of-00002.safetensors:  70%|███████   | 2.45G/3.50G [00:09<00:03, 274MB/s][A
Downloading (…)of-00002.safetensors:  71%|███████   | 2.49G/3.50G [00:09<00:03, 274MB/s][A
Downloading (…)of-00002.safetensors:  72%|███████▏  | 2.52G/3.50G [00:09<00:03, 276MB/s][A
Downloading (…)of-00002.safetensors:  73%|███████▎  | 2.55G/3.50G [00:09<00:03, 278MB/s][A
Downloading (…)of-00002.safetensors:  74%|███████▎  | 2.58G/3.50G [00:09<00:03, 277MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▍  | 2.61G/3.50G [00:09<00:03, 269MB/s][A
Downloading (…)of-00002.safetensors:  75%|███████▌  | 2.64G/3.50G [00:09<00:03, 272MB/s][A
Downloading (…)of-00002.safetensors:  76%|███████▋  | 2.67G/3.50G [00:09<00:03, 275MB/s][A
Downloading (…)of-00002.safetensors:  77%|███████▋  | 2.71G/3.50G [00:09<00:02, 276MB/s][A
Downloading (…)of-00002.safetensors:  78%|███████▊  | 2.74G/3.50G [00:10<00:02, 277MB/s][A
Downloading (…)of-00002.safetensors:  79%|███████▉  | 2.77G/3.50G [00:10<00:03, 237MB/s][A
Downloading (…)of-00002.safetensors:  80%|███████▉  | 2.80G/3.50G [00:10<00:02, 245MB/s][A
Downloading (…)of-00002.safetensors:  81%|████████  | 2.83G/3.50G [00:10<00:02, 248MB/s][A
Downloading (…)of-00002.safetensors:  82%|████████▏ | 2.86G/3.50G [00:10<00:02, 254MB/s][A
Downloading (…)of-00002.safetensors:  83%|████████▎ | 2.89G/3.50G [00:10<00:02, 261MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▎ | 2.93G/3.50G [00:10<00:02, 266MB/s][A
Downloading (…)of-00002.safetensors:  84%|████████▍ | 2.96G/3.50G [00:10<00:02, 267MB/s][A
Downloading (…)of-00002.safetensors:  85%|████████▌ | 2.99G/3.50G [00:11<00:01, 263MB/s][A
Downloading (…)of-00002.safetensors:  86%|████████▋ | 3.02G/3.50G [00:11<00:01, 268MB/s][A
Downloading (…)of-00002.safetensors:  87%|████████▋ | 3.05G/3.50G [00:11<00:01, 271MB/s][A
Downloading (…)of-00002.safetensors:  88%|████████▊ | 3.08G/3.50G [00:11<00:01, 271MB/s][A
Downloading (…)of-00002.safetensors:  89%|████████▉ | 3.11G/3.50G [00:11<00:01, 269MB/s][A
Downloading (…)of-00002.safetensors:  90%|████████▉ | 3.15G/3.50G [00:11<00:01, 265MB/s][A
Downloading (…)of-00002.safetensors:  91%|█████████ | 3.18G/3.50G [00:11<00:01, 265MB/s][A
Downloading (…)of-00002.safetensors:  92%|█████████▏| 3.21G/3.50G [00:11<00:01, 267MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 3.24G/3.50G [00:11<00:00, 270MB/s][A
Downloading (…)of-00002.safetensors:  93%|█████████▎| 3.27G/3.50G [00:12<00:00, 267MB/s][A
Downloading (…)of-00002.safetensors:  94%|█████████▍| 3.30G/3.50G [00:12<00:00, 261MB/s][A
Downloading (…)of-00002.safetensors:  95%|█████████▌| 3.33G/3.50G [00:12<00:00, 259MB/s][A
Downloading (…)of-00002.safetensors:  96%|█████████▌| 3.37G/3.50G [00:12<00:00, 257MB/s][A
Downloading (…)of-00002.safetensors:  97%|█████████▋| 3.40G/3.50G [00:12<00:00, 251MB/s][A
Downloading (…)of-00002.safetensors:  98%|█████████▊| 3.43G/3.50G [00:12<00:00, 251MB/s][A
Downloading (…)of-00002.safetensors:  99%|█████████▉| 3.46G/3.50G [00:12<00:00, 250MB/s][A
Downloading (…)of-00002.safetensors: 100%|█████████▉| 3.49G/3.50G [00:13<00:00, 248MB/s][ADownloading (…)of-00002.safetensors: 100%|██████████| 3.50G/3.50G [00:13<00:00, 268MB/s]
Downloading shards: 100%|██████████| 2/2 [01:15<00:00, 33.22s/it]Downloading shards: 100%|██████████| 2/2 [01:15<00:00, 37.51s/it]
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.66s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.16s/it]
Downloading generation_config.json:   0%|          | 0.00/188 [00:00<?, ?B/s]Downloading generation_config.json: 100%|██████████| 188/188 [00:00<00:00, 55.9kB/s]
Downloading tokenizer_config.json:   0%|          | 0.00/48.0 [00:00<?, ?B/s]Downloading tokenizer_config.json: 100%|██████████| 48.0/48.0 [00:00<00:00, 35.7kB/s]
Downloading config.json:   0%|          | 0.00/570 [00:00<?, ?B/s]Downloading config.json: 100%|██████████| 570/570 [00:00<00:00, 428kB/s]
Downloading vocab.txt:   0%|          | 0.00/232k [00:00<?, ?B/s]Downloading vocab.txt: 100%|██████████| 232k/232k [00:00<00:00, 1.59MB/s]Downloading vocab.txt: 100%|██████████| 232k/232k [00:00<00:00, 1.59MB/s]
Downloading tokenizer.json:   0%|          | 0.00/466k [00:00<?, ?B/s]Downloading tokenizer.json: 100%|██████████| 466k/466k [00:00<00:00, 94.1MB/s]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 01:35:01.563279: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:35:02.367866: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 01:35:09.282373: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:35:09.290665: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:35:09.293069: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:35:09.306657: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:35:09.309065: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:35:09.311409: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:35:09.604556: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:35:09.607485: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:35:09.608985: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:35:09.610453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.21s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 01:37:41.280868: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:37:42.074889: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 01:37:48.923490: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:37:48.931745: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:37:48.934111: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:37:48.948792: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:37:48.951138: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:37:48.953455: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:37:51.786272: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:37:51.787847: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:37:51.789340: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:37:51.790809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.30s/it]
Downloading .gitattributes:   0%|          | 0.00/1.18k [00:00<?, ?B/s]Downloading .gitattributes: 100%|██████████| 1.18k/1.18k [00:00<00:00, 227kB/s]
Downloading 1_Pooling/config.json:   0%|          | 0.00/190 [00:00<?, ?B/s]Downloading 1_Pooling/config.json: 100%|██████████| 190/190 [00:00<00:00, 54.9kB/s]
Downloading README.md:   0%|          | 0.00/10.7k [00:00<?, ?B/s]Downloading README.md: 100%|██████████| 10.7k/10.7k [00:00<00:00, 9.00MB/s]
Downloading config.json:   0%|          | 0.00/612 [00:00<?, ?B/s]Downloading config.json: 100%|██████████| 612/612 [00:00<00:00, 579kB/s]
Downloading (…)ce_transformers.json:   0%|          | 0.00/116 [00:00<?, ?B/s]Downloading (…)ce_transformers.json: 100%|██████████| 116/116 [00:00<00:00, 81.7kB/s]
Downloading data_config.json:   0%|          | 0.00/39.3k [00:00<?, ?B/s]Downloading data_config.json: 100%|██████████| 39.3k/39.3k [00:00<00:00, 542kB/s]
Downloading pytorch_model.bin:   0%|          | 0.00/90.9M [00:00<?, ?B/s]Downloading pytorch_model.bin:  23%|██▎       | 21.0M/90.9M [00:00<00:00, 152MB/s]Downloading pytorch_model.bin:  58%|█████▊    | 52.4M/90.9M [00:00<00:00, 209MB/s]Downloading pytorch_model.bin:  92%|█████████▏| 83.9M/90.9M [00:00<00:00, 224MB/s]Downloading pytorch_model.bin: 100%|██████████| 90.9M/90.9M [00:00<00:00, 214MB/s]
Downloading (…)nce_bert_config.json:   0%|          | 0.00/53.0 [00:00<?, ?B/s]Downloading (…)nce_bert_config.json: 100%|██████████| 53.0/53.0 [00:00<00:00, 13.1kB/s]
Downloading (…)cial_tokens_map.json:   0%|          | 0.00/112 [00:00<?, ?B/s]Downloading (…)cial_tokens_map.json: 100%|██████████| 112/112 [00:00<00:00, 101kB/s]
Downloading tokenizer.json:   0%|          | 0.00/466k [00:00<?, ?B/s]Downloading tokenizer.json: 100%|██████████| 466k/466k [00:00<00:00, 2.11MB/s]Downloading tokenizer.json: 100%|██████████| 466k/466k [00:00<00:00, 2.11MB/s]
Downloading tokenizer_config.json:   0%|          | 0.00/350 [00:00<?, ?B/s]Downloading tokenizer_config.json: 100%|██████████| 350/350 [00:00<00:00, 681kB/s]
Downloading train_script.py:   0%|          | 0.00/13.2k [00:00<?, ?B/s]Downloading train_script.py: 100%|██████████| 13.2k/13.2k [00:00<00:00, 19.5MB/s]
Downloading vocab.txt:   0%|          | 0.00/232k [00:00<?, ?B/s]Downloading vocab.txt: 100%|██████████| 232k/232k [00:00<00:00, 1.56MB/s]Downloading vocab.txt: 100%|██████████| 232k/232k [00:00<00:00, 1.56MB/s]
Downloading modules.json:   0%|          | 0.00/349 [00:00<?, ?B/s]Downloading modules.json: 100%|██████████| 349/349 [00:00<00:00, 495kB/s]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 01:40:33.116863: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:40:33.938603: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 01:40:40.902950: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:40:40.911996: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:40:40.914368: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:40:40.928810: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:40:40.931168: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:40:40.933483: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:40:41.305458: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:40:41.307133: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:40:41.308604: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:40:41.310060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 19.20s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.98s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 01:43:19.212689: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:43:20.030600: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 01:43:27.040006: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:43:27.048724: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:43:27.051103: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:43:27.064857: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:43:27.067209: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:43:27.069522: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:43:27.363747: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:43:27.365318: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:43:27.366743: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:43:27.368179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 18.94s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.77s/it]
Downloading .gitattributes:   0%|          | 0.00/1.48k [00:00<?, ?B/s]Downloading .gitattributes: 100%|██████████| 1.48k/1.48k [00:00<00:00, 345kB/s]
Downloading 1_Pooling/config.json:   0%|          | 0.00/270 [00:00<?, ?B/s]Downloading 1_Pooling/config.json: 100%|██████████| 270/270 [00:00<00:00, 79.1kB/s]
Downloading 2_Dense/config.json:   0%|          | 0.00/116 [00:00<?, ?B/s]Downloading 2_Dense/config.json: 100%|██████████| 116/116 [00:00<00:00, 126kB/s]
Downloading pytorch_model.bin:   0%|          | 0.00/3.15M [00:00<?, ?B/s]Downloading pytorch_model.bin: 100%|██████████| 3.15M/3.15M [00:00<00:00, 55.7MB/s]
Downloading README.md:   0%|          | 0.00/66.3k [00:00<?, ?B/s]Downloading README.md: 100%|██████████| 66.3k/66.3k [00:00<00:00, 31.2MB/s]
Downloading config.json:   0%|          | 0.00/1.53k [00:00<?, ?B/s]Downloading config.json: 100%|██████████| 1.53k/1.53k [00:00<00:00, 2.12MB/s]
Downloading (…)ce_transformers.json:   0%|          | 0.00/122 [00:00<?, ?B/s]Downloading (…)ce_transformers.json: 100%|██████████| 122/122 [00:00<00:00, 180kB/s]
Downloading pytorch_model.bin:   0%|          | 0.00/1.34G [00:00<?, ?B/s]Downloading pytorch_model.bin:   2%|▏         | 31.5M/1.34G [00:00<00:04, 266MB/s]Downloading pytorch_model.bin:   5%|▍         | 62.9M/1.34G [00:00<00:04, 278MB/s]Downloading pytorch_model.bin:   7%|▋         | 94.4M/1.34G [00:00<00:04, 279MB/s]Downloading pytorch_model.bin:   9%|▉         | 126M/1.34G [00:00<00:04, 275MB/s] Downloading pytorch_model.bin:  12%|█▏        | 157M/1.34G [00:00<00:04, 270MB/s]Downloading pytorch_model.bin:  14%|█▍        | 189M/1.34G [00:00<00:04, 273MB/s]Downloading pytorch_model.bin:  16%|█▋        | 220M/1.34G [00:00<00:04, 274MB/s]Downloading pytorch_model.bin:  19%|█▉        | 252M/1.34G [00:00<00:03, 281MB/s]Downloading pytorch_model.bin:  21%|██        | 283M/1.34G [00:01<00:03, 286MB/s]Downloading pytorch_model.bin:  23%|██▎       | 315M/1.34G [00:01<00:03, 283MB/s]Downloading pytorch_model.bin:  26%|██▌       | 346M/1.34G [00:01<00:03, 278MB/s]Downloading pytorch_model.bin:  28%|██▊       | 377M/1.34G [00:01<00:03, 261MB/s]Downloading pytorch_model.bin:  31%|███       | 409M/1.34G [00:01<00:03, 252MB/s]Downloading pytorch_model.bin:  33%|███▎      | 440M/1.34G [00:01<00:03, 243MB/s]Downloading pytorch_model.bin:  35%|███▌      | 472M/1.34G [00:01<00:03, 236MB/s]Downloading pytorch_model.bin:  38%|███▊      | 503M/1.34G [00:01<00:03, 232MB/s]Downloading pytorch_model.bin:  40%|███▉      | 535M/1.34G [00:02<00:03, 225MB/s]Downloading pytorch_model.bin:  42%|████▏     | 566M/1.34G [00:02<00:03, 222MB/s]Downloading pytorch_model.bin:  45%|████▍     | 598M/1.34G [00:02<00:03, 223MB/s]Downloading pytorch_model.bin:  47%|████▋     | 629M/1.34G [00:02<00:03, 224MB/s]Downloading pytorch_model.bin:  49%|████▉     | 661M/1.34G [00:02<00:03, 222MB/s]Downloading pytorch_model.bin:  52%|█████▏    | 692M/1.34G [00:02<00:02, 224MB/s]Downloading pytorch_model.bin:  54%|█████▍    | 724M/1.34G [00:02<00:02, 233MB/s]Downloading pytorch_model.bin:  56%|█████▋    | 755M/1.34G [00:03<00:02, 249MB/s]Downloading pytorch_model.bin:  59%|█████▊    | 786M/1.34G [00:03<00:02, 254MB/s]Downloading pytorch_model.bin:  61%|██████    | 818M/1.34G [00:03<00:02, 259MB/s]Downloading pytorch_model.bin:  63%|██████▎   | 849M/1.34G [00:03<00:01, 260MB/s]Downloading pytorch_model.bin:  66%|██████▌   | 881M/1.34G [00:03<00:01, 260MB/s]Downloading pytorch_model.bin:  68%|██████▊   | 912M/1.34G [00:03<00:01, 254MB/s]Downloading pytorch_model.bin:  70%|███████   | 944M/1.34G [00:03<00:01, 259MB/s]Downloading pytorch_model.bin:  73%|███████▎  | 975M/1.34G [00:03<00:01, 263MB/s]Downloading pytorch_model.bin:  75%|███████▌  | 1.01G/1.34G [00:03<00:01, 261MB/s]Downloading pytorch_model.bin:  77%|███████▋  | 1.04G/1.34G [00:04<00:01, 263MB/s]Downloading pytorch_model.bin:  80%|███████▉  | 1.07G/1.34G [00:04<00:01, 266MB/s]Downloading pytorch_model.bin:  82%|████████▏ | 1.10G/1.34G [00:04<00:00, 257MB/s]Downloading pytorch_model.bin:  85%|████████▍ | 1.13G/1.34G [00:04<00:00, 262MB/s]Downloading pytorch_model.bin:  87%|████████▋ | 1.16G/1.34G [00:04<00:00, 265MB/s]Downloading pytorch_model.bin:  89%|████████▉ | 1.20G/1.34G [00:04<00:00, 265MB/s]Downloading pytorch_model.bin:  92%|█████████▏| 1.23G/1.34G [00:04<00:00, 268MB/s]Downloading pytorch_model.bin:  94%|█████████▍| 1.26G/1.34G [00:04<00:00, 268MB/s]Downloading pytorch_model.bin:  96%|█████████▋| 1.29G/1.34G [00:05<00:00, 262MB/s]Downloading pytorch_model.bin:  99%|█████████▊| 1.32G/1.34G [00:05<00:00, 263MB/s]Downloading pytorch_model.bin: 100%|██████████| 1.34G/1.34G [00:05<00:00, 253MB/s]
Downloading (…)nce_bert_config.json:   0%|          | 0.00/53.0 [00:00<?, ?B/s]Downloading (…)nce_bert_config.json: 100%|██████████| 53.0/53.0 [00:00<00:00, 14.0kB/s]
Downloading (…)cial_tokens_map.json:   0%|          | 0.00/2.20k [00:00<?, ?B/s]Downloading (…)cial_tokens_map.json: 100%|██████████| 2.20k/2.20k [00:00<00:00, 2.45MB/s]
Downloading spiece.model:   0%|          | 0.00/792k [00:00<?, ?B/s]Downloading spiece.model: 100%|██████████| 792k/792k [00:00<00:00, 54.0MB/s]
Downloading tokenizer.json:   0%|          | 0.00/2.42M [00:00<?, ?B/s]Downloading tokenizer.json: 100%|██████████| 2.42M/2.42M [00:00<00:00, 5.50MB/s]Downloading tokenizer.json: 100%|██████████| 2.42M/2.42M [00:00<00:00, 5.48MB/s]
Downloading tokenizer_config.json:   0%|          | 0.00/2.41k [00:00<?, ?B/s]Downloading tokenizer_config.json: 100%|██████████| 2.41k/2.41k [00:00<00:00, 1.50MB/s]
Downloading modules.json:   0%|          | 0.00/461 [00:00<?, ?B/s]Downloading modules.json: 100%|██████████| 461/461 [00:00<00:00, 300kB/s]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 01:46:35.587212: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:46:36.381622: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 01:46:44.019405: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:46:44.028608: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:46:44.030985: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:46:44.045316: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:46:44.047683: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:46:44.050003: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:46:45.074249: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:46:45.075835: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:46:45.077310: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:46:45.078775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.05s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 19.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.87s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
1+2+meta-llama/Llama-2-7b-hf+mvp
./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-2
2024-03-07 01:49:46.009989: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:49:46.837481: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 01:49:54.046211: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:49:54.055502: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:49:54.057904: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:49:54.072341: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:49:54.074712: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:49:54.077064: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:49:54.265900: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:49:54.267538: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:49:54.268993: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:49:54.270453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.18s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 18.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.80s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 01:52:25.281860: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:52:26.077462: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 01:52:32.977566: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:52:32.986066: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:52:32.988468: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:52:33.002759: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:52:33.008271: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:52:33.014778: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:52:33.205809: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:52:33.207422: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:52:33.208862: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:52:33.210306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:30<00:30, 30.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 18.90s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.65s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 01:55:02.950888: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:55:03.753944: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 01:55:10.899289: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:55:10.908371: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:55:10.910777: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:55:10.925621: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:55:10.927987: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:55:10.930322: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:55:11.685888: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:55:11.689498: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:55:11.690961: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:55:11.692421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.66s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.21s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 01:57:51.597719: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 01:57:52.375431: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 01:57:59.569614: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:57:59.578524: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:57:59.580888: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:57:59.595649: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:57:59.597991: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:57:59.600319: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:57:59.785677: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:57:59.787280: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:57:59.788714: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 01:57:59.790162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.28s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.12s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:00:36.310190: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:00:37.102553: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:00:44.186234: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:00:44.195516: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:00:44.197899: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:00:44.218137: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:00:44.220599: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:00:44.222943: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:00:44.711959: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:00:44.713565: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:00:44.715006: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:00:44.716467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.67s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.26s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:03:43.524321: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:03:44.301313: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:03:51.314154: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:03:51.322396: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:03:51.324772: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:03:51.339060: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:03:51.341408: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:03:51.343721: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:03:51.716530: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:03:51.718133: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:03:51.719605: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:03:51.721050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.27s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.09s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
1+4+meta-llama/Llama-2-7b-hf+mvp
./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-4
2024-03-07 02:06:49.880708: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:06:50.620450: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:06:57.714758: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:06:57.723925: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:06:57.726307: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:06:57.741870: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:06:57.744244: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:06:57.746571: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:06:57.973040: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:06:57.974639: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:06:57.976081: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:06:57.977526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.27s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 18.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.81s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:09:29.367942: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:09:30.107326: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:09:36.856126: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:09:36.865359: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:09:36.867742: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:09:36.881792: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:09:36.884146: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:09:36.886475: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:09:37.090653: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:09:37.092239: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:09:37.093678: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:09:37.095141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:30<00:30, 30.61s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 18.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.55s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:12:04.166610: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:12:04.900055: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:12:11.962278: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:12:11.971496: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:12:11.973875: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:12:11.988591: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:12:11.990955: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:12:11.993275: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:12:12.182995: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:12:12.184601: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:12:12.186031: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:12:12.187474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.24s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.09s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:14:50.298761: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:14:51.044580: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:14:58.704545: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:14:58.713902: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:14:58.716286: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:14:58.732458: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:14:58.734817: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:14:58.737138: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:14:58.931912: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:14:58.933505: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:14:58.934935: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:14:58.936374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.45s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 19.13s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.98s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:17:36.629196: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:17:37.436001: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:17:45.194006: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:17:45.223515: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:17:45.225906: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:17:45.242540: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:17:45.244898: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:17:45.247229: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:17:46.470361: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:17:46.471954: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:17:46.473448: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:17:46.474918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.20s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:20:47.318120: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:20:48.128359: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:20:55.884454: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:20:55.893708: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:20:55.896115: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:20:55.921465: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:20:55.923820: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:20:55.926215: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:20:56.222961: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:20:56.224634: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:20:56.226092: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:20:56.227555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.44s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.31s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
1+16+meta-llama/Llama-2-7b-hf+mvp
./checkpoints/cr/meta-llama/Llama-2-7b-hf/swap_labels/retrieval_icl-seed-1-shot-16
2024-03-07 02:23:58.460242: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:23:59.209289: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:24:06.354215: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:24:06.362760: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:24:06.365179: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:24:06.379235: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:24:06.381584: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:24:06.383902: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:24:07.012050: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:24:07.013875: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:24:07.015414: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:24:07.016894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.12s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:26:40.416289: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:26:41.226143: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:26:48.344654: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:26:48.353335: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:26:48.355755: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:26:48.372129: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:26:48.374505: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:26:48.376838: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:26:48.776212: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:26:48.777795: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:26:48.779235: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:26:48.780679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.71s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 19.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.17s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:29:20.521835: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:29:21.332414: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:29:28.645646: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:29:28.654822: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:29:28.657211: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:29:28.672776: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:29:28.675137: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:29:28.677474: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:29:28.984407: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:29:28.985999: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:29:28.987436: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:29:28.988892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.03s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 19.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.87s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:32:07.081091: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:32:07.909276: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:32:15.538020: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:32:15.547830: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:32:15.550222: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:32:15.565349: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:32:15.567713: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:32:15.570037: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:32:16.168234: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:32:16.169826: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:32:16.171266: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:32:16.172720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.09s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 19.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.91s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:34:54.097729: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:34:54.916200: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:35:02.096676: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:35:02.113593: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:35:02.116083: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:35:02.131629: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:35:02.134019: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:35:02.136364: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:35:02.577015: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:35:02.578637: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:35:02.580095: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:35:02.581547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:31<00:31, 31.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 19.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.90s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
2024-03-07 02:38:03.235327: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 02:38:04.049177: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-03-07 02:38:11.270764: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:38:11.280033: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:38:11.282425: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:38:11.297921: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:38:11.300290: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:38:11.302640: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:38:11.520353: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:38:11.521963: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:38:11.523428: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2024-03-07 02:38:11.524880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38375 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-40GB, pci bus id: 0000:12:00.0, compute capability: 8.0
/mnt/data/mvp/src/utils/funcs.py:255: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  metric = load_metric('accuracy')
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
You are attempting to use Flash Attention 2.0 with a model initialized on CPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:30<00:30, 30.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 18.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:41<00:00, 20.68s/it]
Map:   0%|          | 0/376 [00:00<?, ? examples/s]Map:   0%|          | 0/376 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "main.py", line 85, in <module>
    attacker(args)
  File "/mnt/data/mvp/src/test.py", line 201, in attacker
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 592, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 557, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3097, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3450, in _map_single
    example = apply_function_on_filtered_inputs(example, i, offset=offset)
  File "/usr/local/lib/python3.8/dist-packages/datasets/arrow_dataset.py", line 3353, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/mnt/data/mvp/src/test.py", line 201, in <lambda>
    my_dataset = my_dataset[split].map(lambda x: convert_to_icl(x, icl_examples, verbalizer), batched=False)
  File "/mnt/data/mvp/src/test.py", line 56, in convert_to_icl
    idx = data['idx']
  File "/usr/local/lib/python3.8/dist-packages/datasets/formatting/formatting.py", line 270, in __getitem__
    value = self.data[key]
KeyError: 'idx'
